<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link href=https://careamics.github.io/0.1/reference/careamics/config/configuration_factories/ rel=canonical><link href=../configuration/ rel=prev><link href=../configuration_io/ rel=next><link rel=icon href=../../../../assets/icon_careamics.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.22"><title>configuration_factories -</title><link rel=stylesheet href=../../../../assets/stylesheets/main.84d31ad4.min.css><link rel=stylesheet href=../../../../assets/stylesheets/palette.06af60db.min.css><link rel=stylesheet href=../../../../assets/_mkdocstrings.css><link rel=stylesheet href=../../../../stylesheets/extra.css><link rel=stylesheet href=../../../../stylesheets/grid_menu.css><link rel=stylesheet href=../../../../stylesheets/termynal.css><link rel=stylesheet href=https://unpkg.com/katex@0/dist/katex.min.css><script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=white data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#careamics.config.configuration_factories class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <div data-md-color-scheme=default data-md-component=outdated hidden> </div> <header class="md-header md-header--shadow" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../../.. title class="md-header__button md-logo" aria-label data-md-component=logo> <img src=../../../../assets/banner_careamics_large.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> configuration_factories </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=white data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M14.768 3.96zl-.002-.005a9 9 0 0 0-.218-.779c-.13-.394.21-.8.602-.67q.435.144.855.328l.01.005A10.002 10.002 0 0 1 12 22a10 10 0 0 1-9.162-5.985l-.004-.01a10 10 0 0 1-.329-.855c-.13-.392.277-.732.67-.602q.386.126.78.218l.004.002A9 9 0 0 0 14.999 6a9 9 0 0 0-.231-2.04M16.5 6c0 5.799-4.701 10.5-10.5 10.5q-.64 0-1.26-.075A8.5 8.5 0 1 0 16.425 4.74q.075.62.075 1.259Z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=black data-md-color-accent=amber aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 19a7 7 0 1 1 0-14 7 7 0 0 1 0 14m0-1.5a5.5 5.5 0 1 0 0-11 5.5 5.5 0 1 0 0 11m-5.657.157a.75.75 0 0 1 0 1.06l-1.768 1.768a.749.749 0 0 1-1.275-.326.75.75 0 0 1 .215-.734l1.767-1.768a.75.75 0 0 1 1.061 0M3.515 3.515a.75.75 0 0 1 1.06 0l1.768 1.768a.749.749 0 0 1-.326 1.275.75.75 0 0 1-.734-.215L3.515 4.575a.75.75 0 0 1 0-1.06M12 0a.75.75 0 0 1 .75.75v2.5a.75.75 0 0 1-1.5 0V.75A.75.75 0 0 1 12 0M4 12a.75.75 0 0 1-.75.75H.75a.75.75 0 0 1 0-1.5h2.5A.75.75 0 0 1 4 12m8 8a.75.75 0 0 1 .75.75v2.5a.75.75 0 0 1-1.5 0v-2.5A.75.75 0 0 1 12 20m12-8a.75.75 0 0 1-.75.75h-2.5a.75.75 0 0 1 0-1.5h2.5A.75.75 0 0 1 24 12m-6.343 5.657a.75.75 0 0 1 1.06 0l1.768 1.768a.75.75 0 0 1-.018 1.042.75.75 0 0 1-1.042.018l-1.768-1.767a.75.75 0 0 1 0-1.061m2.828-14.142a.75.75 0 0 1 0 1.06l-1.768 1.768a.75.75 0 0 1-1.042-.018.75.75 0 0 1-.018-1.042l1.767-1.768a.75.75 0 0 1 1.061 0"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/CAREamics/careamics title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> CAREamics </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../../.. title class="md-nav__button md-logo" aria-label data-md-component=logo> <img src=../../../../assets/banner_careamics_large.png alt=logo> </a> </label> <div class=md-nav__source> <a href=https://github.com/CAREamics/careamics title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> CAREamics </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../.. class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M11.03 2.59a1.5 1.5 0 0 1 1.94 0l7.5 6.363a1.5 1.5 0 0 1 .53 1.144V19.5a1.5 1.5 0 0 1-1.5 1.5h-5.75a.75.75 0 0 1-.75-.75V14h-2v6.25a.75.75 0 0 1-.75.75H4.5A1.5 1.5 0 0 1 3 19.5v-9.403c0-.44.194-.859.53-1.144ZM12 3.734l-7.5 6.363V19.5h5v-6.25a.75.75 0 0 1 .75-.75h3.5a.75.75 0 0 1 .75.75v6.25h5v-9.403Z"/></svg> <span class=md-ellipsis> Home </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2> <div class="md-nav__link md-nav__container"> <a href=../../../../installation/ class="md-nav__link "> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M11.25 9.331V.75a.75.75 0 0 1 1.5 0v8.58l1.949-2.11A.75.75 0 1 1 15.8 8.237l-3.25 3.52a.75.75 0 0 1-1.102 0l-3.25-3.52A.75.75 0 1 1 9.3 7.22z"/><path d="M2.5 3.75v11.5c0 .138.112.25.25.25h18.5a.25.25 0 0 0 .25-.25V3.75a.25.25 0 0 0-.25-.25h-5.5a.75.75 0 0 1 0-1.5h5.5c.966 0 1.75.784 1.75 1.75v11.5A1.75 1.75 0 0 1 21.25 17h-6.204c.171 1.375.805 2.652 1.769 3.757A.752.752 0 0 1 16.25 22h-8.5a.75.75 0 0 1-.566-1.243c.965-1.105 1.599-2.382 1.77-3.757H2.75A1.75 1.75 0 0 1 1 15.25V3.75C1 2.784 1.784 2 2.75 2h5.5a.75.75 0 0 1 0 1.5h-5.5a.25.25 0 0 0-.25.25M10.463 17c-.126 1.266-.564 2.445-1.223 3.5h5.52c-.66-1.055-1.098-2.234-1.223-3.5Z"/></svg> <span class=md-ellipsis> Installation </span> </a> <label class="md-nav__link " for=__nav_2 id=__nav_2_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Installation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../installation/conda_mamba/ class=md-nav__link> <span class=md-ellipsis> Using mamba/conda </span> </a> </li> <li class=md-nav__item> <a href=../../../../installation/uv/ class=md-nav__link> <span class=md-ellipsis> Using uv </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../../features/ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M11.75 1a.75.75 0 0 1 .75.75V4h6.532c.42 0 .826.15 1.143.425l3.187 2.75a1.75 1.75 0 0 1 0 2.65l-3.187 2.75a1.75 1.75 0 0 1-1.143.425H12.5v9.25a.75.75 0 0 1-1.5 0V13H3.75A1.75 1.75 0 0 1 2 11.25v-5.5C2 4.783 2.784 4 3.75 4H11V1.75a.75.75 0 0 1 .75-.75m7.282 4.5H3.75a.25.25 0 0 0-.25.25v5.5c0 .138.112.25.25.25h15.282c.06 0 .118-.021.163-.06l3.188-2.75a.248.248 0 0 0 0-.38l-3.188-2.75a.25.25 0 0 0-.163-.06"/></svg> <span class=md-ellipsis> Features </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4> <div class="md-nav__link md-nav__container"> <a href=../../../../guides/ class="md-nav__link "> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 2.75A2.75 2.75 0 0 1 5.75 0h14.5a.75.75 0 0 1 .75.75v20.5a.75.75 0 0 1-.75.75h-6a.75.75 0 0 1 0-1.5h5.25v-4H6A1.5 1.5 0 0 0 4.5 18v.75c0 .716.43 1.334 1.05 1.605a.75.75 0 0 1-.6 1.374A3.25 3.25 0 0 1 3 18.75ZM19.5 1.5H5.75c-.69 0-1.25.56-1.25 1.25v12.651A3 3 0 0 1 6 15h13.5Z"/><path d="M7 18.25a.25.25 0 0 1 .25-.25h5a.25.25 0 0 1 .25.25v5.01a.25.25 0 0 1-.397.201l-2.206-1.604a.25.25 0 0 0-.294 0L7.397 23.46a.25.25 0 0 1-.397-.2z"/></svg> <span class=md-ellipsis> Guides </span> </a> <label class="md-nav__link " for=__nav_4 id=__nav_4_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Guides </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_2> <div class="md-nav__link md-nav__container"> <a href=../../../../guides/careamist_api/ class="md-nav__link "> <span class=md-ellipsis> CAREamist API </span> </a> <label class="md-nav__link " for=__nav_4_2 id=__nav_4_2_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_2_label aria-expanded=false> <label class=md-nav__title for=__nav_4_2> <span class="md-nav__icon md-icon"></span> CAREamist API </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_2_1> <div class="md-nav__link md-nav__container"> <a href=../../../../guides/careamist_api/configuration/ class="md-nav__link "> <span class=md-ellipsis> Configuration </span> </a> <label class="md-nav__link " for=__nav_4_2_1 id=__nav_4_2_1_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_4_2_1_label aria-expanded=false> <label class=md-nav__title for=__nav_4_2_1> <span class="md-nav__icon md-icon"></span> Configuration </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../guides/careamist_api/configuration/convenience_functions/ class=md-nav__link> <span class=md-ellipsis> Convenience functions </span> </a> </li> <li class=md-nav__item> <a href=../../../../guides/careamist_api/configuration/save_load/ class=md-nav__link> <span class=md-ellipsis> Save and load </span> </a> </li> <li class=md-nav__item> <a href=../../../../guides/careamist_api/configuration/custom_types/ class=md-nav__link> <span class=md-ellipsis> Custom types </span> </a> </li> <li class=md-nav__item> <a href=../../../../guides/careamist_api/configuration/configuration_errors/ class=md-nav__link> <span class=md-ellipsis> Configuration errors </span> </a> </li> <li class=md-nav__item> <a href=../../../../guides/careamist_api/configuration/build_configuration/ class=md-nav__link> <span class=md-ellipsis> Build the configuration </span> </a> </li> <li class=md-nav__item> <a href=../../../../guides/careamist_api/configuration/algorithm_requirements/ class=md-nav__link> <span class=md-ellipsis> Algorithm requirements </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_2_2> <div class="md-nav__link md-nav__container"> <a href=../../../../guides/careamist_api/usage/ class="md-nav__link "> <span class=md-ellipsis> Using CAREamics </span> </a> <label class="md-nav__link " for=__nav_4_2_2 id=__nav_4_2_2_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_4_2_2_label aria-expanded=false> <label class=md-nav__title for=__nav_4_2_2> <span class="md-nav__icon md-icon"></span> Using CAREamics </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../guides/careamist_api/usage/careamist/ class=md-nav__link> <span class=md-ellipsis> CAREamist </span> </a> </li> <li class=md-nav__item> <a href=../../../../guides/careamist_api/usage/training/ class=md-nav__link> <span class=md-ellipsis> Training </span> </a> </li> <li class=md-nav__item> <a href=../../../../guides/careamist_api/usage/datasets/ class=md-nav__link> <span class=md-ellipsis> (Intermediate) Datasets </span> </a> </li> <li class=md-nav__item> <a href=../../../../guides/careamist_api/usage/prediction/ class=md-nav__link> <span class=md-ellipsis> Prediction </span> </a> </li> <li class=md-nav__item> <a href=../../../../guides/careamist_api/usage/model_export/ class=md-nav__link> <span class=md-ellipsis> Export to BMZ </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../../guides/careamist_api/faq/ class=md-nav__link> <span class=md-ellipsis> FAQ </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../../guides/napari_plugin/ class=md-nav__link> <span class=md-ellipsis> napari plugins </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_4> <div class="md-nav__link md-nav__container"> <a href=../../../../guides/lightning_api/ class="md-nav__link "> <span class=md-ellipsis> Lightning API </span> </a> <label class="md-nav__link " for=__nav_4_4 id=__nav_4_4_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4_4> <span class="md-nav__icon md-icon"></span> Lightning API </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../guides/lightning_api/lightning_module/ class=md-nav__link> <span class=md-ellipsis> Lightning module </span> </a> </li> <li class=md-nav__item> <a href=../../../../guides/lightning_api/train_data_module/ class=md-nav__link> <span class=md-ellipsis> Train data module </span> </a> </li> <li class=md-nav__item> <a href=../../../../guides/lightning_api/prediction/ class=md-nav__link> <span class=md-ellipsis> Prediction </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../../guides/cli/ class=md-nav__link> <span class=md-ellipsis> Command-line interface </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_6> <div class="md-nav__link md-nav__container"> <a href=../../../../guides/dev_resources/ class="md-nav__link "> <span class=md-ellipsis> Developer resources </span> </a> <label class="md-nav__link " for=__nav_4_6 id=__nav_4_6_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_6_label aria-expanded=false> <label class=md-nav__title for=__nav_4_6> <span class="md-nav__icon md-icon"></span> Developer resources </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../guides/dev_resources/contribute/ class=md-nav__link> <span class=md-ellipsis> Contribute to CAREamics </span> </a> </li> <li class=md-nav__item> <a href=../../../../guides/dev_resources/website/ class=md-nav__link> <span class=md-ellipsis> Github pages </span> </a> </li> <li class=md-nav__item> <a href=../../../../guides/dev_resources/docstring/ class=md-nav__link> <span class=md-ellipsis> Docstring conventions </span> </a> </li> <li class=md-nav__item> <a href=../../../../guides/dev_resources/conda/ class=md-nav__link> <span class=md-ellipsis> Conda-forge package </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5> <div class="md-nav__link md-nav__container"> <a href=../../../../applications/ class="md-nav__link "> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21.75 21.5H2.25A1.75 1.75 0 0 1 .5 19.75V4.25c0-.966.784-1.75 1.75-1.75h19.5c.966 0 1.75.784 1.75 1.75v15.5a1.75 1.75 0 0 1-1.75 1.75M2.25 4a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h3.178L14 10.977a1.75 1.75 0 0 1 2.506-.032L22 16.44V4.25a.25.25 0 0 0-.25-.25ZM22 19.75v-1.19l-6.555-6.554a.25.25 0 0 0-.18-.073.25.25 0 0 0-.178.077L7.497 20H21.75a.25.25 0 0 0 .25-.25M10.5 9.25a3.25 3.25 0 1 1-6.5 0 3.25 3.25 0 0 1 6.5 0m-1.5 0a1.75 1.75 0 1 0-3.501.001A1.75 1.75 0 0 0 9 9.25"/></svg> <span class=md-ellipsis> Applications </span> </a> <label class="md-nav__link " for=__nav_5 id=__nav_5_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Applications </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_1> <div class="md-nav__link md-nav__container"> <a href=../../../../applications/Noise2Void/ class="md-nav__link "> <span class=md-ellipsis> Noise2Void </span> </a> <label class="md-nav__link " for=__nav_5_1 id=__nav_5_1_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_1_label aria-expanded=false> <label class=md-nav__title for=__nav_5_1> <span class="md-nav__icon md-icon"></span> Noise2Void </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../applications/Noise2Void/BSD68/ class=md-nav__link> <span class=md-ellipsis> BSD68 </span> </a> </li> <li class=md-nav__item> <a href=../../../../applications/Noise2Void/Flywing/ class=md-nav__link> <span class=md-ellipsis> Flywing </span> </a> </li> <li class=md-nav__item> <a href=../../../../applications/Noise2Void/Mouse_Nuclei/ class=md-nav__link> <span class=md-ellipsis> Mouse Nuclei </span> </a> </li> <li class=md-nav__item> <a href=../../../../applications/Noise2Void/SEM/ class=md-nav__link> <span class=md-ellipsis> SEM </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_2> <div class="md-nav__link md-nav__container"> <a href=../../../../applications/Noise2Noise/ class="md-nav__link "> <span class=md-ellipsis> Noise2Noise </span> </a> <label class="md-nav__link " for=__nav_5_2 id=__nav_5_2_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_2_label aria-expanded=false> <label class=md-nav__title for=__nav_5_2> <span class="md-nav__icon md-icon"></span> Noise2Noise </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../applications/Noise2Noise/SEM/ class=md-nav__link> <span class=md-ellipsis> SEM </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_3> <div class="md-nav__link md-nav__container"> <a href=../../../../applications/CARE/ class="md-nav__link "> <span class=md-ellipsis> CARE </span> </a> <label class="md-nav__link " for=__nav_5_3 id=__nav_5_3_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_3_label aria-expanded=false> <label class=md-nav__title for=__nav_5_3> <span class="md-nav__icon md-icon"></span> CARE </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../applications/CARE/denoising_U2OS/ class=md-nav__link> <span class=md-ellipsis> denoising U2OS </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_4> <div class="md-nav__link md-nav__container"> <a href=../../../../applications/Lightning_API/ class="md-nav__link "> <span class=md-ellipsis> Lightning API </span> </a> <label class="md-nav__link " for=__nav_5_4 id=__nav_5_4_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_4_label aria-expanded=false> <label class=md-nav__title for=__nav_5_4> <span class="md-nav__icon md-icon"></span> Lightning API </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../applications/Lightning_API/BSD68_N2V/ class=md-nav__link> <span class=md-ellipsis> BSD68 N2V </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6> <div class="md-nav__link md-nav__container"> <a href=../../../../algorithms/ class="md-nav__link "> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M8.75 8h6.5a.75.75 0 0 1 .75.75v6.5a.75.75 0 0 1-.75.75h-6.5a.75.75 0 0 1-.75-.75v-6.5A.75.75 0 0 1 8.75 8m.75 6.5h5v-5h-5Z"/><path d="M15.25 1a.75.75 0 0 1 .75.75V4h2.25c.966 0 1.75.784 1.75 1.75V8h2.25a.75.75 0 0 1 0 1.5H20v5h2.25a.75.75 0 0 1 0 1.5H20v2.25A1.75 1.75 0 0 1 18.25 20H16v2.25a.75.75 0 0 1-1.5 0V20h-5v2.25a.75.75 0 0 1-1.5 0V20H5.75A1.75 1.75 0 0 1 4 18.25V16H1.75a.75.75 0 0 1 0-1.5H4v-5H1.75a.75.75 0 0 1 0-1.5H4V5.75C4 4.784 4.784 4 5.75 4H8V1.75a.75.75 0 0 1 1.5 0V4h5V1.75a.75.75 0 0 1 .75-.75m3 17.5a.25.25 0 0 0 .25-.25V5.75a.25.25 0 0 0-.25-.25H5.75a.25.25 0 0 0-.25.25v12.5c0 .138.112.25.25.25Z"/></svg> <span class=md-ellipsis> Algorithms </span> </a> <label class="md-nav__link " for=__nav_6 id=__nav_6_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Algorithms </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../algorithms/N2V2/ class=md-nav__link> <span class=md-ellipsis> N2V2 </span> </a> </li> <li class=md-nav__item> <a href=../../../../algorithms/Noise2Void/ class=md-nav__link> <span class=md-ellipsis> Noise2Void </span> </a> </li> <li class=md-nav__item> <a href=../../../../algorithms/NoiseModels/ class=md-nav__link> <span class=md-ellipsis> Noise Models </span> </a> </li> <li class=md-nav__item> <a href=../../../../algorithms/structN2V/ class=md-nav__link> <span class=md-ellipsis> structN2V </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7 checked> <div class="md-nav__link md-nav__container"> <a href=../../../ class="md-nav__link "> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M15.22 4.97a.75.75 0 0 1 1.06 0l6.5 6.5a.75.75 0 0 1 0 1.06l-6.5 6.5a.749.749 0 0 1-1.275-.326.75.75 0 0 1 .215-.734L21.19 12l-5.97-5.97a.75.75 0 0 1 0-1.06m-6.44 0a.75.75 0 0 1 0 1.06L2.81 12l5.97 5.97a.749.749 0 0 1-.326 1.275.75.75 0 0 1-.734-.215l-6.5-6.5a.75.75 0 0 1 0-1.06l6.5-6.5a.75.75 0 0 1 1.06 0"/></svg> <span class=md-ellipsis> API documentation </span> </a> <label class="md-nav__link " for=__nav_7 id=__nav_7_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_7_label aria-expanded=true> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> API documentation </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_2 checked> <div class="md-nav__link md-nav__container"> <a href=../../ class="md-nav__link "> <span class=md-ellipsis> careamics </span> </a> <label class="md-nav__link " for=__nav_7_2 id=__nav_7_2_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_7_2_label aria-expanded=true> <label class=md-nav__title for=__nav_7_2> <span class="md-nav__icon md-icon"></span> careamics </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../careamist/ class=md-nav__link> <span class=md-ellipsis> careamist </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_2_3> <label class=md-nav__link for=__nav_7_2_3 id=__nav_7_2_3_label tabindex=0> <span class=md-ellipsis> cli </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_7_2_3_label aria-expanded=false> <label class=md-nav__title for=__nav_7_2_3> <span class="md-nav__icon md-icon"></span> cli </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../cli/conf/ class=md-nav__link> <span class=md-ellipsis> conf </span> </a> </li> <li class=md-nav__item> <a href=../../cli/main/ class=md-nav__link> <span class=md-ellipsis> main </span> </a> </li> <li class=md-nav__item> <a href=../../cli/utils/ class=md-nav__link> <span class=md-ellipsis> utils </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_2_4 checked> <label class=md-nav__link for=__nav_7_2_4 id=__nav_7_2_4_label tabindex=0> <span class=md-ellipsis> config </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_7_2_4_label aria-expanded=true> <label class=md-nav__title for=__nav_7_2_4> <span class="md-nav__icon md-icon"></span> config </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_2_4_1> <label class=md-nav__link for=__nav_7_2_4_1 id=__nav_7_2_4_1_label tabindex=0> <span class=md-ellipsis> algorithms </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_7_2_4_1_label aria-expanded=false> <label class=md-nav__title for=__nav_7_2_4_1> <span class="md-nav__icon md-icon"></span> algorithms </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../algorithms/care_algorithm_model/ class=md-nav__link> <span class=md-ellipsis> care_algorithm_model </span> </a> </li> <li class=md-nav__item> <a href=../algorithms/hdn_algorithm_model/ class=md-nav__link> <span class=md-ellipsis> hdn_algorithm_model </span> </a> </li> <li class=md-nav__item> <a href=../algorithms/microsplit_algorithm_model/ class=md-nav__link> <span class=md-ellipsis> microsplit_algorithm_model </span> </a> </li> <li class=md-nav__item> <a href=../algorithms/n2n_algorithm_model/ class=md-nav__link> <span class=md-ellipsis> n2n_algorithm_model </span> </a> </li> <li class=md-nav__item> <a href=../algorithms/n2v_algorithm_model/ class=md-nav__link> <span class=md-ellipsis> n2v_algorithm_model </span> </a> </li> <li class=md-nav__item> <a href=../algorithms/unet_algorithm_model/ class=md-nav__link> <span class=md-ellipsis> unet_algorithm_model </span> </a> </li> <li class=md-nav__item> <a href=../algorithms/vae_algorithm_model/ class=md-nav__link> <span class=md-ellipsis> vae_algorithm_model </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_2_4_2> <label class=md-nav__link for=__nav_7_2_4_2 id=__nav_7_2_4_2_label tabindex=0> <span class=md-ellipsis> architectures </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_7_2_4_2_label aria-expanded=false> <label class=md-nav__title for=__nav_7_2_4_2> <span class="md-nav__icon md-icon"></span> architectures </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../architectures/architecture_model/ class=md-nav__link> <span class=md-ellipsis> architecture_model </span> </a> </li> <li class=md-nav__item> <a href=../architectures/lvae_model/ class=md-nav__link> <span class=md-ellipsis> lvae_model </span> </a> </li> <li class=md-nav__item> <a href=../architectures/unet_model/ class=md-nav__link> <span class=md-ellipsis> unet_model </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../callback_model/ class=md-nav__link> <span class=md-ellipsis> callback_model </span> </a> </li> <li class=md-nav__item> <a href=../configuration/ class=md-nav__link> <span class=md-ellipsis> configuration </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> configuration_factories </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> configuration_factories </span> </a> <nav class="md-nav md-nav--secondary" aria-label="On This Page"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> On This Page </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#careamics.config.configuration_factories class=md-nav__link> <span class=md-ellipsis> configuration_factories </span> </a> </li> <li class=md-nav__item> <a href=#careamics.config.configuration_factories.algorithm_factory class=md-nav__link> <span class=md-ellipsis> algorithm_factory </span> </a> </li> <li class=md-nav__item> <a href=#careamics.config.configuration_factories.create_care_configuration class=md-nav__link> <span class=md-ellipsis> create_care_configuration </span> </a> </li> <li class=md-nav__item> <a href=#careamics.config.configuration_factories.create_hdn_configuration class=md-nav__link> <span class=md-ellipsis> create_hdn_configuration </span> </a> <nav class=md-nav aria-label=create_hdn_configuration> <ul class=md-nav__list> <li class=md-nav__item> <a href=#careamics.config.configuration_factories.create_hdn_configuration--todo-revisit-the-necessity-of-model_params class=md-nav__link> <span class=md-ellipsis> TODO revisit the necessity of model_params </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#careamics.config.configuration_factories.create_microsplit_configuration class=md-nav__link> <span class=md-ellipsis> create_microsplit_configuration </span> </a> <nav class=md-nav aria-label=create_microsplit_configuration> <ul class=md-nav__list> <li class=md-nav__item> <a href=#careamics.config.configuration_factories.create_microsplit_configuration--config-create_microsplit_configuration class=md-nav__link> <span class=md-ellipsis> &gt;&gt;&gt; config = create_microsplit_configuration( </span> </a> </li> <li class=md-nav__item> <a href=#careamics.config.configuration_factories.create_microsplit_configuration--experiment_namemicrosplit_experiment class=md-nav__link> <span class=md-ellipsis> ... experiment_name="microsplit_experiment", </span> </a> </li> <li class=md-nav__item> <a href=#careamics.config.configuration_factories.create_microsplit_configuration--data_typearray class=md-nav__link> <span class=md-ellipsis> ... data_type="array", </span> </a> </li> <li class=md-nav__item> <a href=#careamics.config.configuration_factories.create_microsplit_configuration--axesyx class=md-nav__link> <span class=md-ellipsis> ... axes="YX", </span> </a> </li> <li class=md-nav__item> <a href=#careamics.config.configuration_factories.create_microsplit_configuration--patch_size64-64 class=md-nav__link> <span class=md-ellipsis> ... patch_size=[64, 64], </span> </a> </li> <li class=md-nav__item> <a href=#careamics.config.configuration_factories.create_microsplit_configuration--batch_size32 class=md-nav__link> <span class=md-ellipsis> ... batch_size=32, </span> </a> </li> <li class=md-nav__item> <a href=#careamics.config.configuration_factories.create_microsplit_configuration--num_epochs100 class=md-nav__link> <span class=md-ellipsis> ... num_epochs=100 </span> </a> </li> <li class=md-nav__item> <a href=#careamics.config.configuration_factories.create_microsplit_configuration--_1 class=md-nav__link> <span class=md-ellipsis> ... ) </span> </a> </li> <li class=md-nav__item> <a href=#careamics.config.configuration_factories.create_microsplit_configuration--you-can-also-limit-the-number-of-batches-per-epoch class=md-nav__link> <span class=md-ellipsis> You can also limit the number of batches per epoch: </span> </a> </li> <li class=md-nav__item> <a href=#careamics.config.configuration_factories.create_microsplit_configuration--config-create_microsplit_configuration_1 class=md-nav__link> <span class=md-ellipsis> &gt;&gt;&gt; config = create_microsplit_configuration( </span> </a> </li> <li class=md-nav__item> <a href=#careamics.config.configuration_factories.create_microsplit_configuration--experiment_namemicrosplit_experiment_1 class=md-nav__link> <span class=md-ellipsis> ... experiment_name="microsplit_experiment", </span> </a> </li> <li class=md-nav__item> <a href=#careamics.config.configuration_factories.create_microsplit_configuration--data_typearray_1 class=md-nav__link> <span class=md-ellipsis> ... data_type="array", </span> </a> </li> <li class=md-nav__item> <a href=#careamics.config.configuration_factories.create_microsplit_configuration--axesyx_1 class=md-nav__link> <span class=md-ellipsis> ... axes="YX", </span> </a> </li> <li class=md-nav__item> <a href=#careamics.config.configuration_factories.create_microsplit_configuration--patch_size64-64_1 class=md-nav__link> <span class=md-ellipsis> ... patch_size=[64, 64], </span> </a> </li> <li class=md-nav__item> <a href=#careamics.config.configuration_factories.create_microsplit_configuration--batch_size32_1 class=md-nav__link> <span class=md-ellipsis> ... batch_size=32, </span> </a> </li> <li class=md-nav__item> <a href=#careamics.config.configuration_factories.create_microsplit_configuration--num_steps100-limit-to-100-batches-per-epoch class=md-nav__link> <span class=md-ellipsis> ... num_steps=100 # limit to 100 batches per epoch </span> </a> </li> <li class=md-nav__item> <a href=#careamics.config.configuration_factories.create_microsplit_configuration--_2 class=md-nav__link> <span class=md-ellipsis> ... ) </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#careamics.config.configuration_factories.create_n2n_configuration class=md-nav__link> <span class=md-ellipsis> create_n2n_configuration </span> </a> </li> <li class=md-nav__item> <a href=#careamics.config.configuration_factories.create_n2v_configuration class=md-nav__link> <span class=md-ellipsis> create_n2v_configuration </span> </a> </li> <li class=md-nav__item> <a href=#careamics.config.configuration_factories.get_likelihood_config class=md-nav__link> <span class=md-ellipsis> get_likelihood_config </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../configuration_io/ class=md-nav__link> <span class=md-ellipsis> configuration_io </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_2_4_7> <label class=md-nav__link for=__nav_7_2_4_7 id=__nav_7_2_4_7_label tabindex=0> <span class=md-ellipsis> data </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_7_2_4_7_label aria-expanded=false> <label class=md-nav__title for=__nav_7_2_4_7> <span class="md-nav__icon md-icon"></span> data </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../data/data_model/ class=md-nav__link> <span class=md-ellipsis> data_model </span> </a> </li> <li class=md-nav__item> <a href=../data/ng_data_model/ class=md-nav__link> <span class=md-ellipsis> ng_data_model </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_2_4_7_3> <label class=md-nav__link for=__nav_7_2_4_7_3 id=__nav_7_2_4_7_3_label tabindex=0> <span class=md-ellipsis> patch_filter </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=5 aria-labelledby=__nav_7_2_4_7_3_label aria-expanded=false> <label class=md-nav__title for=__nav_7_2_4_7_3> <span class="md-nav__icon md-icon"></span> patch_filter </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../data/patch_filter/filter_model/ class=md-nav__link> <span class=md-ellipsis> filter_model </span> </a> </li> <li class=md-nav__item> <a href=../data/patch_filter/mask_filter_model/ class=md-nav__link> <span class=md-ellipsis> mask_filter_model </span> </a> </li> <li class=md-nav__item> <a href=../data/patch_filter/max_filter_model/ class=md-nav__link> <span class=md-ellipsis> max_filter_model </span> </a> </li> <li class=md-nav__item> <a href=../data/patch_filter/meanstd_filter_model/ class=md-nav__link> <span class=md-ellipsis> meanstd_filter_model </span> </a> </li> <li class=md-nav__item> <a href=../data/patch_filter/shannon_filter_model/ class=md-nav__link> <span class=md-ellipsis> shannon_filter_model </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_2_4_7_4> <label class=md-nav__link for=__nav_7_2_4_7_4 id=__nav_7_2_4_7_4_label tabindex=0> <span class=md-ellipsis> patching_strategies </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=5 aria-labelledby=__nav_7_2_4_7_4_label aria-expanded=false> <label class=md-nav__title for=__nav_7_2_4_7_4> <span class="md-nav__icon md-icon"></span> patching_strategies </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../data/patching_strategies/_overlapping_patched_model/ class=md-nav__link> <span class=md-ellipsis> _overlapping_patched_model </span> </a> </li> <li class=md-nav__item> <a href=../data/patching_strategies/_patched_model/ class=md-nav__link> <span class=md-ellipsis> _patched_model </span> </a> </li> <li class=md-nav__item> <a href=../data/patching_strategies/random_patching_model/ class=md-nav__link> <span class=md-ellipsis> random_patching_model </span> </a> </li> <li class=md-nav__item> <a href=../data/patching_strategies/sequential_patching_model/ class=md-nav__link> <span class=md-ellipsis> sequential_patching_model </span> </a> </li> <li class=md-nav__item> <a href=../data/patching_strategies/tiled_patching_model/ class=md-nav__link> <span class=md-ellipsis> tiled_patching_model </span> </a> </li> <li class=md-nav__item> <a href=../data/patching_strategies/whole_patching_model/ class=md-nav__link> <span class=md-ellipsis> whole_patching_model </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../inference_model/ class=md-nav__link> <span class=md-ellipsis> inference_model </span> </a> </li> <li class=md-nav__item> <a href=../likelihood_model/ class=md-nav__link> <span class=md-ellipsis> likelihood_model </span> </a> </li> <li class=md-nav__item> <a href=../loss_model/ class=md-nav__link> <span class=md-ellipsis> loss_model </span> </a> </li> <li class=md-nav__item> <a href=../nm_model/ class=md-nav__link> <span class=md-ellipsis> nm_model </span> </a> </li> <li class=md-nav__item> <a href=../optimizer_models/ class=md-nav__link> <span class=md-ellipsis> optimizer_models </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_2_4_13> <label class=md-nav__link for=__nav_7_2_4_13 id=__nav_7_2_4_13_label tabindex=0> <span class=md-ellipsis> support </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_7_2_4_13_label aria-expanded=false> <label class=md-nav__title for=__nav_7_2_4_13> <span class="md-nav__icon md-icon"></span> support </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../support/supported_activations/ class=md-nav__link> <span class=md-ellipsis> supported_activations </span> </a> </li> <li class=md-nav__item> <a href=../support/supported_algorithms/ class=md-nav__link> <span class=md-ellipsis> supported_algorithms </span> </a> </li> <li class=md-nav__item> <a href=../support/supported_architectures/ class=md-nav__link> <span class=md-ellipsis> supported_architectures </span> </a> </li> <li class=md-nav__item> <a href=../support/supported_data/ class=md-nav__link> <span class=md-ellipsis> supported_data </span> </a> </li> <li class=md-nav__item> <a href=../support/supported_filters/ class=md-nav__link> <span class=md-ellipsis> supported_filters </span> </a> </li> <li class=md-nav__item> <a href=../support/supported_loggers/ class=md-nav__link> <span class=md-ellipsis> supported_loggers </span> </a> </li> <li class=md-nav__item> <a href=../support/supported_losses/ class=md-nav__link> <span class=md-ellipsis> supported_losses </span> </a> </li> <li class=md-nav__item> <a href=../support/supported_optimizers/ class=md-nav__link> <span class=md-ellipsis> supported_optimizers </span> </a> </li> <li class=md-nav__item> <a href=../support/supported_patching_strategies/ class=md-nav__link> <span class=md-ellipsis> supported_patching_strategies </span> </a> </li> <li class=md-nav__item> <a href=../support/supported_pixel_manipulations/ class=md-nav__link> <span class=md-ellipsis> supported_pixel_manipulations </span> </a> </li> <li class=md-nav__item> <a href=../support/supported_struct_axis/ class=md-nav__link> <span class=md-ellipsis> supported_struct_axis </span> </a> </li> <li class=md-nav__item> <a href=../support/supported_transforms/ class=md-nav__link> <span class=md-ellipsis> supported_transforms </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../tile_information/ class=md-nav__link> <span class=md-ellipsis> tile_information </span> </a> </li> <li class=md-nav__item> <a href=../training_model/ class=md-nav__link> <span class=md-ellipsis> training_model </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_2_4_16> <label class=md-nav__link for=__nav_7_2_4_16 id=__nav_7_2_4_16_label tabindex=0> <span class=md-ellipsis> transformations </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_7_2_4_16_label aria-expanded=false> <label class=md-nav__title for=__nav_7_2_4_16> <span class="md-nav__icon md-icon"></span> transformations </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../transformations/n2v_manipulate_model/ class=md-nav__link> <span class=md-ellipsis> n2v_manipulate_model </span> </a> </li> <li class=md-nav__item> <a href=../transformations/normalize_model/ class=md-nav__link> <span class=md-ellipsis> normalize_model </span> </a> </li> <li class=md-nav__item> <a href=../transformations/transform_model/ class=md-nav__link> <span class=md-ellipsis> transform_model </span> </a> </li> <li class=md-nav__item> <a href=../transformations/transform_unions/ class=md-nav__link> <span class=md-ellipsis> transform_unions </span> </a> </li> <li class=md-nav__item> <a href=../transformations/xy_flip_model/ class=md-nav__link> <span class=md-ellipsis> xy_flip_model </span> </a> </li> <li class=md-nav__item> <a href=../transformations/xy_random_rotate90_model/ class=md-nav__link> <span class=md-ellipsis> xy_random_rotate90_model </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_2_4_17> <label class=md-nav__link for=__nav_7_2_4_17 id=__nav_7_2_4_17_label tabindex=0> <span class=md-ellipsis> validators </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_7_2_4_17_label aria-expanded=false> <label class=md-nav__title for=__nav_7_2_4_17> <span class="md-nav__icon md-icon"></span> validators </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../validators/model_validators/ class=md-nav__link> <span class=md-ellipsis> model_validators </span> </a> </li> <li class=md-nav__item> <a href=../validators/validator_utils/ class=md-nav__link> <span class=md-ellipsis> validator_utils </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../conftest/ class=md-nav__link> <span class=md-ellipsis> conftest </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_2_6> <label class=md-nav__link for=__nav_7_2_6 id=__nav_7_2_6_label tabindex=0> <span class=md-ellipsis> dataset </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_7_2_6_label aria-expanded=false> <label class=md-nav__title for=__nav_7_2_6> <span class="md-nav__icon md-icon"></span> dataset </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_2_6_1> <label class=md-nav__link for=__nav_7_2_6_1 id=__nav_7_2_6_1_label tabindex=0> <span class=md-ellipsis> dataset_utils </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_7_2_6_1_label aria-expanded=false> <label class=md-nav__title for=__nav_7_2_6_1> <span class="md-nav__icon md-icon"></span> dataset_utils </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../dataset/dataset_utils/dataset_utils/ class=md-nav__link> <span class=md-ellipsis> dataset_utils </span> </a> </li> <li class=md-nav__item> <a href=../../dataset/dataset_utils/file_utils/ class=md-nav__link> <span class=md-ellipsis> file_utils </span> </a> </li> <li class=md-nav__item> <a href=../../dataset/dataset_utils/iterate_over_files/ class=md-nav__link> <span class=md-ellipsis> iterate_over_files </span> </a> </li> <li class=md-nav__item> <a href=../../dataset/dataset_utils/running_stats/ class=md-nav__link> <span class=md-ellipsis> running_stats </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../dataset/in_memory_dataset/ class=md-nav__link> <span class=md-ellipsis> in_memory_dataset </span> </a> </li> <li class=md-nav__item> <a href=../../dataset/in_memory_pred_dataset/ class=md-nav__link> <span class=md-ellipsis> in_memory_pred_dataset </span> </a> </li> <li class=md-nav__item> <a href=../../dataset/in_memory_tiled_pred_dataset/ class=md-nav__link> <span class=md-ellipsis> in_memory_tiled_pred_dataset </span> </a> </li> <li class=md-nav__item> <a href=../../dataset/iterable_dataset/ class=md-nav__link> <span class=md-ellipsis> iterable_dataset </span> </a> </li> <li class=md-nav__item> <a href=../../dataset/iterable_pred_dataset/ class=md-nav__link> <span class=md-ellipsis> iterable_pred_dataset </span> </a> </li> <li class=md-nav__item> <a href=../../dataset/iterable_tiled_pred_dataset/ class=md-nav__link> <span class=md-ellipsis> iterable_tiled_pred_dataset </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_2_6_8> <label class=md-nav__link for=__nav_7_2_6_8 id=__nav_7_2_6_8_label tabindex=0> <span class=md-ellipsis> patching </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_7_2_6_8_label aria-expanded=false> <label class=md-nav__title for=__nav_7_2_6_8> <span class="md-nav__icon md-icon"></span> patching </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../dataset/patching/patching/ class=md-nav__link> <span class=md-ellipsis> patching </span> </a> </li> <li class=md-nav__item> <a href=../../dataset/patching/random_patching/ class=md-nav__link> <span class=md-ellipsis> random_patching </span> </a> </li> <li class=md-nav__item> <a href=../../dataset/patching/sequential_patching/ class=md-nav__link> <span class=md-ellipsis> sequential_patching </span> </a> </li> <li class=md-nav__item> <a href=../../dataset/patching/validate_patch_dimension/ class=md-nav__link> <span class=md-ellipsis> validate_patch_dimension </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_2_6_9> <label class=md-nav__link for=__nav_7_2_6_9 id=__nav_7_2_6_9_label tabindex=0> <span class=md-ellipsis> tiling </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_7_2_6_9_label aria-expanded=false> <label class=md-nav__title for=__nav_7_2_6_9> <span class="md-nav__icon md-icon"></span> tiling </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../dataset/tiling/collate_tiles/ class=md-nav__link> <span class=md-ellipsis> collate_tiles </span> </a> </li> <li class=md-nav__item> <a href=../../dataset/tiling/lvae_tiled_patching/ class=md-nav__link> <span class=md-ellipsis> lvae_tiled_patching </span> </a> </li> <li class=md-nav__item> <a href=../../dataset/tiling/tiled_patching/ class=md-nav__link> <span class=md-ellipsis> tiled_patching </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_2_7> <label class=md-nav__link for=__nav_7_2_7 id=__nav_7_2_7_label tabindex=0> <span class=md-ellipsis> dataset_ng </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_7_2_7_label aria-expanded=false> <label class=md-nav__title for=__nav_7_2_7> <span class="md-nav__icon md-icon"></span> dataset_ng </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../dataset_ng/dataset.md class=md-nav__link> <span class=md-ellipsis> dataset </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_2_7_2> <label class=md-nav__link for=__nav_7_2_7_2 id=__nav_7_2_7_2_label tabindex=0> <span class=md-ellipsis> demos </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_7_2_7_2_label aria-expanded=false> <label class=md-nav__title for=__nav_7_2_7_2> <span class="md-nav__icon md-icon"></span> demos </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../dataset_ng/demos/demo_patch_extractor.md class=md-nav__link> <span class=md-ellipsis> demo_patch_extractor </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../dataset_ng/factory.md class=md-nav__link> <span class=md-ellipsis> factory </span> </a> </li> <li class=md-nav__item> <a href=../../dataset_ng/legacy_interoperability.md class=md-nav__link> <span class=md-ellipsis> legacy_interoperability </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_2_7_5> <label class=md-nav__link for=__nav_7_2_7_5 id=__nav_7_2_7_5_label tabindex=0> <span class=md-ellipsis> patch_extractor </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_7_2_7_5_label aria-expanded=false> <label class=md-nav__title for=__nav_7_2_7_5> <span class="md-nav__icon md-icon"></span> patch_extractor </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_2_7_5_1> <label class=md-nav__link for=__nav_7_2_7_5_1 id=__nav_7_2_7_5_1_label tabindex=0> <span class=md-ellipsis> image_stack </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=5 aria-labelledby=__nav_7_2_7_5_1_label aria-expanded=false> <label class=md-nav__title for=__nav_7_2_7_5_1> <span class="md-nav__icon md-icon"></span> image_stack </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../dataset_ng/patch_extractor/image_stack/czi_image_stack.md class=md-nav__link> <span class=md-ellipsis> czi_image_stack </span> </a> </li> <li class=md-nav__item> <a href=../../dataset_ng/patch_extractor/image_stack/image_stack_protocol.md class=md-nav__link> <span class=md-ellipsis> image_stack_protocol </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_2_7_5_1_3> <label class=md-nav__link for=__nav_7_2_7_5_1_3 id=__nav_7_2_7_5_1_3_label tabindex=0> <span class=md-ellipsis> image_utils </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=6 aria-labelledby=__nav_7_2_7_5_1_3_label aria-expanded=false> <label class=md-nav__title for=__nav_7_2_7_5_1_3> <span class="md-nav__icon md-icon"></span> image_utils </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../dataset_ng/patch_extractor/image_stack/image_utils/zarr_utils.md class=md-nav__link> <span class=md-ellipsis> zarr_utils </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../dataset_ng/patch_extractor/image_stack/in_memory_image_stack.md class=md-nav__link> <span class=md-ellipsis> in_memory_image_stack </span> </a> </li> <li class=md-nav__item> <a href=../../dataset_ng/patch_extractor/image_stack/utils.md class=md-nav__link> <span class=md-ellipsis> utils </span> </a> </li> <li class=md-nav__item> <a href=../../dataset_ng/patch_extractor/image_stack/zarr_image_stack.md class=md-nav__link> <span class=md-ellipsis> zarr_image_stack </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../dataset_ng/patch_extractor/image_stack_loader.md class=md-nav__link> <span class=md-ellipsis> image_stack_loader </span> </a> </li> <li class=md-nav__item> <a href=../../dataset_ng/patch_extractor/patch_extractor.md class=md-nav__link> <span class=md-ellipsis> patch_extractor </span> </a> </li> <li class=md-nav__item> <a href=../../dataset_ng/patch_extractor/patch_extractor_factory.md class=md-nav__link> <span class=md-ellipsis> patch_extractor_factory </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_2_7_6> <label class=md-nav__link for=__nav_7_2_7_6 id=__nav_7_2_7_6_label tabindex=0> <span class=md-ellipsis> patch_filter </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_7_2_7_6_label aria-expanded=false> <label class=md-nav__title for=__nav_7_2_7_6> <span class="md-nav__icon md-icon"></span> patch_filter </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../dataset_ng/patch_filter/coordinate_filter_protocol.md class=md-nav__link> <span class=md-ellipsis> coordinate_filter_protocol </span> </a> </li> <li class=md-nav__item> <a href=../../dataset_ng/patch_filter/filter_factory.md class=md-nav__link> <span class=md-ellipsis> filter_factory </span> </a> </li> <li class=md-nav__item> <a href=../../dataset_ng/patch_filter/mask_filter.md class=md-nav__link> <span class=md-ellipsis> mask_filter </span> </a> </li> <li class=md-nav__item> <a href=../../dataset_ng/patch_filter/max_filter.md class=md-nav__link> <span class=md-ellipsis> max_filter </span> </a> </li> <li class=md-nav__item> <a href=../../dataset_ng/patch_filter/mean_std_filter.md class=md-nav__link> <span class=md-ellipsis> mean_std_filter </span> </a> </li> <li class=md-nav__item> <a href=../../dataset_ng/patch_filter/patch_filter_protocol.md class=md-nav__link> <span class=md-ellipsis> patch_filter_protocol </span> </a> </li> <li class=md-nav__item> <a href=../../dataset_ng/patch_filter/shannon_filter.md class=md-nav__link> <span class=md-ellipsis> shannon_filter </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_2_7_7> <label class=md-nav__link for=__nav_7_2_7_7 id=__nav_7_2_7_7_label tabindex=0> <span class=md-ellipsis> patching_strategies </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_7_2_7_7_label aria-expanded=false> <label class=md-nav__title for=__nav_7_2_7_7> <span class="md-nav__icon md-icon"></span> patching_strategies </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../dataset_ng/patching_strategies/patching_strategy_protocol.md class=md-nav__link> <span class=md-ellipsis> patching_strategy_protocol </span> </a> </li> <li class=md-nav__item> <a href=../../dataset_ng/patching_strategies/random_patching.md class=md-nav__link> <span class=md-ellipsis> random_patching </span> </a> </li> <li class=md-nav__item> <a href=../../dataset_ng/patching_strategies/sequential_patching.md class=md-nav__link> <span class=md-ellipsis> sequential_patching </span> </a> </li> <li class=md-nav__item> <a href=../../dataset_ng/patching_strategies/tiling_strategy.md class=md-nav__link> <span class=md-ellipsis> tiling_strategy </span> </a> </li> <li class=md-nav__item> <a href=../../dataset_ng/patching_strategies/whole_sample.md class=md-nav__link> <span class=md-ellipsis> whole_sample </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_2_8> <label class=md-nav__link for=__nav_7_2_8 id=__nav_7_2_8_label tabindex=0> <span class=md-ellipsis> file_io </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_7_2_8_label aria-expanded=false> <label class=md-nav__title for=__nav_7_2_8> <span class="md-nav__icon md-icon"></span> file_io </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_2_8_1> <label class=md-nav__link for=__nav_7_2_8_1 id=__nav_7_2_8_1_label tabindex=0> <span class=md-ellipsis> read </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_7_2_8_1_label aria-expanded=false> <label class=md-nav__title for=__nav_7_2_8_1> <span class="md-nav__icon md-icon"></span> read </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../file_io/read/get_func/ class=md-nav__link> <span class=md-ellipsis> get_func </span> </a> </li> <li class=md-nav__item> <a href=../../file_io/read/tiff/ class=md-nav__link> <span class=md-ellipsis> tiff </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_2_8_2> <label class=md-nav__link for=__nav_7_2_8_2 id=__nav_7_2_8_2_label tabindex=0> <span class=md-ellipsis> write </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_7_2_8_2_label aria-expanded=false> <label class=md-nav__title for=__nav_7_2_8_2> <span class="md-nav__icon md-icon"></span> write </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../file_io/write/get_func/ class=md-nav__link> <span class=md-ellipsis> get_func </span> </a> </li> <li class=md-nav__item> <a href=../../file_io/write/tiff/ class=md-nav__link> <span class=md-ellipsis> tiff </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_2_9> <label class=md-nav__link for=__nav_7_2_9 id=__nav_7_2_9_label tabindex=0> <span class=md-ellipsis> lightning </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_7_2_9_label aria-expanded=false> <label class=md-nav__title for=__nav_7_2_9> <span class="md-nav__icon md-icon"></span> lightning </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_2_9_1> <label class=md-nav__link for=__nav_7_2_9_1 id=__nav_7_2_9_1_label tabindex=0> <span class=md-ellipsis> callbacks </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_7_2_9_1_label aria-expanded=false> <label class=md-nav__title for=__nav_7_2_9_1> <span class="md-nav__icon md-icon"></span> callbacks </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../lightning/callbacks/data_stats_callback/ class=md-nav__link> <span class=md-ellipsis> data_stats_callback </span> </a> </li> <li class=md-nav__item> <a href=../../lightning/callbacks/hyperparameters_callback/ class=md-nav__link> <span class=md-ellipsis> hyperparameters_callback </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_2_9_1_3> <label class=md-nav__link for=__nav_7_2_9_1_3 id=__nav_7_2_9_1_3_label tabindex=0> <span class=md-ellipsis> prediction_writer_callback </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=5 aria-labelledby=__nav_7_2_9_1_3_label aria-expanded=false> <label class=md-nav__title for=__nav_7_2_9_1_3> <span class="md-nav__icon md-icon"></span> prediction_writer_callback </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../lightning/callbacks/prediction_writer_callback/file_path_utils/ class=md-nav__link> <span class=md-ellipsis> file_path_utils </span> </a> </li> <li class=md-nav__item> <a href=../../lightning/callbacks/prediction_writer_callback/prediction_writer_callback/ class=md-nav__link> <span class=md-ellipsis> prediction_writer_callback </span> </a> </li> <li class=md-nav__item> <a href=../../lightning/callbacks/prediction_writer_callback/write_strategy/ class=md-nav__link> <span class=md-ellipsis> write_strategy </span> </a> </li> <li class=md-nav__item> <a href=../../lightning/callbacks/prediction_writer_callback/write_strategy_factory/ class=md-nav__link> <span class=md-ellipsis> write_strategy_factory </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../lightning/callbacks/progress_bar_callback/ class=md-nav__link> <span class=md-ellipsis> progress_bar_callback </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_2_9_2> <label class=md-nav__link for=__nav_7_2_9_2 id=__nav_7_2_9_2_label tabindex=0> <span class=md-ellipsis> dataset_ng </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_7_2_9_2_label aria-expanded=false> <label class=md-nav__title for=__nav_7_2_9_2> <span class="md-nav__icon md-icon"></span> dataset_ng </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../lightning/dataset_ng/data_module/ class=md-nav__link> <span class=md-ellipsis> data_module </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_2_9_2_2> <label class=md-nav__link for=__nav_7_2_9_2_2 id=__nav_7_2_9_2_2_label tabindex=0> <span class=md-ellipsis> lightning_modules </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=5 aria-labelledby=__nav_7_2_9_2_2_label aria-expanded=false> <label class=md-nav__title for=__nav_7_2_9_2_2> <span class="md-nav__icon md-icon"></span> lightning_modules </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../lightning/dataset_ng/lightning_modules/care_module/ class=md-nav__link> <span class=md-ellipsis> care_module </span> </a> </li> <li class=md-nav__item> <a href=../../lightning/dataset_ng/lightning_modules/n2v_module/ class=md-nav__link> <span class=md-ellipsis> n2v_module </span> </a> </li> <li class=md-nav__item> <a href=../../lightning/dataset_ng/lightning_modules/unet_module/ class=md-nav__link> <span class=md-ellipsis> unet_module </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../lightning/lightning_module/ class=md-nav__link> <span class=md-ellipsis> lightning_module </span> </a> </li> <li class=md-nav__item> <a href=../../lightning/microsplit_data_module/ class=md-nav__link> <span class=md-ellipsis> microsplit_data_module </span> </a> </li> <li class=md-nav__item> <a href=../../lightning/predict_data_module/ class=md-nav__link> <span class=md-ellipsis> predict_data_module </span> </a> </li> <li class=md-nav__item> <a href=../../lightning/train_data_module/ class=md-nav__link> <span class=md-ellipsis> train_data_module </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_2_10> <label class=md-nav__link for=__nav_7_2_10 id=__nav_7_2_10_label tabindex=0> <span class=md-ellipsis> losses </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_7_2_10_label aria-expanded=false> <label class=md-nav__title for=__nav_7_2_10> <span class="md-nav__icon md-icon"></span> losses </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_2_10_1> <label class=md-nav__link for=__nav_7_2_10_1 id=__nav_7_2_10_1_label tabindex=0> <span class=md-ellipsis> fcn </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_7_2_10_1_label aria-expanded=false> <label class=md-nav__title for=__nav_7_2_10_1> <span class="md-nav__icon md-icon"></span> fcn </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../losses/fcn/losses/ class=md-nav__link> <span class=md-ellipsis> losses </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../losses/loss_factory/ class=md-nav__link> <span class=md-ellipsis> loss_factory </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_2_10_3> <label class=md-nav__link for=__nav_7_2_10_3 id=__nav_7_2_10_3_label tabindex=0> <span class=md-ellipsis> lvae </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_7_2_10_3_label aria-expanded=false> <label class=md-nav__title for=__nav_7_2_10_3> <span class="md-nav__icon md-icon"></span> lvae </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../losses/lvae/loss_utils/ class=md-nav__link> <span class=md-ellipsis> loss_utils </span> </a> </li> <li class=md-nav__item> <a href=../../losses/lvae/losses/ class=md-nav__link> <span class=md-ellipsis> losses </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_2_11> <label class=md-nav__link for=__nav_7_2_11 id=__nav_7_2_11_label tabindex=0> <span class=md-ellipsis> lvae_training </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_7_2_11_label aria-expanded=false> <label class=md-nav__title for=__nav_7_2_11> <span class="md-nav__icon md-icon"></span> lvae_training </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../lvae_training/calibration/ class=md-nav__link> <span class=md-ellipsis> calibration </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_2_11_2> <label class=md-nav__link for=__nav_7_2_11_2 id=__nav_7_2_11_2_label tabindex=0> <span class=md-ellipsis> dataset </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_7_2_11_2_label aria-expanded=false> <label class=md-nav__title for=__nav_7_2_11_2> <span class="md-nav__icon md-icon"></span> dataset </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../lvae_training/dataset/config/ class=md-nav__link> <span class=md-ellipsis> config </span> </a> </li> <li class=md-nav__item> <a href=../../lvae_training/dataset/lc_dataset/ class=md-nav__link> <span class=md-ellipsis> lc_dataset </span> </a> </li> <li class=md-nav__item> <a href=../../lvae_training/dataset/ms_dataset_ref/ class=md-nav__link> <span class=md-ellipsis> ms_dataset_ref </span> </a> </li> <li class=md-nav__item> <a href=../../lvae_training/dataset/multich_dataset/ class=md-nav__link> <span class=md-ellipsis> multich_dataset </span> </a> </li> <li class=md-nav__item> <a href=../../lvae_training/dataset/multicrop_dset/ class=md-nav__link> <span class=md-ellipsis> multicrop_dset </span> </a> </li> <li class=md-nav__item> <a href=../../lvae_training/dataset/multifile_dataset/ class=md-nav__link> <span class=md-ellipsis> multifile_dataset </span> </a> </li> <li class=md-nav__item> <a href=../../lvae_training/dataset/types/ class=md-nav__link> <span class=md-ellipsis> types </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_2_11_2_8> <label class=md-nav__link for=__nav_7_2_11_2_8 id=__nav_7_2_11_2_8_label tabindex=0> <span class=md-ellipsis> utils </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=5 aria-labelledby=__nav_7_2_11_2_8_label aria-expanded=false> <label class=md-nav__title for=__nav_7_2_11_2_8> <span class="md-nav__icon md-icon"></span> utils </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../lvae_training/dataset/utils/data_utils/ class=md-nav__link> <span class=md-ellipsis> data_utils </span> </a> </li> <li class=md-nav__item> <a href=../../lvae_training/dataset/utils/empty_patch_fetcher/ class=md-nav__link> <span class=md-ellipsis> empty_patch_fetcher </span> </a> </li> <li class=md-nav__item> <a href=../../lvae_training/dataset/utils/index_manager/ class=md-nav__link> <span class=md-ellipsis> index_manager </span> </a> </li> <li class=md-nav__item> <a href=../../lvae_training/dataset/utils/index_switcher/ class=md-nav__link> <span class=md-ellipsis> index_switcher </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../lvae_training/eval_utils/ class=md-nav__link> <span class=md-ellipsis> eval_utils </span> </a> </li> <li class=md-nav__item> <a href=../../lvae_training/get_config/ class=md-nav__link> <span class=md-ellipsis> get_config </span> </a> </li> <li class=md-nav__item> <a href=../../lvae_training/lightning_module/ class=md-nav__link> <span class=md-ellipsis> lightning_module </span> </a> </li> <li class=md-nav__item> <a href=../../lvae_training/metrics/ class=md-nav__link> <span class=md-ellipsis> metrics </span> </a> </li> <li class=md-nav__item> <a href=../../lvae_training/train_lvae/ class=md-nav__link> <span class=md-ellipsis> train_lvae </span> </a> </li> <li class=md-nav__item> <a href=../../lvae_training/train_utils/ class=md-nav__link> <span class=md-ellipsis> train_utils </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_2_12> <label class=md-nav__link for=__nav_7_2_12 id=__nav_7_2_12_label tabindex=0> <span class=md-ellipsis> model_io </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_7_2_12_label aria-expanded=false> <label class=md-nav__title for=__nav_7_2_12> <span class="md-nav__icon md-icon"></span> model_io </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_2_12_1> <label class=md-nav__link for=__nav_7_2_12_1 id=__nav_7_2_12_1_label tabindex=0> <span class=md-ellipsis> bioimage </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_7_2_12_1_label aria-expanded=false> <label class=md-nav__title for=__nav_7_2_12_1> <span class="md-nav__icon md-icon"></span> bioimage </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../model_io/bioimage/_readme_factory/ class=md-nav__link> <span class=md-ellipsis> _readme_factory </span> </a> </li> <li class=md-nav__item> <a href=../../model_io/bioimage/bioimage_utils/ class=md-nav__link> <span class=md-ellipsis> bioimage_utils </span> </a> </li> <li class=md-nav__item> <a href=../../model_io/bioimage/cover_factory/ class=md-nav__link> <span class=md-ellipsis> cover_factory </span> </a> </li> <li class=md-nav__item> <a href=../../model_io/bioimage/model_description/ class=md-nav__link> <span class=md-ellipsis> model_description </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../model_io/bmz_io/ class=md-nav__link> <span class=md-ellipsis> bmz_io </span> </a> </li> <li class=md-nav__item> <a href=../../model_io/model_io_utils/ class=md-nav__link> <span class=md-ellipsis> model_io_utils </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_2_13> <label class=md-nav__link for=__nav_7_2_13 id=__nav_7_2_13_label tabindex=0> <span class=md-ellipsis> models </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_7_2_13_label aria-expanded=false> <label class=md-nav__title for=__nav_7_2_13> <span class="md-nav__icon md-icon"></span> models </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../models/activation/ class=md-nav__link> <span class=md-ellipsis> activation </span> </a> </li> <li class=md-nav__item> <a href=../../models/layers/ class=md-nav__link> <span class=md-ellipsis> layers </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_2_13_3> <label class=md-nav__link for=__nav_7_2_13_3 id=__nav_7_2_13_3_label tabindex=0> <span class=md-ellipsis> lvae </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_7_2_13_3_label aria-expanded=false> <label class=md-nav__title for=__nav_7_2_13_3> <span class="md-nav__icon md-icon"></span> lvae </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../models/lvae/layers/ class=md-nav__link> <span class=md-ellipsis> layers </span> </a> </li> <li class=md-nav__item> <a href=../../models/lvae/likelihoods/ class=md-nav__link> <span class=md-ellipsis> likelihoods </span> </a> </li> <li class=md-nav__item> <a href=../../models/lvae/lvae/ class=md-nav__link> <span class=md-ellipsis> lvae </span> </a> </li> <li class=md-nav__item> <a href=../../models/lvae/noise_models/ class=md-nav__link> <span class=md-ellipsis> noise_models </span> </a> </li> <li class=md-nav__item> <a href=../../models/lvae/stochastic/ class=md-nav__link> <span class=md-ellipsis> stochastic </span> </a> </li> <li class=md-nav__item> <a href=../../models/lvae/utils/ class=md-nav__link> <span class=md-ellipsis> utils </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../models/model_factory/ class=md-nav__link> <span class=md-ellipsis> model_factory </span> </a> </li> <li class=md-nav__item> <a href=../../models/unet/ class=md-nav__link> <span class=md-ellipsis> unet </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_2_14> <label class=md-nav__link for=__nav_7_2_14 id=__nav_7_2_14_label tabindex=0> <span class=md-ellipsis> prediction_utils </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_7_2_14_label aria-expanded=false> <label class=md-nav__title for=__nav_7_2_14> <span class="md-nav__icon md-icon"></span> prediction_utils </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../prediction_utils/lvae_prediction/ class=md-nav__link> <span class=md-ellipsis> lvae_prediction </span> </a> </li> <li class=md-nav__item> <a href=../../prediction_utils/lvae_tiling_manager/ class=md-nav__link> <span class=md-ellipsis> lvae_tiling_manager </span> </a> </li> <li class=md-nav__item> <a href=../../prediction_utils/prediction_outputs/ class=md-nav__link> <span class=md-ellipsis> prediction_outputs </span> </a> </li> <li class=md-nav__item> <a href=../../prediction_utils/stitch_prediction/ class=md-nav__link> <span class=md-ellipsis> stitch_prediction </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_2_15> <label class=md-nav__link for=__nav_7_2_15 id=__nav_7_2_15_label tabindex=0> <span class=md-ellipsis> transforms </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_7_2_15_label aria-expanded=false> <label class=md-nav__title for=__nav_7_2_15> <span class="md-nav__icon md-icon"></span> transforms </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../transforms/compose/ class=md-nav__link> <span class=md-ellipsis> compose </span> </a> </li> <li class=md-nav__item> <a href=../../transforms/n2v_manipulate/ class=md-nav__link> <span class=md-ellipsis> n2v_manipulate </span> </a> </li> <li class=md-nav__item> <a href=../../transforms/n2v_manipulate_torch/ class=md-nav__link> <span class=md-ellipsis> n2v_manipulate_torch </span> </a> </li> <li class=md-nav__item> <a href=../../transforms/normalize/ class=md-nav__link> <span class=md-ellipsis> normalize </span> </a> </li> <li class=md-nav__item> <a href=../../transforms/pixel_manipulation/ class=md-nav__link> <span class=md-ellipsis> pixel_manipulation </span> </a> </li> <li class=md-nav__item> <a href=../../transforms/pixel_manipulation_torch/ class=md-nav__link> <span class=md-ellipsis> pixel_manipulation_torch </span> </a> </li> <li class=md-nav__item> <a href=../../transforms/struct_mask_parameters/ class=md-nav__link> <span class=md-ellipsis> struct_mask_parameters </span> </a> </li> <li class=md-nav__item> <a href=../../transforms/transform/ class=md-nav__link> <span class=md-ellipsis> transform </span> </a> </li> <li class=md-nav__item> <a href=../../transforms/tta/ class=md-nav__link> <span class=md-ellipsis> tta </span> </a> </li> <li class=md-nav__item> <a href=../../transforms/xy_flip/ class=md-nav__link> <span class=md-ellipsis> xy_flip </span> </a> </li> <li class=md-nav__item> <a href=../../transforms/xy_random_rotate90/ class=md-nav__link> <span class=md-ellipsis> xy_random_rotate90 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_2_16> <label class=md-nav__link for=__nav_7_2_16 id=__nav_7_2_16_label tabindex=0> <span class=md-ellipsis> utils </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_7_2_16_label aria-expanded=false> <label class=md-nav__title for=__nav_7_2_16> <span class="md-nav__icon md-icon"></span> utils </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../utils/autocorrelation/ class=md-nav__link> <span class=md-ellipsis> autocorrelation </span> </a> </li> <li class=md-nav__item> <a href=../../utils/base_enum/ class=md-nav__link> <span class=md-ellipsis> base_enum </span> </a> </li> <li class=md-nav__item> <a href=../../utils/context/ class=md-nav__link> <span class=md-ellipsis> context </span> </a> </li> <li class=md-nav__item> <a href=../../utils/lightning_utils/ class=md-nav__link> <span class=md-ellipsis> lightning_utils </span> </a> </li> <li class=md-nav__item> <a href=../../utils/logging/ class=md-nav__link> <span class=md-ellipsis> logging </span> </a> </li> <li class=md-nav__item> <a href=../../utils/metrics/ class=md-nav__link> <span class=md-ellipsis> metrics </span> </a> </li> <li class=md-nav__item> <a href=../../utils/path_utils/ class=md-nav__link> <span class=md-ellipsis> path_utils </span> </a> </li> <li class=md-nav__item> <a href=../../utils/plotting/ class=md-nav__link> <span class=md-ellipsis> plotting </span> </a> </li> <li class=md-nav__item> <a href=../../utils/ram/ class=md-nav__link> <span class=md-ellipsis> ram </span> </a> </li> <li class=md-nav__item> <a href=../../utils/receptive_field/ class=md-nav__link> <span class=md-ellipsis> receptive_field </span> </a> </li> <li class=md-nav__item> <a href=../../utils/serializers/ class=md-nav__link> <span class=md-ellipsis> serializers </span> </a> </li> <li class=md-nav__item> <a href=../../utils/torch_utils/ class=md-nav__link> <span class=md-ellipsis> torch_utils </span> </a> </li> <li class=md-nav__item> <a href=../../utils/version/ class=md-nav__link> <span class=md-ellipsis> version </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_3> <div class="md-nav__link md-nav__container"> <a href=../../../careamics_napari/ class="md-nav__link "> <span class=md-ellipsis> careamics_napari </span> </a> <label class="md-nav__link " for=__nav_7_3 id=__nav_7_3_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_7_3_label aria-expanded=false> <label class=md-nav__title for=__nav_7_3> <span class="md-nav__icon md-icon"></span> careamics_napari </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../careamics_napari/_version/ class=md-nav__link> <span class=md-ellipsis> _version </span> </a> </li> <li class=md-nav__item> <a href=../../../careamics_napari/base_plugin/ class=md-nav__link> <span class=md-ellipsis> base_plugin </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_3_4> <label class=md-nav__link for=__nav_7_3_4 id=__nav_7_3_4_label tabindex=0> <span class=md-ellipsis> bmz </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_7_3_4_label aria-expanded=false> <label class=md-nav__title for=__nav_7_3_4> <span class="md-nav__icon md-icon"></span> bmz </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../careamics_napari/bmz/author_widget/ class=md-nav__link> <span class=md-ellipsis> author_widget </span> </a> </li> <li class=md-nav__item> <a href=../../../careamics_napari/bmz/bmz_export_widget/ class=md-nav__link> <span class=md-ellipsis> bmz_export_widget </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../careamics_napari/care_plugin/ class=md-nav__link> <span class=md-ellipsis> care_plugin </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_3_6> <label class=md-nav__link for=__nav_7_3_6 id=__nav_7_3_6_label tabindex=0> <span class=md-ellipsis> careamics_utils </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_7_3_6_label aria-expanded=false> <label class=md-nav__title for=__nav_7_3_6> <span class="md-nav__icon md-icon"></span> careamics_utils </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../careamics_napari/careamics_utils/algorithms/ class=md-nav__link> <span class=md-ellipsis> algorithms </span> </a> </li> <li class=md-nav__item> <a href=../../../careamics_napari/careamics_utils/callbacks/ class=md-nav__link> <span class=md-ellipsis> callbacks </span> </a> </li> <li class=md-nav__item> <a href=../../../careamics_napari/careamics_utils/care_configs/ class=md-nav__link> <span class=md-ellipsis> care_configs </span> </a> </li> <li class=md-nav__item> <a href=../../../careamics_napari/careamics_utils/configs/ class=md-nav__link> <span class=md-ellipsis> configs </span> </a> </li> <li class=md-nav__item> <a href=../../../careamics_napari/careamics_utils/free_memory/ class=md-nav__link> <span class=md-ellipsis> free_memory </span> </a> </li> <li class=md-nav__item> <a href=../../../careamics_napari/careamics_utils/n2n_configs/ class=md-nav__link> <span class=md-ellipsis> n2n_configs </span> </a> </li> <li class=md-nav__item> <a href=../../../careamics_napari/careamics_utils/n2v_configs/ class=md-nav__link> <span class=md-ellipsis> n2v_configs </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../careamics_napari/n2n_plugin/ class=md-nav__link> <span class=md-ellipsis> n2n_plugin </span> </a> </li> <li class=md-nav__item> <a href=../../../careamics_napari/n2v_plugin/ class=md-nav__link> <span class=md-ellipsis> n2v_plugin </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_3_9> <label class=md-nav__link for=__nav_7_3_9 id=__nav_7_3_9_label tabindex=0> <span class=md-ellipsis> resources </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_7_3_9_label aria-expanded=false> <label class=md-nav__title for=__nav_7_3_9> <span class="md-nav__icon md-icon"></span> resources </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../careamics_napari/resources/resources/ class=md-nav__link> <span class=md-ellipsis> resources </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../careamics_napari/sample_data/ class=md-nav__link> <span class=md-ellipsis> sample_data </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_3_11> <label class=md-nav__link for=__nav_7_3_11 id=__nav_7_3_11_label tabindex=0> <span class=md-ellipsis> signals </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_7_3_11_label aria-expanded=false> <label class=md-nav__title for=__nav_7_3_11> <span class="md-nav__icon md-icon"></span> signals </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../careamics_napari/signals/prediction_status/ class=md-nav__link> <span class=md-ellipsis> prediction_status </span> </a> </li> <li class=md-nav__item> <a href=../../../careamics_napari/signals/saving_signal/ class=md-nav__link> <span class=md-ellipsis> saving_signal </span> </a> </li> <li class=md-nav__item> <a href=../../../careamics_napari/signals/saving_status/ class=md-nav__link> <span class=md-ellipsis> saving_status </span> </a> </li> <li class=md-nav__item> <a href=../../../careamics_napari/signals/training_status/ class=md-nav__link> <span class=md-ellipsis> training_status </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_3_12> <label class=md-nav__link for=__nav_7_3_12 id=__nav_7_3_12_label tabindex=0> <span class=md-ellipsis> utils </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_7_3_12_label aria-expanded=false> <label class=md-nav__title for=__nav_7_3_12> <span class="md-nav__icon md-icon"></span> utils </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../careamics_napari/utils/axes_utils/ class=md-nav__link> <span class=md-ellipsis> axes_utils </span> </a> </li> <li class=md-nav__item> <a href=../../../careamics_napari/utils/gpu_utils/ class=md-nav__link> <span class=md-ellipsis> gpu_utils </span> </a> </li> <li class=md-nav__item> <a href=../../../careamics_napari/utils/workers/ class=md-nav__link> <span class=md-ellipsis> workers </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_3_13> <label class=md-nav__link for=__nav_7_3_13 id=__nav_7_3_13_label tabindex=0> <span class=md-ellipsis> widgets </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_7_3_13_label aria-expanded=false> <label class=md-nav__title for=__nav_7_3_13> <span class="md-nav__icon md-icon"></span> widgets </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../careamics_napari/widgets/advanced_config/ class=md-nav__link> <span class=md-ellipsis> advanced_config </span> </a> </li> <li class=md-nav__item> <a href=../../../careamics_napari/widgets/axes_widget/ class=md-nav__link> <span class=md-ellipsis> axes_widget </span> </a> </li> <li class=md-nav__item> <a href=../../../careamics_napari/widgets/banner_widget/ class=md-nav__link> <span class=md-ellipsis> banner_widget </span> </a> </li> <li class=md-nav__item> <a href=../../../careamics_napari/widgets/care_config_window/ class=md-nav__link> <span class=md-ellipsis> care_config_window </span> </a> </li> <li class=md-nav__item> <a href=../../../careamics_napari/widgets/folder_widget/ class=md-nav__link> <span class=md-ellipsis> folder_widget </span> </a> </li> <li class=md-nav__item> <a href=../../../careamics_napari/widgets/gpu_widget/ class=md-nav__link> <span class=md-ellipsis> gpu_widget </span> </a> </li> <li class=md-nav__item> <a href=../../../careamics_napari/widgets/magicgui_widgets/ class=md-nav__link> <span class=md-ellipsis> magicgui_widgets </span> </a> </li> <li class=md-nav__item> <a href=../../../careamics_napari/widgets/n2n_config_window/ class=md-nav__link> <span class=md-ellipsis> n2n_config_window </span> </a> </li> <li class=md-nav__item> <a href=../../../careamics_napari/widgets/n2v_config_window/ class=md-nav__link> <span class=md-ellipsis> n2v_config_window </span> </a> </li> <li class=md-nav__item> <a href=../../../careamics_napari/widgets/predict_data_widget/ class=md-nav__link> <span class=md-ellipsis> predict_data_widget </span> </a> </li> <li class=md-nav__item> <a href=../../../careamics_napari/widgets/prediction_widget/ class=md-nav__link> <span class=md-ellipsis> prediction_widget </span> </a> </li> <li class=md-nav__item> <a href=../../../careamics_napari/widgets/qt_widgets/ class=md-nav__link> <span class=md-ellipsis> qt_widgets </span> </a> </li> <li class=md-nav__item> <a href=../../../careamics_napari/widgets/saving_widget/ class=md-nav__link> <span class=md-ellipsis> saving_widget </span> </a> </li> <li class=md-nav__item> <a href=../../../careamics_napari/widgets/scroll_wrapper/ class=md-nav__link> <span class=md-ellipsis> scroll_wrapper </span> </a> </li> <li class=md-nav__item> <a href=../../../careamics_napari/widgets/tbplot_widget/ class=md-nav__link> <span class=md-ellipsis> tbplot_widget </span> </a> </li> <li class=md-nav__item> <a href=../../../careamics_napari/widgets/train_data_widget/ class=md-nav__link> <span class=md-ellipsis> train_data_widget </span> </a> </li> <li class=md-nav__item> <a href=../../../careamics_napari/widgets/train_progress_widget/ class=md-nav__link> <span class=md-ellipsis> train_progress_widget </span> </a> </li> <li class=md-nav__item> <a href=../../../careamics_napari/widgets/training_configuration_widget/ class=md-nav__link> <span class=md-ellipsis> training_configuration_widget </span> </a> </li> <li class=md-nav__item> <a href=../../../careamics_napari/widgets/training_widget/ class=md-nav__link> <span class=md-ellipsis> training_widget </span> </a> </li> <li class=md-nav__item> <a href=../../../careamics_napari/widgets/utils/ class=md-nav__link> <span class=md-ellipsis> utils </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_3_14> <label class=md-nav__link for=__nav_7_3_14 id=__nav_7_3_14_label tabindex=0> <span class=md-ellipsis> workers </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_7_3_14_label aria-expanded=false> <label class=md-nav__title for=__nav_7_3_14> <span class="md-nav__icon md-icon"></span> workers </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../careamics_napari/workers/prediction_worker/ class=md-nav__link> <span class=md-ellipsis> prediction_worker </span> </a> </li> <li class=md-nav__item> <a href=../../../careamics_napari/workers/training_worker/ class=md-nav__link> <span class=md-ellipsis> training_worker </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="On This Page"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> On This Page </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#careamics.config.configuration_factories class=md-nav__link> <span class=md-ellipsis> configuration_factories </span> </a> </li> <li class=md-nav__item> <a href=#careamics.config.configuration_factories.algorithm_factory class=md-nav__link> <span class=md-ellipsis> algorithm_factory </span> </a> </li> <li class=md-nav__item> <a href=#careamics.config.configuration_factories.create_care_configuration class=md-nav__link> <span class=md-ellipsis> create_care_configuration </span> </a> </li> <li class=md-nav__item> <a href=#careamics.config.configuration_factories.create_hdn_configuration class=md-nav__link> <span class=md-ellipsis> create_hdn_configuration </span> </a> <nav class=md-nav aria-label=create_hdn_configuration> <ul class=md-nav__list> <li class=md-nav__item> <a href=#careamics.config.configuration_factories.create_hdn_configuration--todo-revisit-the-necessity-of-model_params class=md-nav__link> <span class=md-ellipsis> TODO revisit the necessity of model_params </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#careamics.config.configuration_factories.create_microsplit_configuration class=md-nav__link> <span class=md-ellipsis> create_microsplit_configuration </span> </a> <nav class=md-nav aria-label=create_microsplit_configuration> <ul class=md-nav__list> <li class=md-nav__item> <a href=#careamics.config.configuration_factories.create_microsplit_configuration--config-create_microsplit_configuration class=md-nav__link> <span class=md-ellipsis> &gt;&gt;&gt; config = create_microsplit_configuration( </span> </a> </li> <li class=md-nav__item> <a href=#careamics.config.configuration_factories.create_microsplit_configuration--experiment_namemicrosplit_experiment class=md-nav__link> <span class=md-ellipsis> ... experiment_name="microsplit_experiment", </span> </a> </li> <li class=md-nav__item> <a href=#careamics.config.configuration_factories.create_microsplit_configuration--data_typearray class=md-nav__link> <span class=md-ellipsis> ... data_type="array", </span> </a> </li> <li class=md-nav__item> <a href=#careamics.config.configuration_factories.create_microsplit_configuration--axesyx class=md-nav__link> <span class=md-ellipsis> ... axes="YX", </span> </a> </li> <li class=md-nav__item> <a href=#careamics.config.configuration_factories.create_microsplit_configuration--patch_size64-64 class=md-nav__link> <span class=md-ellipsis> ... patch_size=[64, 64], </span> </a> </li> <li class=md-nav__item> <a href=#careamics.config.configuration_factories.create_microsplit_configuration--batch_size32 class=md-nav__link> <span class=md-ellipsis> ... batch_size=32, </span> </a> </li> <li class=md-nav__item> <a href=#careamics.config.configuration_factories.create_microsplit_configuration--num_epochs100 class=md-nav__link> <span class=md-ellipsis> ... num_epochs=100 </span> </a> </li> <li class=md-nav__item> <a href=#careamics.config.configuration_factories.create_microsplit_configuration--_1 class=md-nav__link> <span class=md-ellipsis> ... ) </span> </a> </li> <li class=md-nav__item> <a href=#careamics.config.configuration_factories.create_microsplit_configuration--you-can-also-limit-the-number-of-batches-per-epoch class=md-nav__link> <span class=md-ellipsis> You can also limit the number of batches per epoch: </span> </a> </li> <li class=md-nav__item> <a href=#careamics.config.configuration_factories.create_microsplit_configuration--config-create_microsplit_configuration_1 class=md-nav__link> <span class=md-ellipsis> &gt;&gt;&gt; config = create_microsplit_configuration( </span> </a> </li> <li class=md-nav__item> <a href=#careamics.config.configuration_factories.create_microsplit_configuration--experiment_namemicrosplit_experiment_1 class=md-nav__link> <span class=md-ellipsis> ... experiment_name="microsplit_experiment", </span> </a> </li> <li class=md-nav__item> <a href=#careamics.config.configuration_factories.create_microsplit_configuration--data_typearray_1 class=md-nav__link> <span class=md-ellipsis> ... data_type="array", </span> </a> </li> <li class=md-nav__item> <a href=#careamics.config.configuration_factories.create_microsplit_configuration--axesyx_1 class=md-nav__link> <span class=md-ellipsis> ... axes="YX", </span> </a> </li> <li class=md-nav__item> <a href=#careamics.config.configuration_factories.create_microsplit_configuration--patch_size64-64_1 class=md-nav__link> <span class=md-ellipsis> ... patch_size=[64, 64], </span> </a> </li> <li class=md-nav__item> <a href=#careamics.config.configuration_factories.create_microsplit_configuration--batch_size32_1 class=md-nav__link> <span class=md-ellipsis> ... batch_size=32, </span> </a> </li> <li class=md-nav__item> <a href=#careamics.config.configuration_factories.create_microsplit_configuration--num_steps100-limit-to-100-batches-per-epoch class=md-nav__link> <span class=md-ellipsis> ... num_steps=100 # limit to 100 batches per epoch </span> </a> </li> <li class=md-nav__item> <a href=#careamics.config.configuration_factories.create_microsplit_configuration--_2 class=md-nav__link> <span class=md-ellipsis> ... ) </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#careamics.config.configuration_factories.create_n2n_configuration class=md-nav__link> <span class=md-ellipsis> create_n2n_configuration </span> </a> </li> <li class=md-nav__item> <a href=#careamics.config.configuration_factories.create_n2v_configuration class=md-nav__link> <span class=md-ellipsis> create_n2v_configuration </span> </a> </li> <li class=md-nav__item> <a href=#careamics.config.configuration_factories.get_likelihood_config class=md-nav__link> <span class=md-ellipsis> get_likelihood_config </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <div role=navigation aria-label="breadcrumbs navigation"> <ul class=breadcrumbs> <li> <a href=../../../..> <span class=twemoji title=Home><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M11.03 2.59a1.5 1.5 0 0 1 1.94 0l7.5 6.363a1.5 1.5 0 0 1 .53 1.144V19.5a1.5 1.5 0 0 1-1.5 1.5h-5.75a.75.75 0 0 1-.75-.75V14h-2v6.25a.75.75 0 0 1-.75.75H4.5A1.5 1.5 0 0 1 3 19.5v-9.403c0-.44.194-.859.53-1.144ZM12 3.734l-7.5 6.363V19.5h5v-6.25a.75.75 0 0 1 .75-.75h3.5a.75.75 0 0 1 .75.75v6.25h5v-9.403Z"/></svg></span> </a> </li> <li>API documentation</li><li>careamics</li><li>config</li> <li>configuration_factories</li> </ul> </div> <h1>configuration_factories</h1> <div class="doc doc-object doc-module"> <a id=careamics.config.configuration_factories></a> <div class="doc doc-contents first"> <p>Convenience functions to create configurations for training and inference.</p> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h2 id=careamics.config.configuration_factories.algorithm_factory class="doc doc-heading"> <code class="highlight language-python"><span class=n>algorithm_factory</span><span class=p>(</span><span class=n>algorithm</span><span class=p>)</span></code> <a href=#careamics.config.configuration_factories.algorithm_factory class=headerlink title="Permanent link">#</a></h2> <div class="doc doc-contents "> <p>Create an algorithm model for training CAREamics.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>algorithm</code> </td> <td> <code><span title=dict>dict</span></code> </td> <td> <div class=doc-md-description> <p>Algorithm dictionary.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-internal" title="N2VAlgorithm (careamics.config.algorithms.N2VAlgorithm)" href=../algorithms/n2v_algorithm_model/#careamics.config.algorithms.n2v_algorithm_model.N2VAlgorithm>N2VAlgorithm</a> or <a class="autorefs autorefs-internal" title="N2NAlgorithm (careamics.config.algorithms.N2NAlgorithm)" href=../algorithms/n2n_algorithm_model/#careamics.config.algorithms.n2n_algorithm_model.N2NAlgorithm>N2NAlgorithm</a> or <a class="autorefs autorefs-internal" title="CAREAlgorithm (careamics.config.algorithms.CAREAlgorithm)" href=../algorithms/care_algorithm_model/#careamics.config.algorithms.care_algorithm_model.CAREAlgorithm>CAREAlgorithm</a></code> </td> <td> <div class=doc-md-description> <p>Algorithm model for training CAREamics.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>src/careamics/config/configuration_factories.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-39>39</a></span>
<span class=normal><a href=#__codelineno-0-40>40</a></span>
<span class=normal><a href=#__codelineno-0-41>41</a></span>
<span class=normal><a href=#__codelineno-0-42>42</a></span>
<span class=normal><a href=#__codelineno-0-43>43</a></span>
<span class=normal><a href=#__codelineno-0-44>44</a></span>
<span class=normal><a href=#__codelineno-0-45>45</a></span>
<span class=normal><a href=#__codelineno-0-46>46</a></span>
<span class=normal><a href=#__codelineno-0-47>47</a></span>
<span class=normal><a href=#__codelineno-0-48>48</a></span>
<span class=normal><a href=#__codelineno-0-49>49</a></span>
<span class=normal><a href=#__codelineno-0-50>50</a></span>
<span class=normal><a href=#__codelineno-0-51>51</a></span>
<span class=normal><a href=#__codelineno-0-52>52</a></span>
<span class=normal><a href=#__codelineno-0-53>53</a></span>
<span class=normal><a href=#__codelineno-0-54>54</a></span>
<span class=normal><a href=#__codelineno-0-55>55</a></span>
<span class=normal><a href=#__codelineno-0-56>56</a></span>
<span class=normal><a href=#__codelineno-0-57>57</a></span>
<span class=normal><a href=#__codelineno-0-58>58</a></span>
<span class=normal><a href=#__codelineno-0-59>59</a></span>
<span class=normal><a href=#__codelineno-0-60>60</a></span>
<span class=normal><a href=#__codelineno-0-61>61</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a><span class=k>def</span><span class=w> </span><span class=nf>algorithm_factory</span><span class=p>(</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a>    <span class=n>algorithm</span><span class=p>:</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>],</span>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Union</span><span class=p>[</span><span class=n>N2VAlgorithm</span><span class=p>,</span> <span class=n>N2NAlgorithm</span><span class=p>,</span> <span class=n>CAREAlgorithm</span><span class=p>]:</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a><span class=sd>    Create an algorithm model for training CAREamics.</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a><span class=sd>    Parameters</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a><span class=sd>    ----------</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><span class=sd>    algorithm : dict</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><span class=sd>        Algorithm dictionary.</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><span class=sd>    Returns</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><span class=sd>    -------</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><span class=sd>    N2VAlgorithm or N2NAlgorithm or CAREAlgorithm</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><span class=sd>        Algorithm model for training CAREamics.</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a>    <span class=n>adapter</span><span class=p>:</span> <span class=n>TypeAdapter</span> <span class=o>=</span> <span class=n>TypeAdapter</span><span class=p>(</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a>        <span class=n>Annotated</span><span class=p>[</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a>            <span class=n>Union</span><span class=p>[</span><span class=n>N2VAlgorithm</span><span class=p>,</span> <span class=n>N2NAlgorithm</span><span class=p>,</span> <span class=n>CAREAlgorithm</span><span class=p>],</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a>            <span class=n>Field</span><span class=p>(</span><span class=n>discriminator</span><span class=o>=</span><span class=s2>&quot;algorithm&quot;</span><span class=p>),</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a>        <span class=p>]</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a>    <span class=p>)</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a>    <span class=k>return</span> <span class=n>adapter</span><span class=o>.</span><span class=n>validate_python</span><span class=p>(</span><span class=n>algorithm</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=careamics.config.configuration_factories.create_care_configuration class="doc doc-heading"> <code class="highlight language-python"><span class=n>create_care_configuration</span><span class=p>(</span><span class=n>experiment_name</span><span class=p>,</span> <span class=n>data_type</span><span class=p>,</span> <span class=n>axes</span><span class=p>,</span> <span class=n>patch_size</span><span class=p>,</span> <span class=n>batch_size</span><span class=p>,</span> <span class=n>num_epochs</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>num_steps</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>augmentations</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>independent_channels</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>loss</span><span class=o>=</span><span class=s1>&#39;mae&#39;</span><span class=p>,</span> <span class=n>n_channels_in</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>n_channels_out</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=s1>&#39;none&#39;</span><span class=p>,</span> <span class=n>trainer_params</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>model_params</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>optimizer</span><span class=o>=</span><span class=s1>&#39;Adam&#39;</span><span class=p>,</span> <span class=n>optimizer_params</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>lr_scheduler</span><span class=o>=</span><span class=s1>&#39;ReduceLROnPlateau&#39;</span><span class=p>,</span> <span class=n>lr_scheduler_params</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>train_dataloader_params</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>val_dataloader_params</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>checkpoint_params</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#careamics.config.configuration_factories.create_care_configuration class=headerlink title="Permanent link">#</a></h2> <div class="doc doc-contents "> <p>Create a configuration for training CARE.</p> <p>If "Z" is present in <code>axes</code>, then <code>path_size</code> must be a list of length 3, otherwise 2.</p> <p>If "C" is present in <code>axes</code>, then you need to set <code>n_channels_in</code> to the number of channels. Likewise, if you set the number of channels, then "C" must be present in <code>axes</code>.</p> <p>To set the number of output channels, use the <code>n_channels_out</code> parameter. If it is not specified, it will be assumed to be equal to <code>n_channels_in</code>.</p> <p>By default, all channels are trained together. To train all channels independently, set <code>independent_channels</code> to True.</p> <p>By setting <code>augmentations</code> to <code>None</code>, the default transformations (flip in X and Y, rotations by 90 degrees in the XY plane) are applied. Rather than the default transforms, a list of transforms can be passed to the <code>augmentations</code> parameter. To disable the transforms, simply pass an empty list.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>experiment_name</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>Name of the experiment.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>data_type</code> </td> <td> <code><span title=typing.Literal>Literal</span>[&#39;array&#39;, &#39;tiff&#39;, &#39;czi&#39;, &#39;custom&#39;]</code> </td> <td> <div class=doc-md-description> <p>Type of the data.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>axes</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>Axes of the data (e.g. SYX).</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>patch_size</code> </td> <td> <code><span title=List>List</span>[<span title=int>int</span>]</code> </td> <td> <div class=doc-md-description> <p>Size of the patches along the spatial dimensions (e.g. [64, 64]).</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>batch_size</code> </td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>Batch size.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>num_epochs</code> </td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>Number of epochs to train for. If provided, this will be added to trainer_params.</p> </div> </td> <td> <code>100</code> </td> </tr> <tr class=doc-section-item> <td> <code>num_steps</code> </td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>Number of batches in 1 epoch. If provided, this will be added to trainer_params. Translates to <code>limit_train_batches</code> in PyTorch Lightning Trainer. See relevant documentation for more details.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>augmentations</code> </td> <td> <code>list of transforms</code> </td> <td> <div class=doc-md-description> <p>List of transforms to apply, either both or one of XYFlipModel and XYRandomRotate90Model. By default, it applies both XYFlip (on X and Y) and XYRandomRotate90 (in XY) to the images.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>independent_channels</code> </td> <td> <code><span title=bool>bool</span></code> </td> <td> <div class=doc-md-description> <p>Whether to train all channels independently, by default False.</p> </div> </td> <td> <code>True</code> </td> </tr> <tr class=doc-section-item> <td> <code>loss</code> </td> <td> <code><span title=typing.Literal>Literal</span>[&#39;mae&#39;, &#39;mse&#39;]</code> </td> <td> <div class=doc-md-description> <p>Loss function to use.</p> </div> </td> <td> <code>&#34;mae&#34;</code> </td> </tr> <tr class=doc-section-item> <td> <code>n_channels_in</code> </td> <td> <code><span title=int>int</span> or None</code> </td> <td> <div class=doc-md-description> <p>Number of channels in.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>n_channels_out</code> </td> <td> <code><span title=int>int</span> or None</code> </td> <td> <div class=doc-md-description> <p>Number of channels out.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>logger</code> </td> <td> <code><span title=typing.Literal>Literal</span>[&#39;wandb&#39;, &#39;tensorboard&#39;, &#39;none&#39;]</code> </td> <td> <div class=doc-md-description> <p>Logger to use.</p> </div> </td> <td> <code>&#34;none&#34;</code> </td> </tr> <tr class=doc-section-item> <td> <code>trainer_params</code> </td> <td> <code><span title=dict>dict</span></code> </td> <td> <div class=doc-md-description> <p>Parameters for the trainer class, see PyTorch Lightning documentation.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>model_params</code> </td> <td> <code><span title=dict>dict</span></code> </td> <td> <div class=doc-md-description> <p>UNetModel parameters.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>optimizer</code> </td> <td> <code><span title=typing.Literal>Literal</span>[&#39;Adam&#39;, &#39;Adamax&#39;, &#39;SGD&#39;]</code> </td> <td> <div class=doc-md-description> <p>Optimizer to use.</p> </div> </td> <td> <code>&#34;Adam&#34;</code> </td> </tr> <tr class=doc-section-item> <td> <code>optimizer_params</code> </td> <td> <code><span title=dict>dict</span></code> </td> <td> <div class=doc-md-description> <p>Parameters for the optimizer, see PyTorch documentation for more details.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>lr_scheduler</code> </td> <td> <code><span title=typing.Literal>Literal</span>[&#39;ReduceLROnPlateau&#39;, &#39;StepLR&#39;]</code> </td> <td> <div class=doc-md-description> <p>Learning rate scheduler to use.</p> </div> </td> <td> <code>&#34;ReduceLROnPlateau&#34;</code> </td> </tr> <tr class=doc-section-item> <td> <code>lr_scheduler_params</code> </td> <td> <code><span title=dict>dict</span></code> </td> <td> <div class=doc-md-description> <p>Parameters for the learning rate scheduler, see PyTorch documentation for more details.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>train_dataloader_params</code> </td> <td> <code><span title=dict>dict</span></code> </td> <td> <div class=doc-md-description> <p>Parameters for the training dataloader, see the PyTorch docs for <code>DataLoader</code>. If left as <code>None</code>, the dict <code>{"shuffle": True}</code> will be used, this is set in the <code>GeneralDataConfig</code>.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>val_dataloader_params</code> </td> <td> <code><span title=dict>dict</span></code> </td> <td> <div class=doc-md-description> <p>Parameters for the validation dataloader, see PyTorch the docs for <code>DataLoader</code>. If left as <code>None</code>, the empty dict <code>{}</code> will be used, this is set in the <code>GeneralDataConfig</code>.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>checkpoint_params</code> </td> <td> <code><span title=dict>dict</span></code> </td> <td> <div class=doc-md-description> <p>Parameters for the checkpoint callback, see PyTorch Lightning documentation (<code>ModelCheckpoint</code>) for the list of available parameters.</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-internal" title="Configuration (careamics.config.configuration.Configuration)" href=../configuration/#careamics.config.configuration.Configuration>Configuration</a></code> </td> <td> <div class=doc-md-description> <p>Configuration for training CARE.</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Examples:</span></p> <p>Minimum example:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>config</span> <span class=o>=</span> <span class=n>create_care_configuration</span><span class=p>(</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=gp>... </span>    <span class=n>experiment_name</span><span class=o>=</span><span class=s2>&quot;care_experiment&quot;</span><span class=p>,</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=gp>... </span>    <span class=n>data_type</span><span class=o>=</span><span class=s2>&quot;array&quot;</span><span class=p>,</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=gp>... </span>    <span class=n>axes</span><span class=o>=</span><span class=s2>&quot;YX&quot;</span><span class=p>,</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=gp>... </span>    <span class=n>patch_size</span><span class=o>=</span><span class=p>[</span><span class=mi>64</span><span class=p>,</span> <span class=mi>64</span><span class=p>],</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=gp>... </span>    <span class=n>batch_size</span><span class=o>=</span><span class=mi>32</span><span class=p>,</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=gp>... </span>    <span class=n>num_epochs</span><span class=o>=</span><span class=mi>100</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a><span class=gp>... </span><span class=p>)</span>
</span></code></pre></div> <p>You can also limit the number of batches per epoch:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>config</span> <span class=o>=</span> <span class=n>create_care_configuration</span><span class=p>(</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=gp>... </span>    <span class=n>experiment_name</span><span class=o>=</span><span class=s2>&quot;care_experiment&quot;</span><span class=p>,</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=gp>... </span>    <span class=n>data_type</span><span class=o>=</span><span class=s2>&quot;array&quot;</span><span class=p>,</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=gp>... </span>    <span class=n>axes</span><span class=o>=</span><span class=s2>&quot;YX&quot;</span><span class=p>,</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=gp>... </span>    <span class=n>patch_size</span><span class=o>=</span><span class=p>[</span><span class=mi>64</span><span class=p>,</span> <span class=mi>64</span><span class=p>],</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=gp>... </span>    <span class=n>batch_size</span><span class=o>=</span><span class=mi>32</span><span class=p>,</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=gp>... </span>    <span class=n>num_steps</span><span class=o>=</span><span class=mi>100</span>  <span class=c1># limit to 100 batches per epoch</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a><span class=gp>... </span><span class=p>)</span>
</span></code></pre></div> <p>To disable transforms, simply set <code>augmentations</code> to an empty list:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>config</span> <span class=o>=</span> <span class=n>create_care_configuration</span><span class=p>(</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=gp>... </span>    <span class=n>experiment_name</span><span class=o>=</span><span class=s2>&quot;care_experiment&quot;</span><span class=p>,</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=gp>... </span>    <span class=n>data_type</span><span class=o>=</span><span class=s2>&quot;array&quot;</span><span class=p>,</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=gp>... </span>    <span class=n>axes</span><span class=o>=</span><span class=s2>&quot;YX&quot;</span><span class=p>,</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=gp>... </span>    <span class=n>patch_size</span><span class=o>=</span><span class=p>[</span><span class=mi>64</span><span class=p>,</span> <span class=mi>64</span><span class=p>],</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=gp>... </span>    <span class=n>batch_size</span><span class=o>=</span><span class=mi>32</span><span class=p>,</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=gp>... </span>    <span class=n>num_epochs</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a><span class=gp>... </span>    <span class=n>augmentations</span><span class=o>=</span><span class=p>[]</span>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a><span class=gp>... </span><span class=p>)</span>
</span></code></pre></div> <p>A list of transforms can be passed to the <code>augmentations</code> parameter to replace the default augmentations:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span><span class=w> </span><span class=nn>careamics.config.transformations</span><span class=w> </span><span class=kn>import</span> <span class=n>XYFlipModel</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=gp>&gt;&gt;&gt; </span><span class=n>config</span> <span class=o>=</span> <span class=n>create_care_configuration</span><span class=p>(</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=gp>... </span>    <span class=n>experiment_name</span><span class=o>=</span><span class=s2>&quot;care_experiment&quot;</span><span class=p>,</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=gp>... </span>    <span class=n>data_type</span><span class=o>=</span><span class=s2>&quot;array&quot;</span><span class=p>,</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=gp>... </span>    <span class=n>axes</span><span class=o>=</span><span class=s2>&quot;YX&quot;</span><span class=p>,</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=gp>... </span>    <span class=n>patch_size</span><span class=o>=</span><span class=p>[</span><span class=mi>64</span><span class=p>,</span> <span class=mi>64</span><span class=p>],</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=gp>... </span>    <span class=n>batch_size</span><span class=o>=</span><span class=mi>32</span><span class=p>,</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a><span class=gp>... </span>    <span class=n>num_epochs</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a><span class=gp>... </span>    <span class=n>augmentations</span><span class=o>=</span><span class=p>[</span>
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a><span class=gp>... </span>        <span class=c1># No rotation and only Y flipping</span>
</span><span id=__span-0-11><a id=__codelineno-0-11 name=__codelineno-0-11 href=#__codelineno-0-11></a><span class=gp>... </span>        <span class=n>XYFlipModel</span><span class=p>(</span><span class=n>flip_x</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span> <span class=n>flip_y</span> <span class=o>=</span> <span class=kc>True</span><span class=p>)</span>
</span><span id=__span-0-12><a id=__codelineno-0-12 name=__codelineno-0-12 href=#__codelineno-0-12></a><span class=gp>... </span>    <span class=p>]</span>
</span><span id=__span-0-13><a id=__codelineno-0-13 name=__codelineno-0-13 href=#__codelineno-0-13></a><span class=gp>... </span><span class=p>)</span>
</span></code></pre></div> <p>If you are training multiple channels they will be trained independently by default, you simply need to specify the number of channels input (and optionally, the number of channels output):</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>config</span> <span class=o>=</span> <span class=n>create_care_configuration</span><span class=p>(</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=gp>... </span>    <span class=n>experiment_name</span><span class=o>=</span><span class=s2>&quot;care_experiment&quot;</span><span class=p>,</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=gp>... </span>    <span class=n>data_type</span><span class=o>=</span><span class=s2>&quot;array&quot;</span><span class=p>,</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=gp>... </span>    <span class=n>axes</span><span class=o>=</span><span class=s2>&quot;YXC&quot;</span><span class=p>,</span> <span class=c1># channels must be in the axes</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=gp>... </span>    <span class=n>patch_size</span><span class=o>=</span><span class=p>[</span><span class=mi>64</span><span class=p>,</span> <span class=mi>64</span><span class=p>],</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=gp>... </span>    <span class=n>batch_size</span><span class=o>=</span><span class=mi>32</span><span class=p>,</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=gp>... </span>    <span class=n>num_epochs</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a><span class=gp>... </span>    <span class=n>n_channels_in</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span> <span class=c1># number of input channels</span>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a><span class=gp>... </span>    <span class=n>n_channels_out</span><span class=o>=</span><span class=mi>1</span> <span class=c1># if applicable</span>
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a><span class=gp>... </span><span class=p>)</span>
</span></code></pre></div> <p>If instead you want to train multiple channels together, you need to turn off the <code>independent_channels</code> parameter:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>config</span> <span class=o>=</span> <span class=n>create_care_configuration</span><span class=p>(</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=gp>... </span>    <span class=n>experiment_name</span><span class=o>=</span><span class=s2>&quot;care_experiment&quot;</span><span class=p>,</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=gp>... </span>    <span class=n>data_type</span><span class=o>=</span><span class=s2>&quot;array&quot;</span><span class=p>,</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=gp>... </span>    <span class=n>axes</span><span class=o>=</span><span class=s2>&quot;YXC&quot;</span><span class=p>,</span> <span class=c1># channels must be in the axes</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=gp>... </span>    <span class=n>patch_size</span><span class=o>=</span><span class=p>[</span><span class=mi>64</span><span class=p>,</span> <span class=mi>64</span><span class=p>],</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=gp>... </span>    <span class=n>batch_size</span><span class=o>=</span><span class=mi>32</span><span class=p>,</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=gp>... </span>    <span class=n>num_epochs</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a><span class=gp>... </span>    <span class=n>independent_channels</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a><span class=gp>... </span>    <span class=n>n_channels_in</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span>
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a><span class=gp>... </span>    <span class=n>n_channels_out</span><span class=o>=</span><span class=mi>1</span> <span class=c1># if applicable</span>
</span><span id=__span-0-11><a id=__codelineno-0-11 name=__codelineno-0-11 href=#__codelineno-0-11></a><span class=gp>... </span><span class=p>)</span>
</span></code></pre></div> <p>If you would like to train on CZI files, use <code>"czi"</code> as <code>data_type</code> and <code>"SCYX"</code> as <code>axes</code> for 2-D or <code>"SCZYX"</code> for 3-D denoising. Note that <code>"SCYX"</code> can also be used for 3-D data but spatial context along the Z dimension will then not be taken into account.</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>config_2d</span> <span class=o>=</span> <span class=n>create_care_configuration</span><span class=p>(</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=gp>... </span>    <span class=n>experiment_name</span><span class=o>=</span><span class=s2>&quot;care_experiment&quot;</span><span class=p>,</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=gp>... </span>    <span class=n>data_type</span><span class=o>=</span><span class=s2>&quot;czi&quot;</span><span class=p>,</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=gp>... </span>    <span class=n>axes</span><span class=o>=</span><span class=s2>&quot;SCYX&quot;</span><span class=p>,</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=gp>... </span>    <span class=n>patch_size</span><span class=o>=</span><span class=p>[</span><span class=mi>64</span><span class=p>,</span> <span class=mi>64</span><span class=p>],</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=gp>... </span>    <span class=n>batch_size</span><span class=o>=</span><span class=mi>32</span><span class=p>,</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=gp>... </span>    <span class=n>num_epochs</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a><span class=gp>... </span>    <span class=n>n_channels_in</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a><span class=gp>&gt;&gt;&gt; </span><span class=n>config_3d</span> <span class=o>=</span> <span class=n>create_care_configuration</span><span class=p>(</span>
</span><span id=__span-0-11><a id=__codelineno-0-11 name=__codelineno-0-11 href=#__codelineno-0-11></a><span class=gp>... </span>    <span class=n>experiment_name</span><span class=o>=</span><span class=s2>&quot;care_experiment&quot;</span><span class=p>,</span>
</span><span id=__span-0-12><a id=__codelineno-0-12 name=__codelineno-0-12 href=#__codelineno-0-12></a><span class=gp>... </span>    <span class=n>data_type</span><span class=o>=</span><span class=s2>&quot;czi&quot;</span><span class=p>,</span>
</span><span id=__span-0-13><a id=__codelineno-0-13 name=__codelineno-0-13 href=#__codelineno-0-13></a><span class=gp>... </span>    <span class=n>axes</span><span class=o>=</span><span class=s2>&quot;SCZYX&quot;</span><span class=p>,</span>
</span><span id=__span-0-14><a id=__codelineno-0-14 name=__codelineno-0-14 href=#__codelineno-0-14></a><span class=gp>... </span>    <span class=n>patch_size</span><span class=o>=</span><span class=p>[</span><span class=mi>16</span><span class=p>,</span> <span class=mi>64</span><span class=p>,</span> <span class=mi>64</span><span class=p>],</span>
</span><span id=__span-0-15><a id=__codelineno-0-15 name=__codelineno-0-15 href=#__codelineno-0-15></a><span class=gp>... </span>    <span class=n>batch_size</span><span class=o>=</span><span class=mi>16</span><span class=p>,</span>
</span><span id=__span-0-16><a id=__codelineno-0-16 name=__codelineno-0-16 href=#__codelineno-0-16></a><span class=gp>... </span>    <span class=n>num_epochs</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span>
</span><span id=__span-0-17><a id=__codelineno-0-17 name=__codelineno-0-17 href=#__codelineno-0-17></a><span class=gp>... </span>    <span class=n>n_channels_in</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
</span><span id=__span-0-18><a id=__codelineno-0-18 name=__codelineno-0-18 href=#__codelineno-0-18></a><span class=gp>... </span><span class=p>)</span>
</span></code></pre></div> <details class=quote> <summary>Source code in <code>src/careamics/config/configuration_factories.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-630>630</a></span>
<span class=normal><a href=#__codelineno-0-631>631</a></span>
<span class=normal><a href=#__codelineno-0-632>632</a></span>
<span class=normal><a href=#__codelineno-0-633>633</a></span>
<span class=normal><a href=#__codelineno-0-634>634</a></span>
<span class=normal><a href=#__codelineno-0-635>635</a></span>
<span class=normal><a href=#__codelineno-0-636>636</a></span>
<span class=normal><a href=#__codelineno-0-637>637</a></span>
<span class=normal><a href=#__codelineno-0-638>638</a></span>
<span class=normal><a href=#__codelineno-0-639>639</a></span>
<span class=normal><a href=#__codelineno-0-640>640</a></span>
<span class=normal><a href=#__codelineno-0-641>641</a></span>
<span class=normal><a href=#__codelineno-0-642>642</a></span>
<span class=normal><a href=#__codelineno-0-643>643</a></span>
<span class=normal><a href=#__codelineno-0-644>644</a></span>
<span class=normal><a href=#__codelineno-0-645>645</a></span>
<span class=normal><a href=#__codelineno-0-646>646</a></span>
<span class=normal><a href=#__codelineno-0-647>647</a></span>
<span class=normal><a href=#__codelineno-0-648>648</a></span>
<span class=normal><a href=#__codelineno-0-649>649</a></span>
<span class=normal><a href=#__codelineno-0-650>650</a></span>
<span class=normal><a href=#__codelineno-0-651>651</a></span>
<span class=normal><a href=#__codelineno-0-652>652</a></span>
<span class=normal><a href=#__codelineno-0-653>653</a></span>
<span class=normal><a href=#__codelineno-0-654>654</a></span>
<span class=normal><a href=#__codelineno-0-655>655</a></span>
<span class=normal><a href=#__codelineno-0-656>656</a></span>
<span class=normal><a href=#__codelineno-0-657>657</a></span>
<span class=normal><a href=#__codelineno-0-658>658</a></span>
<span class=normal><a href=#__codelineno-0-659>659</a></span>
<span class=normal><a href=#__codelineno-0-660>660</a></span>
<span class=normal><a href=#__codelineno-0-661>661</a></span>
<span class=normal><a href=#__codelineno-0-662>662</a></span>
<span class=normal><a href=#__codelineno-0-663>663</a></span>
<span class=normal><a href=#__codelineno-0-664>664</a></span>
<span class=normal><a href=#__codelineno-0-665>665</a></span>
<span class=normal><a href=#__codelineno-0-666>666</a></span>
<span class=normal><a href=#__codelineno-0-667>667</a></span>
<span class=normal><a href=#__codelineno-0-668>668</a></span>
<span class=normal><a href=#__codelineno-0-669>669</a></span>
<span class=normal><a href=#__codelineno-0-670>670</a></span>
<span class=normal><a href=#__codelineno-0-671>671</a></span>
<span class=normal><a href=#__codelineno-0-672>672</a></span>
<span class=normal><a href=#__codelineno-0-673>673</a></span>
<span class=normal><a href=#__codelineno-0-674>674</a></span>
<span class=normal><a href=#__codelineno-0-675>675</a></span>
<span class=normal><a href=#__codelineno-0-676>676</a></span>
<span class=normal><a href=#__codelineno-0-677>677</a></span>
<span class=normal><a href=#__codelineno-0-678>678</a></span>
<span class=normal><a href=#__codelineno-0-679>679</a></span>
<span class=normal><a href=#__codelineno-0-680>680</a></span>
<span class=normal><a href=#__codelineno-0-681>681</a></span>
<span class=normal><a href=#__codelineno-0-682>682</a></span>
<span class=normal><a href=#__codelineno-0-683>683</a></span>
<span class=normal><a href=#__codelineno-0-684>684</a></span>
<span class=normal><a href=#__codelineno-0-685>685</a></span>
<span class=normal><a href=#__codelineno-0-686>686</a></span>
<span class=normal><a href=#__codelineno-0-687>687</a></span>
<span class=normal><a href=#__codelineno-0-688>688</a></span>
<span class=normal><a href=#__codelineno-0-689>689</a></span>
<span class=normal><a href=#__codelineno-0-690>690</a></span>
<span class=normal><a href=#__codelineno-0-691>691</a></span>
<span class=normal><a href=#__codelineno-0-692>692</a></span>
<span class=normal><a href=#__codelineno-0-693>693</a></span>
<span class=normal><a href=#__codelineno-0-694>694</a></span>
<span class=normal><a href=#__codelineno-0-695>695</a></span>
<span class=normal><a href=#__codelineno-0-696>696</a></span>
<span class=normal><a href=#__codelineno-0-697>697</a></span>
<span class=normal><a href=#__codelineno-0-698>698</a></span>
<span class=normal><a href=#__codelineno-0-699>699</a></span>
<span class=normal><a href=#__codelineno-0-700>700</a></span>
<span class=normal><a href=#__codelineno-0-701>701</a></span>
<span class=normal><a href=#__codelineno-0-702>702</a></span>
<span class=normal><a href=#__codelineno-0-703>703</a></span>
<span class=normal><a href=#__codelineno-0-704>704</a></span>
<span class=normal><a href=#__codelineno-0-705>705</a></span>
<span class=normal><a href=#__codelineno-0-706>706</a></span>
<span class=normal><a href=#__codelineno-0-707>707</a></span>
<span class=normal><a href=#__codelineno-0-708>708</a></span>
<span class=normal><a href=#__codelineno-0-709>709</a></span>
<span class=normal><a href=#__codelineno-0-710>710</a></span>
<span class=normal><a href=#__codelineno-0-711>711</a></span>
<span class=normal><a href=#__codelineno-0-712>712</a></span>
<span class=normal><a href=#__codelineno-0-713>713</a></span>
<span class=normal><a href=#__codelineno-0-714>714</a></span>
<span class=normal><a href=#__codelineno-0-715>715</a></span>
<span class=normal><a href=#__codelineno-0-716>716</a></span>
<span class=normal><a href=#__codelineno-0-717>717</a></span>
<span class=normal><a href=#__codelineno-0-718>718</a></span>
<span class=normal><a href=#__codelineno-0-719>719</a></span>
<span class=normal><a href=#__codelineno-0-720>720</a></span>
<span class=normal><a href=#__codelineno-0-721>721</a></span>
<span class=normal><a href=#__codelineno-0-722>722</a></span>
<span class=normal><a href=#__codelineno-0-723>723</a></span>
<span class=normal><a href=#__codelineno-0-724>724</a></span>
<span class=normal><a href=#__codelineno-0-725>725</a></span>
<span class=normal><a href=#__codelineno-0-726>726</a></span>
<span class=normal><a href=#__codelineno-0-727>727</a></span>
<span class=normal><a href=#__codelineno-0-728>728</a></span>
<span class=normal><a href=#__codelineno-0-729>729</a></span>
<span class=normal><a href=#__codelineno-0-730>730</a></span>
<span class=normal><a href=#__codelineno-0-731>731</a></span>
<span class=normal><a href=#__codelineno-0-732>732</a></span>
<span class=normal><a href=#__codelineno-0-733>733</a></span>
<span class=normal><a href=#__codelineno-0-734>734</a></span>
<span class=normal><a href=#__codelineno-0-735>735</a></span>
<span class=normal><a href=#__codelineno-0-736>736</a></span>
<span class=normal><a href=#__codelineno-0-737>737</a></span>
<span class=normal><a href=#__codelineno-0-738>738</a></span>
<span class=normal><a href=#__codelineno-0-739>739</a></span>
<span class=normal><a href=#__codelineno-0-740>740</a></span>
<span class=normal><a href=#__codelineno-0-741>741</a></span>
<span class=normal><a href=#__codelineno-0-742>742</a></span>
<span class=normal><a href=#__codelineno-0-743>743</a></span>
<span class=normal><a href=#__codelineno-0-744>744</a></span>
<span class=normal><a href=#__codelineno-0-745>745</a></span>
<span class=normal><a href=#__codelineno-0-746>746</a></span>
<span class=normal><a href=#__codelineno-0-747>747</a></span>
<span class=normal><a href=#__codelineno-0-748>748</a></span>
<span class=normal><a href=#__codelineno-0-749>749</a></span>
<span class=normal><a href=#__codelineno-0-750>750</a></span>
<span class=normal><a href=#__codelineno-0-751>751</a></span>
<span class=normal><a href=#__codelineno-0-752>752</a></span>
<span class=normal><a href=#__codelineno-0-753>753</a></span>
<span class=normal><a href=#__codelineno-0-754>754</a></span>
<span class=normal><a href=#__codelineno-0-755>755</a></span>
<span class=normal><a href=#__codelineno-0-756>756</a></span>
<span class=normal><a href=#__codelineno-0-757>757</a></span>
<span class=normal><a href=#__codelineno-0-758>758</a></span>
<span class=normal><a href=#__codelineno-0-759>759</a></span>
<span class=normal><a href=#__codelineno-0-760>760</a></span>
<span class=normal><a href=#__codelineno-0-761>761</a></span>
<span class=normal><a href=#__codelineno-0-762>762</a></span>
<span class=normal><a href=#__codelineno-0-763>763</a></span>
<span class=normal><a href=#__codelineno-0-764>764</a></span>
<span class=normal><a href=#__codelineno-0-765>765</a></span>
<span class=normal><a href=#__codelineno-0-766>766</a></span>
<span class=normal><a href=#__codelineno-0-767>767</a></span>
<span class=normal><a href=#__codelineno-0-768>768</a></span>
<span class=normal><a href=#__codelineno-0-769>769</a></span>
<span class=normal><a href=#__codelineno-0-770>770</a></span>
<span class=normal><a href=#__codelineno-0-771>771</a></span>
<span class=normal><a href=#__codelineno-0-772>772</a></span>
<span class=normal><a href=#__codelineno-0-773>773</a></span>
<span class=normal><a href=#__codelineno-0-774>774</a></span>
<span class=normal><a href=#__codelineno-0-775>775</a></span>
<span class=normal><a href=#__codelineno-0-776>776</a></span>
<span class=normal><a href=#__codelineno-0-777>777</a></span>
<span class=normal><a href=#__codelineno-0-778>778</a></span>
<span class=normal><a href=#__codelineno-0-779>779</a></span>
<span class=normal><a href=#__codelineno-0-780>780</a></span>
<span class=normal><a href=#__codelineno-0-781>781</a></span>
<span class=normal><a href=#__codelineno-0-782>782</a></span>
<span class=normal><a href=#__codelineno-0-783>783</a></span>
<span class=normal><a href=#__codelineno-0-784>784</a></span>
<span class=normal><a href=#__codelineno-0-785>785</a></span>
<span class=normal><a href=#__codelineno-0-786>786</a></span>
<span class=normal><a href=#__codelineno-0-787>787</a></span>
<span class=normal><a href=#__codelineno-0-788>788</a></span>
<span class=normal><a href=#__codelineno-0-789>789</a></span>
<span class=normal><a href=#__codelineno-0-790>790</a></span>
<span class=normal><a href=#__codelineno-0-791>791</a></span>
<span class=normal><a href=#__codelineno-0-792>792</a></span>
<span class=normal><a href=#__codelineno-0-793>793</a></span>
<span class=normal><a href=#__codelineno-0-794>794</a></span>
<span class=normal><a href=#__codelineno-0-795>795</a></span>
<span class=normal><a href=#__codelineno-0-796>796</a></span>
<span class=normal><a href=#__codelineno-0-797>797</a></span>
<span class=normal><a href=#__codelineno-0-798>798</a></span>
<span class=normal><a href=#__codelineno-0-799>799</a></span>
<span class=normal><a href=#__codelineno-0-800>800</a></span>
<span class=normal><a href=#__codelineno-0-801>801</a></span>
<span class=normal><a href=#__codelineno-0-802>802</a></span>
<span class=normal><a href=#__codelineno-0-803>803</a></span>
<span class=normal><a href=#__codelineno-0-804>804</a></span>
<span class=normal><a href=#__codelineno-0-805>805</a></span>
<span class=normal><a href=#__codelineno-0-806>806</a></span>
<span class=normal><a href=#__codelineno-0-807>807</a></span>
<span class=normal><a href=#__codelineno-0-808>808</a></span>
<span class=normal><a href=#__codelineno-0-809>809</a></span>
<span class=normal><a href=#__codelineno-0-810>810</a></span>
<span class=normal><a href=#__codelineno-0-811>811</a></span>
<span class=normal><a href=#__codelineno-0-812>812</a></span>
<span class=normal><a href=#__codelineno-0-813>813</a></span>
<span class=normal><a href=#__codelineno-0-814>814</a></span>
<span class=normal><a href=#__codelineno-0-815>815</a></span>
<span class=normal><a href=#__codelineno-0-816>816</a></span>
<span class=normal><a href=#__codelineno-0-817>817</a></span>
<span class=normal><a href=#__codelineno-0-818>818</a></span>
<span class=normal><a href=#__codelineno-0-819>819</a></span>
<span class=normal><a href=#__codelineno-0-820>820</a></span>
<span class=normal><a href=#__codelineno-0-821>821</a></span>
<span class=normal><a href=#__codelineno-0-822>822</a></span>
<span class=normal><a href=#__codelineno-0-823>823</a></span>
<span class=normal><a href=#__codelineno-0-824>824</a></span>
<span class=normal><a href=#__codelineno-0-825>825</a></span>
<span class=normal><a href=#__codelineno-0-826>826</a></span>
<span class=normal><a href=#__codelineno-0-827>827</a></span>
<span class=normal><a href=#__codelineno-0-828>828</a></span>
<span class=normal><a href=#__codelineno-0-829>829</a></span>
<span class=normal><a href=#__codelineno-0-830>830</a></span>
<span class=normal><a href=#__codelineno-0-831>831</a></span>
<span class=normal><a href=#__codelineno-0-832>832</a></span>
<span class=normal><a href=#__codelineno-0-833>833</a></span>
<span class=normal><a href=#__codelineno-0-834>834</a></span>
<span class=normal><a href=#__codelineno-0-835>835</a></span>
<span class=normal><a href=#__codelineno-0-836>836</a></span>
<span class=normal><a href=#__codelineno-0-837>837</a></span>
<span class=normal><a href=#__codelineno-0-838>838</a></span>
<span class=normal><a href=#__codelineno-0-839>839</a></span>
<span class=normal><a href=#__codelineno-0-840>840</a></span>
<span class=normal><a href=#__codelineno-0-841>841</a></span>
<span class=normal><a href=#__codelineno-0-842>842</a></span>
<span class=normal><a href=#__codelineno-0-843>843</a></span>
<span class=normal><a href=#__codelineno-0-844>844</a></span>
<span class=normal><a href=#__codelineno-0-845>845</a></span>
<span class=normal><a href=#__codelineno-0-846>846</a></span>
<span class=normal><a href=#__codelineno-0-847>847</a></span>
<span class=normal><a href=#__codelineno-0-848>848</a></span>
<span class=normal><a href=#__codelineno-0-849>849</a></span>
<span class=normal><a href=#__codelineno-0-850>850</a></span>
<span class=normal><a href=#__codelineno-0-851>851</a></span>
<span class=normal><a href=#__codelineno-0-852>852</a></span>
<span class=normal><a href=#__codelineno-0-853>853</a></span>
<span class=normal><a href=#__codelineno-0-854>854</a></span>
<span class=normal><a href=#__codelineno-0-855>855</a></span>
<span class=normal><a href=#__codelineno-0-856>856</a></span>
<span class=normal><a href=#__codelineno-0-857>857</a></span>
<span class=normal><a href=#__codelineno-0-858>858</a></span>
<span class=normal><a href=#__codelineno-0-859>859</a></span>
<span class=normal><a href=#__codelineno-0-860>860</a></span>
<span class=normal><a href=#__codelineno-0-861>861</a></span>
<span class=normal><a href=#__codelineno-0-862>862</a></span>
<span class=normal><a href=#__codelineno-0-863>863</a></span>
<span class=normal><a href=#__codelineno-0-864>864</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-630><a id=__codelineno-0-630 name=__codelineno-0-630></a><span class=k>def</span><span class=w> </span><span class=nf>create_care_configuration</span><span class=p>(</span>
</span><span id=__span-0-631><a id=__codelineno-0-631 name=__codelineno-0-631></a>    <span class=n>experiment_name</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span><span id=__span-0-632><a id=__codelineno-0-632 name=__codelineno-0-632></a>    <span class=n>data_type</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span><span class=s2>&quot;array&quot;</span><span class=p>,</span> <span class=s2>&quot;tiff&quot;</span><span class=p>,</span> <span class=s2>&quot;czi&quot;</span><span class=p>,</span> <span class=s2>&quot;custom&quot;</span><span class=p>],</span>
</span><span id=__span-0-633><a id=__codelineno-0-633 name=__codelineno-0-633></a>    <span class=n>axes</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span><span id=__span-0-634><a id=__codelineno-0-634 name=__codelineno-0-634></a>    <span class=n>patch_size</span><span class=p>:</span> <span class=n>Sequence</span><span class=p>[</span><span class=nb>int</span><span class=p>],</span>
</span><span id=__span-0-635><a id=__codelineno-0-635 name=__codelineno-0-635></a>    <span class=n>batch_size</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-636><a id=__codelineno-0-636 name=__codelineno-0-636></a>    <span class=n>num_epochs</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>100</span><span class=p>,</span>
</span><span id=__span-0-637><a id=__codelineno-0-637 name=__codelineno-0-637></a>    <span class=n>num_steps</span><span class=p>:</span> <span class=nb>int</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-638><a id=__codelineno-0-638 name=__codelineno-0-638></a>    <span class=n>augmentations</span><span class=p>:</span> <span class=nb>list</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=n>XYFlipModel</span><span class=p>,</span> <span class=n>XYRandomRotate90Model</span><span class=p>]]</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-639><a id=__codelineno-0-639 name=__codelineno-0-639></a>    <span class=n>independent_channels</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
</span><span id=__span-0-640><a id=__codelineno-0-640 name=__codelineno-0-640></a>    <span class=n>loss</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span><span class=s2>&quot;mae&quot;</span><span class=p>,</span> <span class=s2>&quot;mse&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=s2>&quot;mae&quot;</span><span class=p>,</span>
</span><span id=__span-0-641><a id=__codelineno-0-641 name=__codelineno-0-641></a>    <span class=n>n_channels_in</span><span class=p>:</span> <span class=nb>int</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-642><a id=__codelineno-0-642 name=__codelineno-0-642></a>    <span class=n>n_channels_out</span><span class=p>:</span> <span class=nb>int</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-643><a id=__codelineno-0-643 name=__codelineno-0-643></a>    <span class=n>logger</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span><span class=s2>&quot;wandb&quot;</span><span class=p>,</span> <span class=s2>&quot;tensorboard&quot;</span><span class=p>,</span> <span class=s2>&quot;none&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=s2>&quot;none&quot;</span><span class=p>,</span>
</span><span id=__span-0-644><a id=__codelineno-0-644 name=__codelineno-0-644></a>    <span class=n>trainer_params</span><span class=p>:</span> <span class=nb>dict</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-645><a id=__codelineno-0-645 name=__codelineno-0-645></a>    <span class=n>model_params</span><span class=p>:</span> <span class=nb>dict</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-646><a id=__codelineno-0-646 name=__codelineno-0-646></a>    <span class=n>optimizer</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span><span class=s2>&quot;Adam&quot;</span><span class=p>,</span> <span class=s2>&quot;Adamax&quot;</span><span class=p>,</span> <span class=s2>&quot;SGD&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=s2>&quot;Adam&quot;</span><span class=p>,</span>
</span><span id=__span-0-647><a id=__codelineno-0-647 name=__codelineno-0-647></a>    <span class=n>optimizer_params</span><span class=p>:</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-648><a id=__codelineno-0-648 name=__codelineno-0-648></a>    <span class=n>lr_scheduler</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span><span class=s2>&quot;ReduceLROnPlateau&quot;</span><span class=p>,</span> <span class=s2>&quot;StepLR&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=s2>&quot;ReduceLROnPlateau&quot;</span><span class=p>,</span>
</span><span id=__span-0-649><a id=__codelineno-0-649 name=__codelineno-0-649></a>    <span class=n>lr_scheduler_params</span><span class=p>:</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-650><a id=__codelineno-0-650 name=__codelineno-0-650></a>    <span class=n>train_dataloader_params</span><span class=p>:</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-651><a id=__codelineno-0-651 name=__codelineno-0-651></a>    <span class=n>val_dataloader_params</span><span class=p>:</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-652><a id=__codelineno-0-652 name=__codelineno-0-652></a>    <span class=n>checkpoint_params</span><span class=p>:</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-653><a id=__codelineno-0-653 name=__codelineno-0-653></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Configuration</span><span class=p>:</span>
</span><span id=__span-0-654><a id=__codelineno-0-654 name=__codelineno-0-654></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-655><a id=__codelineno-0-655 name=__codelineno-0-655></a><span class=sd>    Create a configuration for training CARE.</span>
</span><span id=__span-0-656><a id=__codelineno-0-656 name=__codelineno-0-656></a>
</span><span id=__span-0-657><a id=__codelineno-0-657 name=__codelineno-0-657></a><span class=sd>    If &quot;Z&quot; is present in `axes`, then `path_size` must be a list of length 3, otherwise</span>
</span><span id=__span-0-658><a id=__codelineno-0-658 name=__codelineno-0-658></a><span class=sd>    2.</span>
</span><span id=__span-0-659><a id=__codelineno-0-659 name=__codelineno-0-659></a>
</span><span id=__span-0-660><a id=__codelineno-0-660 name=__codelineno-0-660></a><span class=sd>    If &quot;C&quot; is present in `axes`, then you need to set `n_channels_in` to the number of</span>
</span><span id=__span-0-661><a id=__codelineno-0-661 name=__codelineno-0-661></a><span class=sd>    channels. Likewise, if you set the number of channels, then &quot;C&quot; must be present in</span>
</span><span id=__span-0-662><a id=__codelineno-0-662 name=__codelineno-0-662></a><span class=sd>    `axes`.</span>
</span><span id=__span-0-663><a id=__codelineno-0-663 name=__codelineno-0-663></a>
</span><span id=__span-0-664><a id=__codelineno-0-664 name=__codelineno-0-664></a><span class=sd>    To set the number of output channels, use the `n_channels_out` parameter. If it is</span>
</span><span id=__span-0-665><a id=__codelineno-0-665 name=__codelineno-0-665></a><span class=sd>    not specified, it will be assumed to be equal to `n_channels_in`.</span>
</span><span id=__span-0-666><a id=__codelineno-0-666 name=__codelineno-0-666></a>
</span><span id=__span-0-667><a id=__codelineno-0-667 name=__codelineno-0-667></a><span class=sd>    By default, all channels are trained together. To train all channels independently,</span>
</span><span id=__span-0-668><a id=__codelineno-0-668 name=__codelineno-0-668></a><span class=sd>    set `independent_channels` to True.</span>
</span><span id=__span-0-669><a id=__codelineno-0-669 name=__codelineno-0-669></a>
</span><span id=__span-0-670><a id=__codelineno-0-670 name=__codelineno-0-670></a><span class=sd>    By setting `augmentations` to `None`, the default transformations (flip in X and Y,</span>
</span><span id=__span-0-671><a id=__codelineno-0-671 name=__codelineno-0-671></a><span class=sd>    rotations by 90 degrees in the XY plane) are applied. Rather than the default</span>
</span><span id=__span-0-672><a id=__codelineno-0-672 name=__codelineno-0-672></a><span class=sd>    transforms, a list of transforms can be passed to the `augmentations` parameter. To</span>
</span><span id=__span-0-673><a id=__codelineno-0-673 name=__codelineno-0-673></a><span class=sd>    disable the transforms, simply pass an empty list.</span>
</span><span id=__span-0-674><a id=__codelineno-0-674 name=__codelineno-0-674></a>
</span><span id=__span-0-675><a id=__codelineno-0-675 name=__codelineno-0-675></a><span class=sd>    Parameters</span>
</span><span id=__span-0-676><a id=__codelineno-0-676 name=__codelineno-0-676></a><span class=sd>    ----------</span>
</span><span id=__span-0-677><a id=__codelineno-0-677 name=__codelineno-0-677></a><span class=sd>    experiment_name : str</span>
</span><span id=__span-0-678><a id=__codelineno-0-678 name=__codelineno-0-678></a><span class=sd>        Name of the experiment.</span>
</span><span id=__span-0-679><a id=__codelineno-0-679 name=__codelineno-0-679></a><span class=sd>    data_type : Literal[&quot;array&quot;, &quot;tiff&quot;, &quot;czi&quot;, &quot;custom&quot;]</span>
</span><span id=__span-0-680><a id=__codelineno-0-680 name=__codelineno-0-680></a><span class=sd>        Type of the data.</span>
</span><span id=__span-0-681><a id=__codelineno-0-681 name=__codelineno-0-681></a><span class=sd>    axes : str</span>
</span><span id=__span-0-682><a id=__codelineno-0-682 name=__codelineno-0-682></a><span class=sd>        Axes of the data (e.g. SYX).</span>
</span><span id=__span-0-683><a id=__codelineno-0-683 name=__codelineno-0-683></a><span class=sd>    patch_size : List[int]</span>
</span><span id=__span-0-684><a id=__codelineno-0-684 name=__codelineno-0-684></a><span class=sd>        Size of the patches along the spatial dimensions (e.g. [64, 64]).</span>
</span><span id=__span-0-685><a id=__codelineno-0-685 name=__codelineno-0-685></a><span class=sd>    batch_size : int</span>
</span><span id=__span-0-686><a id=__codelineno-0-686 name=__codelineno-0-686></a><span class=sd>        Batch size.</span>
</span><span id=__span-0-687><a id=__codelineno-0-687 name=__codelineno-0-687></a><span class=sd>    num_epochs : int, default=100</span>
</span><span id=__span-0-688><a id=__codelineno-0-688 name=__codelineno-0-688></a><span class=sd>        Number of epochs to train for. If provided, this will be added to</span>
</span><span id=__span-0-689><a id=__codelineno-0-689 name=__codelineno-0-689></a><span class=sd>        trainer_params.</span>
</span><span id=__span-0-690><a id=__codelineno-0-690 name=__codelineno-0-690></a><span class=sd>    num_steps : int, optional</span>
</span><span id=__span-0-691><a id=__codelineno-0-691 name=__codelineno-0-691></a><span class=sd>        Number of batches in 1 epoch. If provided, this will be added to trainer_params.</span>
</span><span id=__span-0-692><a id=__codelineno-0-692 name=__codelineno-0-692></a><span class=sd>        Translates to `limit_train_batches` in PyTorch Lightning Trainer. See relevant</span>
</span><span id=__span-0-693><a id=__codelineno-0-693 name=__codelineno-0-693></a><span class=sd>        documentation for more details.</span>
</span><span id=__span-0-694><a id=__codelineno-0-694 name=__codelineno-0-694></a><span class=sd>    augmentations : list of transforms, default=None</span>
</span><span id=__span-0-695><a id=__codelineno-0-695 name=__codelineno-0-695></a><span class=sd>        List of transforms to apply, either both or one of XYFlipModel and</span>
</span><span id=__span-0-696><a id=__codelineno-0-696 name=__codelineno-0-696></a><span class=sd>        XYRandomRotate90Model. By default, it applies both XYFlip (on X and Y)</span>
</span><span id=__span-0-697><a id=__codelineno-0-697 name=__codelineno-0-697></a><span class=sd>        and XYRandomRotate90 (in XY) to the images.</span>
</span><span id=__span-0-698><a id=__codelineno-0-698 name=__codelineno-0-698></a><span class=sd>    independent_channels : bool, optional</span>
</span><span id=__span-0-699><a id=__codelineno-0-699 name=__codelineno-0-699></a><span class=sd>        Whether to train all channels independently, by default False.</span>
</span><span id=__span-0-700><a id=__codelineno-0-700 name=__codelineno-0-700></a><span class=sd>    loss : Literal[&quot;mae&quot;, &quot;mse&quot;], default=&quot;mae&quot;</span>
</span><span id=__span-0-701><a id=__codelineno-0-701 name=__codelineno-0-701></a><span class=sd>        Loss function to use.</span>
</span><span id=__span-0-702><a id=__codelineno-0-702 name=__codelineno-0-702></a><span class=sd>    n_channels_in : int or None, default=None</span>
</span><span id=__span-0-703><a id=__codelineno-0-703 name=__codelineno-0-703></a><span class=sd>        Number of channels in.</span>
</span><span id=__span-0-704><a id=__codelineno-0-704 name=__codelineno-0-704></a><span class=sd>    n_channels_out : int or None, default=None</span>
</span><span id=__span-0-705><a id=__codelineno-0-705 name=__codelineno-0-705></a><span class=sd>        Number of channels out.</span>
</span><span id=__span-0-706><a id=__codelineno-0-706 name=__codelineno-0-706></a><span class=sd>    logger : Literal[&quot;wandb&quot;, &quot;tensorboard&quot;, &quot;none&quot;], default=&quot;none&quot;</span>
</span><span id=__span-0-707><a id=__codelineno-0-707 name=__codelineno-0-707></a><span class=sd>        Logger to use.</span>
</span><span id=__span-0-708><a id=__codelineno-0-708 name=__codelineno-0-708></a><span class=sd>    trainer_params : dict, optional</span>
</span><span id=__span-0-709><a id=__codelineno-0-709 name=__codelineno-0-709></a><span class=sd>        Parameters for the trainer class, see PyTorch Lightning documentation.</span>
</span><span id=__span-0-710><a id=__codelineno-0-710 name=__codelineno-0-710></a><span class=sd>    model_params : dict, default=None</span>
</span><span id=__span-0-711><a id=__codelineno-0-711 name=__codelineno-0-711></a><span class=sd>        UNetModel parameters.</span>
</span><span id=__span-0-712><a id=__codelineno-0-712 name=__codelineno-0-712></a><span class=sd>    optimizer : Literal[&quot;Adam&quot;, &quot;Adamax&quot;, &quot;SGD&quot;], default=&quot;Adam&quot;</span>
</span><span id=__span-0-713><a id=__codelineno-0-713 name=__codelineno-0-713></a><span class=sd>        Optimizer to use.</span>
</span><span id=__span-0-714><a id=__codelineno-0-714 name=__codelineno-0-714></a><span class=sd>    optimizer_params : dict, default=None</span>
</span><span id=__span-0-715><a id=__codelineno-0-715 name=__codelineno-0-715></a><span class=sd>        Parameters for the optimizer, see PyTorch documentation for more details.</span>
</span><span id=__span-0-716><a id=__codelineno-0-716 name=__codelineno-0-716></a><span class=sd>    lr_scheduler : Literal[&quot;ReduceLROnPlateau&quot;, &quot;StepLR&quot;], default=&quot;ReduceLROnPlateau&quot;</span>
</span><span id=__span-0-717><a id=__codelineno-0-717 name=__codelineno-0-717></a><span class=sd>        Learning rate scheduler to use.</span>
</span><span id=__span-0-718><a id=__codelineno-0-718 name=__codelineno-0-718></a><span class=sd>    lr_scheduler_params : dict, default=None</span>
</span><span id=__span-0-719><a id=__codelineno-0-719 name=__codelineno-0-719></a><span class=sd>        Parameters for the learning rate scheduler, see PyTorch documentation for more</span>
</span><span id=__span-0-720><a id=__codelineno-0-720 name=__codelineno-0-720></a><span class=sd>        details.</span>
</span><span id=__span-0-721><a id=__codelineno-0-721 name=__codelineno-0-721></a><span class=sd>    train_dataloader_params : dict, optional</span>
</span><span id=__span-0-722><a id=__codelineno-0-722 name=__codelineno-0-722></a><span class=sd>        Parameters for the training dataloader, see the PyTorch docs for `DataLoader`.</span>
</span><span id=__span-0-723><a id=__codelineno-0-723 name=__codelineno-0-723></a><span class=sd>        If left as `None`, the dict `{&quot;shuffle&quot;: True}` will be used, this is set in</span>
</span><span id=__span-0-724><a id=__codelineno-0-724 name=__codelineno-0-724></a><span class=sd>        the `GeneralDataConfig`.</span>
</span><span id=__span-0-725><a id=__codelineno-0-725 name=__codelineno-0-725></a><span class=sd>    val_dataloader_params : dict, optional</span>
</span><span id=__span-0-726><a id=__codelineno-0-726 name=__codelineno-0-726></a><span class=sd>        Parameters for the validation dataloader, see PyTorch the docs for `DataLoader`.</span>
</span><span id=__span-0-727><a id=__codelineno-0-727 name=__codelineno-0-727></a><span class=sd>        If left as `None`, the empty dict `{}` will be used, this is set in the</span>
</span><span id=__span-0-728><a id=__codelineno-0-728 name=__codelineno-0-728></a><span class=sd>        `GeneralDataConfig`.</span>
</span><span id=__span-0-729><a id=__codelineno-0-729 name=__codelineno-0-729></a><span class=sd>    checkpoint_params : dict, default=None</span>
</span><span id=__span-0-730><a id=__codelineno-0-730 name=__codelineno-0-730></a><span class=sd>        Parameters for the checkpoint callback, see PyTorch Lightning documentation</span>
</span><span id=__span-0-731><a id=__codelineno-0-731 name=__codelineno-0-731></a><span class=sd>        (`ModelCheckpoint`) for the list of available parameters.</span>
</span><span id=__span-0-732><a id=__codelineno-0-732 name=__codelineno-0-732></a>
</span><span id=__span-0-733><a id=__codelineno-0-733 name=__codelineno-0-733></a><span class=sd>    Returns</span>
</span><span id=__span-0-734><a id=__codelineno-0-734 name=__codelineno-0-734></a><span class=sd>    -------</span>
</span><span id=__span-0-735><a id=__codelineno-0-735 name=__codelineno-0-735></a><span class=sd>    Configuration</span>
</span><span id=__span-0-736><a id=__codelineno-0-736 name=__codelineno-0-736></a><span class=sd>        Configuration for training CARE.</span>
</span><span id=__span-0-737><a id=__codelineno-0-737 name=__codelineno-0-737></a>
</span><span id=__span-0-738><a id=__codelineno-0-738 name=__codelineno-0-738></a><span class=sd>    Examples</span>
</span><span id=__span-0-739><a id=__codelineno-0-739 name=__codelineno-0-739></a><span class=sd>    --------</span>
</span><span id=__span-0-740><a id=__codelineno-0-740 name=__codelineno-0-740></a><span class=sd>    Minimum example:</span>
</span><span id=__span-0-741><a id=__codelineno-0-741 name=__codelineno-0-741></a><span class=sd>    &gt;&gt;&gt; config = create_care_configuration(</span>
</span><span id=__span-0-742><a id=__codelineno-0-742 name=__codelineno-0-742></a><span class=sd>    ...     experiment_name=&quot;care_experiment&quot;,</span>
</span><span id=__span-0-743><a id=__codelineno-0-743 name=__codelineno-0-743></a><span class=sd>    ...     data_type=&quot;array&quot;,</span>
</span><span id=__span-0-744><a id=__codelineno-0-744 name=__codelineno-0-744></a><span class=sd>    ...     axes=&quot;YX&quot;,</span>
</span><span id=__span-0-745><a id=__codelineno-0-745 name=__codelineno-0-745></a><span class=sd>    ...     patch_size=[64, 64],</span>
</span><span id=__span-0-746><a id=__codelineno-0-746 name=__codelineno-0-746></a><span class=sd>    ...     batch_size=32,</span>
</span><span id=__span-0-747><a id=__codelineno-0-747 name=__codelineno-0-747></a><span class=sd>    ...     num_epochs=100</span>
</span><span id=__span-0-748><a id=__codelineno-0-748 name=__codelineno-0-748></a><span class=sd>    ... )</span>
</span><span id=__span-0-749><a id=__codelineno-0-749 name=__codelineno-0-749></a>
</span><span id=__span-0-750><a id=__codelineno-0-750 name=__codelineno-0-750></a><span class=sd>    You can also limit the number of batches per epoch:</span>
</span><span id=__span-0-751><a id=__codelineno-0-751 name=__codelineno-0-751></a><span class=sd>    &gt;&gt;&gt; config = create_care_configuration(</span>
</span><span id=__span-0-752><a id=__codelineno-0-752 name=__codelineno-0-752></a><span class=sd>    ...     experiment_name=&quot;care_experiment&quot;,</span>
</span><span id=__span-0-753><a id=__codelineno-0-753 name=__codelineno-0-753></a><span class=sd>    ...     data_type=&quot;array&quot;,</span>
</span><span id=__span-0-754><a id=__codelineno-0-754 name=__codelineno-0-754></a><span class=sd>    ...     axes=&quot;YX&quot;,</span>
</span><span id=__span-0-755><a id=__codelineno-0-755 name=__codelineno-0-755></a><span class=sd>    ...     patch_size=[64, 64],</span>
</span><span id=__span-0-756><a id=__codelineno-0-756 name=__codelineno-0-756></a><span class=sd>    ...     batch_size=32,</span>
</span><span id=__span-0-757><a id=__codelineno-0-757 name=__codelineno-0-757></a><span class=sd>    ...     num_steps=100  # limit to 100 batches per epoch</span>
</span><span id=__span-0-758><a id=__codelineno-0-758 name=__codelineno-0-758></a><span class=sd>    ... )</span>
</span><span id=__span-0-759><a id=__codelineno-0-759 name=__codelineno-0-759></a>
</span><span id=__span-0-760><a id=__codelineno-0-760 name=__codelineno-0-760></a><span class=sd>    To disable transforms, simply set `augmentations` to an empty list:</span>
</span><span id=__span-0-761><a id=__codelineno-0-761 name=__codelineno-0-761></a><span class=sd>    &gt;&gt;&gt; config = create_care_configuration(</span>
</span><span id=__span-0-762><a id=__codelineno-0-762 name=__codelineno-0-762></a><span class=sd>    ...     experiment_name=&quot;care_experiment&quot;,</span>
</span><span id=__span-0-763><a id=__codelineno-0-763 name=__codelineno-0-763></a><span class=sd>    ...     data_type=&quot;array&quot;,</span>
</span><span id=__span-0-764><a id=__codelineno-0-764 name=__codelineno-0-764></a><span class=sd>    ...     axes=&quot;YX&quot;,</span>
</span><span id=__span-0-765><a id=__codelineno-0-765 name=__codelineno-0-765></a><span class=sd>    ...     patch_size=[64, 64],</span>
</span><span id=__span-0-766><a id=__codelineno-0-766 name=__codelineno-0-766></a><span class=sd>    ...     batch_size=32,</span>
</span><span id=__span-0-767><a id=__codelineno-0-767 name=__codelineno-0-767></a><span class=sd>    ...     num_epochs=100,</span>
</span><span id=__span-0-768><a id=__codelineno-0-768 name=__codelineno-0-768></a><span class=sd>    ...     augmentations=[]</span>
</span><span id=__span-0-769><a id=__codelineno-0-769 name=__codelineno-0-769></a><span class=sd>    ... )</span>
</span><span id=__span-0-770><a id=__codelineno-0-770 name=__codelineno-0-770></a>
</span><span id=__span-0-771><a id=__codelineno-0-771 name=__codelineno-0-771></a><span class=sd>    A list of transforms can be passed to the `augmentations` parameter to replace the</span>
</span><span id=__span-0-772><a id=__codelineno-0-772 name=__codelineno-0-772></a><span class=sd>    default augmentations:</span>
</span><span id=__span-0-773><a id=__codelineno-0-773 name=__codelineno-0-773></a><span class=sd>    &gt;&gt;&gt; from careamics.config.transformations import XYFlipModel</span>
</span><span id=__span-0-774><a id=__codelineno-0-774 name=__codelineno-0-774></a><span class=sd>    &gt;&gt;&gt; config = create_care_configuration(</span>
</span><span id=__span-0-775><a id=__codelineno-0-775 name=__codelineno-0-775></a><span class=sd>    ...     experiment_name=&quot;care_experiment&quot;,</span>
</span><span id=__span-0-776><a id=__codelineno-0-776 name=__codelineno-0-776></a><span class=sd>    ...     data_type=&quot;array&quot;,</span>
</span><span id=__span-0-777><a id=__codelineno-0-777 name=__codelineno-0-777></a><span class=sd>    ...     axes=&quot;YX&quot;,</span>
</span><span id=__span-0-778><a id=__codelineno-0-778 name=__codelineno-0-778></a><span class=sd>    ...     patch_size=[64, 64],</span>
</span><span id=__span-0-779><a id=__codelineno-0-779 name=__codelineno-0-779></a><span class=sd>    ...     batch_size=32,</span>
</span><span id=__span-0-780><a id=__codelineno-0-780 name=__codelineno-0-780></a><span class=sd>    ...     num_epochs=100,</span>
</span><span id=__span-0-781><a id=__codelineno-0-781 name=__codelineno-0-781></a><span class=sd>    ...     augmentations=[</span>
</span><span id=__span-0-782><a id=__codelineno-0-782 name=__codelineno-0-782></a><span class=sd>    ...         # No rotation and only Y flipping</span>
</span><span id=__span-0-783><a id=__codelineno-0-783 name=__codelineno-0-783></a><span class=sd>    ...         XYFlipModel(flip_x = False, flip_y = True)</span>
</span><span id=__span-0-784><a id=__codelineno-0-784 name=__codelineno-0-784></a><span class=sd>    ...     ]</span>
</span><span id=__span-0-785><a id=__codelineno-0-785 name=__codelineno-0-785></a><span class=sd>    ... )</span>
</span><span id=__span-0-786><a id=__codelineno-0-786 name=__codelineno-0-786></a>
</span><span id=__span-0-787><a id=__codelineno-0-787 name=__codelineno-0-787></a><span class=sd>    If you are training multiple channels they will be trained independently by default,</span>
</span><span id=__span-0-788><a id=__codelineno-0-788 name=__codelineno-0-788></a><span class=sd>    you simply need to specify the number of channels input (and optionally, the number</span>
</span><span id=__span-0-789><a id=__codelineno-0-789 name=__codelineno-0-789></a><span class=sd>    of channels output):</span>
</span><span id=__span-0-790><a id=__codelineno-0-790 name=__codelineno-0-790></a><span class=sd>    &gt;&gt;&gt; config = create_care_configuration(</span>
</span><span id=__span-0-791><a id=__codelineno-0-791 name=__codelineno-0-791></a><span class=sd>    ...     experiment_name=&quot;care_experiment&quot;,</span>
</span><span id=__span-0-792><a id=__codelineno-0-792 name=__codelineno-0-792></a><span class=sd>    ...     data_type=&quot;array&quot;,</span>
</span><span id=__span-0-793><a id=__codelineno-0-793 name=__codelineno-0-793></a><span class=sd>    ...     axes=&quot;YXC&quot;, # channels must be in the axes</span>
</span><span id=__span-0-794><a id=__codelineno-0-794 name=__codelineno-0-794></a><span class=sd>    ...     patch_size=[64, 64],</span>
</span><span id=__span-0-795><a id=__codelineno-0-795 name=__codelineno-0-795></a><span class=sd>    ...     batch_size=32,</span>
</span><span id=__span-0-796><a id=__codelineno-0-796 name=__codelineno-0-796></a><span class=sd>    ...     num_epochs=100,</span>
</span><span id=__span-0-797><a id=__codelineno-0-797 name=__codelineno-0-797></a><span class=sd>    ...     n_channels_in=3, # number of input channels</span>
</span><span id=__span-0-798><a id=__codelineno-0-798 name=__codelineno-0-798></a><span class=sd>    ...     n_channels_out=1 # if applicable</span>
</span><span id=__span-0-799><a id=__codelineno-0-799 name=__codelineno-0-799></a><span class=sd>    ... )</span>
</span><span id=__span-0-800><a id=__codelineno-0-800 name=__codelineno-0-800></a>
</span><span id=__span-0-801><a id=__codelineno-0-801 name=__codelineno-0-801></a><span class=sd>    If instead you want to train multiple channels together, you need to turn off the</span>
</span><span id=__span-0-802><a id=__codelineno-0-802 name=__codelineno-0-802></a><span class=sd>    `independent_channels` parameter:</span>
</span><span id=__span-0-803><a id=__codelineno-0-803 name=__codelineno-0-803></a><span class=sd>    &gt;&gt;&gt; config = create_care_configuration(</span>
</span><span id=__span-0-804><a id=__codelineno-0-804 name=__codelineno-0-804></a><span class=sd>    ...     experiment_name=&quot;care_experiment&quot;,</span>
</span><span id=__span-0-805><a id=__codelineno-0-805 name=__codelineno-0-805></a><span class=sd>    ...     data_type=&quot;array&quot;,</span>
</span><span id=__span-0-806><a id=__codelineno-0-806 name=__codelineno-0-806></a><span class=sd>    ...     axes=&quot;YXC&quot;, # channels must be in the axes</span>
</span><span id=__span-0-807><a id=__codelineno-0-807 name=__codelineno-0-807></a><span class=sd>    ...     patch_size=[64, 64],</span>
</span><span id=__span-0-808><a id=__codelineno-0-808 name=__codelineno-0-808></a><span class=sd>    ...     batch_size=32,</span>
</span><span id=__span-0-809><a id=__codelineno-0-809 name=__codelineno-0-809></a><span class=sd>    ...     num_epochs=100,</span>
</span><span id=__span-0-810><a id=__codelineno-0-810 name=__codelineno-0-810></a><span class=sd>    ...     independent_channels=False,</span>
</span><span id=__span-0-811><a id=__codelineno-0-811 name=__codelineno-0-811></a><span class=sd>    ...     n_channels_in=3,</span>
</span><span id=__span-0-812><a id=__codelineno-0-812 name=__codelineno-0-812></a><span class=sd>    ...     n_channels_out=1 # if applicable</span>
</span><span id=__span-0-813><a id=__codelineno-0-813 name=__codelineno-0-813></a><span class=sd>    ... )</span>
</span><span id=__span-0-814><a id=__codelineno-0-814 name=__codelineno-0-814></a>
</span><span id=__span-0-815><a id=__codelineno-0-815 name=__codelineno-0-815></a><span class=sd>    If you would like to train on CZI files, use `&quot;czi&quot;` as `data_type` and `&quot;SCYX&quot;` as</span>
</span><span id=__span-0-816><a id=__codelineno-0-816 name=__codelineno-0-816></a><span class=sd>    `axes` for 2-D or `&quot;SCZYX&quot;` for 3-D denoising. Note that `&quot;SCYX&quot;` can also be used</span>
</span><span id=__span-0-817><a id=__codelineno-0-817 name=__codelineno-0-817></a><span class=sd>    for 3-D data but spatial context along the Z dimension will then not be taken into</span>
</span><span id=__span-0-818><a id=__codelineno-0-818 name=__codelineno-0-818></a><span class=sd>    account.</span>
</span><span id=__span-0-819><a id=__codelineno-0-819 name=__codelineno-0-819></a><span class=sd>    &gt;&gt;&gt; config_2d = create_care_configuration(</span>
</span><span id=__span-0-820><a id=__codelineno-0-820 name=__codelineno-0-820></a><span class=sd>    ...     experiment_name=&quot;care_experiment&quot;,</span>
</span><span id=__span-0-821><a id=__codelineno-0-821 name=__codelineno-0-821></a><span class=sd>    ...     data_type=&quot;czi&quot;,</span>
</span><span id=__span-0-822><a id=__codelineno-0-822 name=__codelineno-0-822></a><span class=sd>    ...     axes=&quot;SCYX&quot;,</span>
</span><span id=__span-0-823><a id=__codelineno-0-823 name=__codelineno-0-823></a><span class=sd>    ...     patch_size=[64, 64],</span>
</span><span id=__span-0-824><a id=__codelineno-0-824 name=__codelineno-0-824></a><span class=sd>    ...     batch_size=32,</span>
</span><span id=__span-0-825><a id=__codelineno-0-825 name=__codelineno-0-825></a><span class=sd>    ...     num_epochs=100,</span>
</span><span id=__span-0-826><a id=__codelineno-0-826 name=__codelineno-0-826></a><span class=sd>    ...     n_channels_in=1,</span>
</span><span id=__span-0-827><a id=__codelineno-0-827 name=__codelineno-0-827></a><span class=sd>    ... )</span>
</span><span id=__span-0-828><a id=__codelineno-0-828 name=__codelineno-0-828></a><span class=sd>    &gt;&gt;&gt; config_3d = create_care_configuration(</span>
</span><span id=__span-0-829><a id=__codelineno-0-829 name=__codelineno-0-829></a><span class=sd>    ...     experiment_name=&quot;care_experiment&quot;,</span>
</span><span id=__span-0-830><a id=__codelineno-0-830 name=__codelineno-0-830></a><span class=sd>    ...     data_type=&quot;czi&quot;,</span>
</span><span id=__span-0-831><a id=__codelineno-0-831 name=__codelineno-0-831></a><span class=sd>    ...     axes=&quot;SCZYX&quot;,</span>
</span><span id=__span-0-832><a id=__codelineno-0-832 name=__codelineno-0-832></a><span class=sd>    ...     patch_size=[16, 64, 64],</span>
</span><span id=__span-0-833><a id=__codelineno-0-833 name=__codelineno-0-833></a><span class=sd>    ...     batch_size=16,</span>
</span><span id=__span-0-834><a id=__codelineno-0-834 name=__codelineno-0-834></a><span class=sd>    ...     num_epochs=100,</span>
</span><span id=__span-0-835><a id=__codelineno-0-835 name=__codelineno-0-835></a><span class=sd>    ...     n_channels_in=1,</span>
</span><span id=__span-0-836><a id=__codelineno-0-836 name=__codelineno-0-836></a><span class=sd>    ... )</span>
</span><span id=__span-0-837><a id=__codelineno-0-837 name=__codelineno-0-837></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-838><a id=__codelineno-0-838 name=__codelineno-0-838></a>    <span class=k>return</span> <span class=n>Configuration</span><span class=p>(</span>
</span><span id=__span-0-839><a id=__codelineno-0-839 name=__codelineno-0-839></a>        <span class=o>**</span><span class=n>_create_supervised_config_dict</span><span class=p>(</span>
</span><span id=__span-0-840><a id=__codelineno-0-840 name=__codelineno-0-840></a>            <span class=n>algorithm</span><span class=o>=</span><span class=s2>&quot;care&quot;</span><span class=p>,</span>
</span><span id=__span-0-841><a id=__codelineno-0-841 name=__codelineno-0-841></a>            <span class=n>experiment_name</span><span class=o>=</span><span class=n>experiment_name</span><span class=p>,</span>
</span><span id=__span-0-842><a id=__codelineno-0-842 name=__codelineno-0-842></a>            <span class=n>data_type</span><span class=o>=</span><span class=n>data_type</span><span class=p>,</span>
</span><span id=__span-0-843><a id=__codelineno-0-843 name=__codelineno-0-843></a>            <span class=n>axes</span><span class=o>=</span><span class=n>axes</span><span class=p>,</span>
</span><span id=__span-0-844><a id=__codelineno-0-844 name=__codelineno-0-844></a>            <span class=n>patch_size</span><span class=o>=</span><span class=n>patch_size</span><span class=p>,</span>
</span><span id=__span-0-845><a id=__codelineno-0-845 name=__codelineno-0-845></a>            <span class=n>batch_size</span><span class=o>=</span><span class=n>batch_size</span><span class=p>,</span>
</span><span id=__span-0-846><a id=__codelineno-0-846 name=__codelineno-0-846></a>            <span class=n>augmentations</span><span class=o>=</span><span class=n>augmentations</span><span class=p>,</span>
</span><span id=__span-0-847><a id=__codelineno-0-847 name=__codelineno-0-847></a>            <span class=n>independent_channels</span><span class=o>=</span><span class=n>independent_channels</span><span class=p>,</span>
</span><span id=__span-0-848><a id=__codelineno-0-848 name=__codelineno-0-848></a>            <span class=n>loss</span><span class=o>=</span><span class=n>loss</span><span class=p>,</span>
</span><span id=__span-0-849><a id=__codelineno-0-849 name=__codelineno-0-849></a>            <span class=n>n_channels_in</span><span class=o>=</span><span class=n>n_channels_in</span><span class=p>,</span>
</span><span id=__span-0-850><a id=__codelineno-0-850 name=__codelineno-0-850></a>            <span class=n>n_channels_out</span><span class=o>=</span><span class=n>n_channels_out</span><span class=p>,</span>
</span><span id=__span-0-851><a id=__codelineno-0-851 name=__codelineno-0-851></a>            <span class=n>logger</span><span class=o>=</span><span class=n>logger</span><span class=p>,</span>
</span><span id=__span-0-852><a id=__codelineno-0-852 name=__codelineno-0-852></a>            <span class=n>trainer_params</span><span class=o>=</span><span class=n>trainer_params</span><span class=p>,</span>
</span><span id=__span-0-853><a id=__codelineno-0-853 name=__codelineno-0-853></a>            <span class=n>model_params</span><span class=o>=</span><span class=n>model_params</span><span class=p>,</span>
</span><span id=__span-0-854><a id=__codelineno-0-854 name=__codelineno-0-854></a>            <span class=n>optimizer</span><span class=o>=</span><span class=n>optimizer</span><span class=p>,</span>
</span><span id=__span-0-855><a id=__codelineno-0-855 name=__codelineno-0-855></a>            <span class=n>optimizer_params</span><span class=o>=</span><span class=n>optimizer_params</span><span class=p>,</span>
</span><span id=__span-0-856><a id=__codelineno-0-856 name=__codelineno-0-856></a>            <span class=n>lr_scheduler</span><span class=o>=</span><span class=n>lr_scheduler</span><span class=p>,</span>
</span><span id=__span-0-857><a id=__codelineno-0-857 name=__codelineno-0-857></a>            <span class=n>lr_scheduler_params</span><span class=o>=</span><span class=n>lr_scheduler_params</span><span class=p>,</span>
</span><span id=__span-0-858><a id=__codelineno-0-858 name=__codelineno-0-858></a>            <span class=n>train_dataloader_params</span><span class=o>=</span><span class=n>train_dataloader_params</span><span class=p>,</span>
</span><span id=__span-0-859><a id=__codelineno-0-859 name=__codelineno-0-859></a>            <span class=n>val_dataloader_params</span><span class=o>=</span><span class=n>val_dataloader_params</span><span class=p>,</span>
</span><span id=__span-0-860><a id=__codelineno-0-860 name=__codelineno-0-860></a>            <span class=n>checkpoint_params</span><span class=o>=</span><span class=n>checkpoint_params</span><span class=p>,</span>
</span><span id=__span-0-861><a id=__codelineno-0-861 name=__codelineno-0-861></a>            <span class=n>num_epochs</span><span class=o>=</span><span class=n>num_epochs</span><span class=p>,</span>
</span><span id=__span-0-862><a id=__codelineno-0-862 name=__codelineno-0-862></a>            <span class=n>num_steps</span><span class=o>=</span><span class=n>num_steps</span><span class=p>,</span>
</span><span id=__span-0-863><a id=__codelineno-0-863 name=__codelineno-0-863></a>        <span class=p>)</span>
</span><span id=__span-0-864><a id=__codelineno-0-864 name=__codelineno-0-864></a>    <span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=careamics.config.configuration_factories.create_hdn_configuration class="doc doc-heading"> <code class="highlight language-python"><span class=n>create_hdn_configuration</span><span class=p>(</span><span class=n>experiment_name</span><span class=p>,</span> <span class=n>data_type</span><span class=p>,</span> <span class=n>axes</span><span class=p>,</span> <span class=n>patch_size</span><span class=p>,</span> <span class=n>batch_size</span><span class=p>,</span> <span class=n>num_epochs</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>num_steps</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>encoder_conv_strides</span><span class=o>=</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>),</span> <span class=n>decoder_conv_strides</span><span class=o>=</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>),</span> <span class=n>multiscale_count</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>z_dims</span><span class=o>=</span><span class=p>(</span><span class=mi>128</span><span class=p>,</span> <span class=mi>128</span><span class=p>),</span> <span class=n>output_channels</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>encoder_n_filters</span><span class=o>=</span><span class=mi>32</span><span class=p>,</span> <span class=n>decoder_n_filters</span><span class=o>=</span><span class=mi>32</span><span class=p>,</span> <span class=n>encoder_dropout</span><span class=o>=</span><span class=mf>0.0</span><span class=p>,</span> <span class=n>decoder_dropout</span><span class=o>=</span><span class=mf>0.0</span><span class=p>,</span> <span class=n>nonlinearity</span><span class=o>=</span><span class=s1>&#39;ReLU&#39;</span><span class=p>,</span> <span class=n>analytical_kl</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>predict_logvar</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>logvar_lowerbound</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=s1>&#39;none&#39;</span><span class=p>,</span> <span class=n>trainer_params</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>augmentations</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>train_dataloader_params</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>val_dataloader_params</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#careamics.config.configuration_factories.create_hdn_configuration class=headerlink title="Permanent link">#</a></h2> <div class="doc doc-contents "> <p>Create a configuration for training HDN.</p> <p>If "Z" is present in <code>axes</code>, then <code>path_size</code> must be a list of length 3, otherwise 2.</p> <p>If "C" is present in <code>axes</code>, then you need to set <code>n_channels_in</code> to the number of channels. Likewise, if you set the number of channels, then "C" must be present in <code>axes</code>.</p> <p>To set the number of output channels, use the <code>n_channels_out</code> parameter. If it is not specified, it will be assumed to be equal to <code>n_channels_in</code>.</p> <p>By default, all channels are trained independently. To train all channels together, set <code>independent_channels</code> to False.</p> <p>By setting <code>augmentations</code> to <code>None</code>, the default transformations (flip in X and Y, rotations by 90 degrees in the XY plane) are applied. Rather than the default transforms, a list of transforms can be passed to the <code>augmentations</code> parameter. To disable the transforms, simply pass an empty list.</p> <h3 id=careamics.config.configuration_factories.create_hdn_configuration--todo-revisit-the-necessity-of-model_params>TODO revisit the necessity of model_params<a class=headerlink href=#careamics.config.configuration_factories.create_hdn_configuration--todo-revisit-the-necessity-of-model_params title="Permanent link">#</a></h3> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>experiment_name</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>Name of the experiment.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>data_type</code> </td> <td> <code><span title=typing.Literal>Literal</span>[&#39;array&#39;, &#39;tiff&#39;, &#39;custom&#39;]</code> </td> <td> <div class=doc-md-description> <p>Type of the data.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>axes</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>Axes of the data (e.g. SYX).</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>patch_size</code> </td> <td> <code><span title=List>List</span>[<span title=int>int</span>]</code> </td> <td> <div class=doc-md-description> <p>Size of the patches along the spatial dimensions (e.g. [64, 64]).</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>batch_size</code> </td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>Batch size.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>num_epochs</code> </td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>Number of epochs to train for. If provided, this will be added to trainer_params.</p> </div> </td> <td> <code>100</code> </td> </tr> <tr class=doc-section-item> <td> <code>num_steps</code> </td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>Number of batches in 1 epoch. If provided, this will be added to trainer_params. Translates to <code>limit_train_batches</code> in PyTorch Lightning Trainer. See relevant documentation for more details.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>encoder_conv_strides</code> </td> <td> <code><span title=tuple>tuple</span>[<span title=int>int</span>, ...]</code> </td> <td> <div class=doc-md-description> <p>Strides for the encoder convolutional layers, by default (2, 2).</p> </div> </td> <td> <code>(2, 2)</code> </td> </tr> <tr class=doc-section-item> <td> <code>decoder_conv_strides</code> </td> <td> <code><span title=tuple>tuple</span>[<span title=int>int</span>, ...]</code> </td> <td> <div class=doc-md-description> <p>Strides for the decoder convolutional layers, by default (2, 2).</p> </div> </td> <td> <code>(2, 2)</code> </td> </tr> <tr class=doc-section-item> <td> <code>multiscale_count</code> </td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>Number of scales in the multiscale architecture, by default 1.</p> </div> </td> <td> <code>1</code> </td> </tr> <tr class=doc-section-item> <td> <code>z_dims</code> </td> <td> <code><span title=tuple>tuple</span>[<span title=int>int</span>, ...]</code> </td> <td> <div class=doc-md-description> <p>Dimensions of the latent space, by default (128, 128).</p> </div> </td> <td> <code>(128, 128)</code> </td> </tr> <tr class=doc-section-item> <td> <code>output_channels</code> </td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>Number of output channels, by default 1.</p> </div> </td> <td> <code>1</code> </td> </tr> <tr class=doc-section-item> <td> <code>encoder_n_filters</code> </td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>Number of filters in the encoder, by default 32.</p> </div> </td> <td> <code>32</code> </td> </tr> <tr class=doc-section-item> <td> <code>decoder_n_filters</code> </td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>Number of filters in the decoder, by default 32.</p> </div> </td> <td> <code>32</code> </td> </tr> <tr class=doc-section-item> <td> <code>encoder_dropout</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>Dropout rate for the encoder, by default 0.0.</p> </div> </td> <td> <code>0.0</code> </td> </tr> <tr class=doc-section-item> <td> <code>decoder_dropout</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>Dropout rate for the decoder, by default 0.0.</p> </div> </td> <td> <code>0.0</code> </td> </tr> <tr class=doc-section-item> <td> <code>nonlinearity</code> </td> <td> <code><span title=typing.Literal>Literal</span></code> </td> <td> <div class=doc-md-description> <p>Nonlinearity function to use, by default "ReLU".</p> </div> </td> <td> <code>&#39;ReLU&#39;</code> </td> </tr> <tr class=doc-section-item> <td> <code>analytical_kl</code> </td> <td> <code><span title=bool>bool</span></code> </td> <td> <div class=doc-md-description> <p>Whether to use analytical KL divergence, by default False.</p> </div> </td> <td> <code>False</code> </td> </tr> <tr class=doc-section-item> <td> <code>predict_logvar</code> </td> <td> <code><span title=typing.Literal>Literal</span>[None, &#39;pixelwise&#39;]</code> </td> <td> <div class=doc-md-description> <p>Type of log variance prediction, by default None.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>logvar_lowerbound</code> </td> <td> <code><span title=typing.Union>Union</span>[<span title=float>float</span>, None]</code> </td> <td> <div class=doc-md-description> <p>Lower bound for the log variance, by default None.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>logger</code> </td> <td> <code><span title=typing.Literal>Literal</span>[&#39;wandb&#39;, &#39;tensorboard&#39;, &#39;none&#39;]</code> </td> <td> <div class=doc-md-description> <p>Logger to use for training, by default "none".</p> </div> </td> <td> <code>&#39;none&#39;</code> </td> </tr> <tr class=doc-section-item> <td> <code>trainer_params</code> </td> <td> <code><span title=dict>dict</span></code> </td> <td> <div class=doc-md-description> <p>Parameters for the trainer class, see PyTorch Lightning documentation.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>augmentations</code> </td> <td> <code><span title=Optional>Optional</span>[<span title=list>list</span>[<span title=typing.Union>Union</span>[<a class="autorefs autorefs-internal" title="XYFlipModel (careamics.config.transformations.XYFlipModel)" href=../transformations/xy_flip_model/#careamics.config.transformations.xy_flip_model.XYFlipModel>XYFlipModel</a>, <a class="autorefs autorefs-internal" title="XYRandomRotate90Model (careamics.config.transformations.XYRandomRotate90Model)" href=../transformations/xy_random_rotate90_model/#careamics.config.transformations.xy_random_rotate90_model.XYRandomRotate90Model>XYRandomRotate90Model</a>]]]</code> </td> <td> <div class=doc-md-description> <p>List of augmentations to apply, by default None.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>train_dataloader_params</code> </td> <td> <code><span title=Optional>Optional</span>[<span title=dict>dict</span>[<span title=str>str</span>, <span title=typing.Any>Any</span>]]</code> </td> <td> <div class=doc-md-description> <p>Parameters for the training dataloader, by default None.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>val_dataloader_params</code> </td> <td> <code><span title=Optional>Optional</span>[<span title=dict>dict</span>[<span title=str>str</span>, <span title=typing.Any>Any</span>]]</code> </td> <td> <div class=doc-md-description> <p>Parameters for the validation dataloader, by default None.</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-internal" title="Configuration (careamics.config.configuration.Configuration)" href=../configuration/#careamics.config.configuration.Configuration>Configuration</a></code> </td> <td> <div class=doc-md-description> <p>The configuration object for training HDN.</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Examples:</span></p> <p>Minimum example:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>config</span> <span class=o>=</span> <span class=n>create_hdn_configuration</span><span class=p>(</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=gp>... </span>    <span class=n>experiment_name</span><span class=o>=</span><span class=s2>&quot;hdn_experiment&quot;</span><span class=p>,</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=gp>... </span>    <span class=n>data_type</span><span class=o>=</span><span class=s2>&quot;array&quot;</span><span class=p>,</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=gp>... </span>    <span class=n>axes</span><span class=o>=</span><span class=s2>&quot;YX&quot;</span><span class=p>,</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=gp>... </span>    <span class=n>patch_size</span><span class=o>=</span><span class=p>[</span><span class=mi>64</span><span class=p>,</span> <span class=mi>64</span><span class=p>],</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=gp>... </span>    <span class=n>batch_size</span><span class=o>=</span><span class=mi>32</span><span class=p>,</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=gp>... </span>    <span class=n>num_epochs</span><span class=o>=</span><span class=mi>100</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a><span class=gp>... </span><span class=p>)</span>
</span></code></pre></div> <p>You can also limit the number of batches per epoch:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>config</span> <span class=o>=</span> <span class=n>create_hdn_configuration</span><span class=p>(</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=gp>... </span>    <span class=n>experiment_name</span><span class=o>=</span><span class=s2>&quot;hdn_experiment&quot;</span><span class=p>,</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=gp>... </span>    <span class=n>data_type</span><span class=o>=</span><span class=s2>&quot;array&quot;</span><span class=p>,</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=gp>... </span>    <span class=n>axes</span><span class=o>=</span><span class=s2>&quot;YX&quot;</span><span class=p>,</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=gp>... </span>    <span class=n>patch_size</span><span class=o>=</span><span class=p>[</span><span class=mi>64</span><span class=p>,</span> <span class=mi>64</span><span class=p>],</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=gp>... </span>    <span class=n>batch_size</span><span class=o>=</span><span class=mi>32</span><span class=p>,</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=gp>... </span>    <span class=n>num_steps</span><span class=o>=</span><span class=mi>100</span>  <span class=c1># limit to 100 batches per epoch</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a><span class=gp>... </span><span class=p>)</span>
</span></code></pre></div> <details class=quote> <summary>Source code in <code>src/careamics/config/configuration_factories.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-1693>1693</a></span>
<span class=normal><a href=#__codelineno-0-1694>1694</a></span>
<span class=normal><a href=#__codelineno-0-1695>1695</a></span>
<span class=normal><a href=#__codelineno-0-1696>1696</a></span>
<span class=normal><a href=#__codelineno-0-1697>1697</a></span>
<span class=normal><a href=#__codelineno-0-1698>1698</a></span>
<span class=normal><a href=#__codelineno-0-1699>1699</a></span>
<span class=normal><a href=#__codelineno-0-1700>1700</a></span>
<span class=normal><a href=#__codelineno-0-1701>1701</a></span>
<span class=normal><a href=#__codelineno-0-1702>1702</a></span>
<span class=normal><a href=#__codelineno-0-1703>1703</a></span>
<span class=normal><a href=#__codelineno-0-1704>1704</a></span>
<span class=normal><a href=#__codelineno-0-1705>1705</a></span>
<span class=normal><a href=#__codelineno-0-1706>1706</a></span>
<span class=normal><a href=#__codelineno-0-1707>1707</a></span>
<span class=normal><a href=#__codelineno-0-1708>1708</a></span>
<span class=normal><a href=#__codelineno-0-1709>1709</a></span>
<span class=normal><a href=#__codelineno-0-1710>1710</a></span>
<span class=normal><a href=#__codelineno-0-1711>1711</a></span>
<span class=normal><a href=#__codelineno-0-1712>1712</a></span>
<span class=normal><a href=#__codelineno-0-1713>1713</a></span>
<span class=normal><a href=#__codelineno-0-1714>1714</a></span>
<span class=normal><a href=#__codelineno-0-1715>1715</a></span>
<span class=normal><a href=#__codelineno-0-1716>1716</a></span>
<span class=normal><a href=#__codelineno-0-1717>1717</a></span>
<span class=normal><a href=#__codelineno-0-1718>1718</a></span>
<span class=normal><a href=#__codelineno-0-1719>1719</a></span>
<span class=normal><a href=#__codelineno-0-1720>1720</a></span>
<span class=normal><a href=#__codelineno-0-1721>1721</a></span>
<span class=normal><a href=#__codelineno-0-1722>1722</a></span>
<span class=normal><a href=#__codelineno-0-1723>1723</a></span>
<span class=normal><a href=#__codelineno-0-1724>1724</a></span>
<span class=normal><a href=#__codelineno-0-1725>1725</a></span>
<span class=normal><a href=#__codelineno-0-1726>1726</a></span>
<span class=normal><a href=#__codelineno-0-1727>1727</a></span>
<span class=normal><a href=#__codelineno-0-1728>1728</a></span>
<span class=normal><a href=#__codelineno-0-1729>1729</a></span>
<span class=normal><a href=#__codelineno-0-1730>1730</a></span>
<span class=normal><a href=#__codelineno-0-1731>1731</a></span>
<span class=normal><a href=#__codelineno-0-1732>1732</a></span>
<span class=normal><a href=#__codelineno-0-1733>1733</a></span>
<span class=normal><a href=#__codelineno-0-1734>1734</a></span>
<span class=normal><a href=#__codelineno-0-1735>1735</a></span>
<span class=normal><a href=#__codelineno-0-1736>1736</a></span>
<span class=normal><a href=#__codelineno-0-1737>1737</a></span>
<span class=normal><a href=#__codelineno-0-1738>1738</a></span>
<span class=normal><a href=#__codelineno-0-1739>1739</a></span>
<span class=normal><a href=#__codelineno-0-1740>1740</a></span>
<span class=normal><a href=#__codelineno-0-1741>1741</a></span>
<span class=normal><a href=#__codelineno-0-1742>1742</a></span>
<span class=normal><a href=#__codelineno-0-1743>1743</a></span>
<span class=normal><a href=#__codelineno-0-1744>1744</a></span>
<span class=normal><a href=#__codelineno-0-1745>1745</a></span>
<span class=normal><a href=#__codelineno-0-1746>1746</a></span>
<span class=normal><a href=#__codelineno-0-1747>1747</a></span>
<span class=normal><a href=#__codelineno-0-1748>1748</a></span>
<span class=normal><a href=#__codelineno-0-1749>1749</a></span>
<span class=normal><a href=#__codelineno-0-1750>1750</a></span>
<span class=normal><a href=#__codelineno-0-1751>1751</a></span>
<span class=normal><a href=#__codelineno-0-1752>1752</a></span>
<span class=normal><a href=#__codelineno-0-1753>1753</a></span>
<span class=normal><a href=#__codelineno-0-1754>1754</a></span>
<span class=normal><a href=#__codelineno-0-1755>1755</a></span>
<span class=normal><a href=#__codelineno-0-1756>1756</a></span>
<span class=normal><a href=#__codelineno-0-1757>1757</a></span>
<span class=normal><a href=#__codelineno-0-1758>1758</a></span>
<span class=normal><a href=#__codelineno-0-1759>1759</a></span>
<span class=normal><a href=#__codelineno-0-1760>1760</a></span>
<span class=normal><a href=#__codelineno-0-1761>1761</a></span>
<span class=normal><a href=#__codelineno-0-1762>1762</a></span>
<span class=normal><a href=#__codelineno-0-1763>1763</a></span>
<span class=normal><a href=#__codelineno-0-1764>1764</a></span>
<span class=normal><a href=#__codelineno-0-1765>1765</a></span>
<span class=normal><a href=#__codelineno-0-1766>1766</a></span>
<span class=normal><a href=#__codelineno-0-1767>1767</a></span>
<span class=normal><a href=#__codelineno-0-1768>1768</a></span>
<span class=normal><a href=#__codelineno-0-1769>1769</a></span>
<span class=normal><a href=#__codelineno-0-1770>1770</a></span>
<span class=normal><a href=#__codelineno-0-1771>1771</a></span>
<span class=normal><a href=#__codelineno-0-1772>1772</a></span>
<span class=normal><a href=#__codelineno-0-1773>1773</a></span>
<span class=normal><a href=#__codelineno-0-1774>1774</a></span>
<span class=normal><a href=#__codelineno-0-1775>1775</a></span>
<span class=normal><a href=#__codelineno-0-1776>1776</a></span>
<span class=normal><a href=#__codelineno-0-1777>1777</a></span>
<span class=normal><a href=#__codelineno-0-1778>1778</a></span>
<span class=normal><a href=#__codelineno-0-1779>1779</a></span>
<span class=normal><a href=#__codelineno-0-1780>1780</a></span>
<span class=normal><a href=#__codelineno-0-1781>1781</a></span>
<span class=normal><a href=#__codelineno-0-1782>1782</a></span>
<span class=normal><a href=#__codelineno-0-1783>1783</a></span>
<span class=normal><a href=#__codelineno-0-1784>1784</a></span>
<span class=normal><a href=#__codelineno-0-1785>1785</a></span>
<span class=normal><a href=#__codelineno-0-1786>1786</a></span>
<span class=normal><a href=#__codelineno-0-1787>1787</a></span>
<span class=normal><a href=#__codelineno-0-1788>1788</a></span>
<span class=normal><a href=#__codelineno-0-1789>1789</a></span>
<span class=normal><a href=#__codelineno-0-1790>1790</a></span>
<span class=normal><a href=#__codelineno-0-1791>1791</a></span>
<span class=normal><a href=#__codelineno-0-1792>1792</a></span>
<span class=normal><a href=#__codelineno-0-1793>1793</a></span>
<span class=normal><a href=#__codelineno-0-1794>1794</a></span>
<span class=normal><a href=#__codelineno-0-1795>1795</a></span>
<span class=normal><a href=#__codelineno-0-1796>1796</a></span>
<span class=normal><a href=#__codelineno-0-1797>1797</a></span>
<span class=normal><a href=#__codelineno-0-1798>1798</a></span>
<span class=normal><a href=#__codelineno-0-1799>1799</a></span>
<span class=normal><a href=#__codelineno-0-1800>1800</a></span>
<span class=normal><a href=#__codelineno-0-1801>1801</a></span>
<span class=normal><a href=#__codelineno-0-1802>1802</a></span>
<span class=normal><a href=#__codelineno-0-1803>1803</a></span>
<span class=normal><a href=#__codelineno-0-1804>1804</a></span>
<span class=normal><a href=#__codelineno-0-1805>1805</a></span>
<span class=normal><a href=#__codelineno-0-1806>1806</a></span>
<span class=normal><a href=#__codelineno-0-1807>1807</a></span>
<span class=normal><a href=#__codelineno-0-1808>1808</a></span>
<span class=normal><a href=#__codelineno-0-1809>1809</a></span>
<span class=normal><a href=#__codelineno-0-1810>1810</a></span>
<span class=normal><a href=#__codelineno-0-1811>1811</a></span>
<span class=normal><a href=#__codelineno-0-1812>1812</a></span>
<span class=normal><a href=#__codelineno-0-1813>1813</a></span>
<span class=normal><a href=#__codelineno-0-1814>1814</a></span>
<span class=normal><a href=#__codelineno-0-1815>1815</a></span>
<span class=normal><a href=#__codelineno-0-1816>1816</a></span>
<span class=normal><a href=#__codelineno-0-1817>1817</a></span>
<span class=normal><a href=#__codelineno-0-1818>1818</a></span>
<span class=normal><a href=#__codelineno-0-1819>1819</a></span>
<span class=normal><a href=#__codelineno-0-1820>1820</a></span>
<span class=normal><a href=#__codelineno-0-1821>1821</a></span>
<span class=normal><a href=#__codelineno-0-1822>1822</a></span>
<span class=normal><a href=#__codelineno-0-1823>1823</a></span>
<span class=normal><a href=#__codelineno-0-1824>1824</a></span>
<span class=normal><a href=#__codelineno-0-1825>1825</a></span>
<span class=normal><a href=#__codelineno-0-1826>1826</a></span>
<span class=normal><a href=#__codelineno-0-1827>1827</a></span>
<span class=normal><a href=#__codelineno-0-1828>1828</a></span>
<span class=normal><a href=#__codelineno-0-1829>1829</a></span>
<span class=normal><a href=#__codelineno-0-1830>1830</a></span>
<span class=normal><a href=#__codelineno-0-1831>1831</a></span>
<span class=normal><a href=#__codelineno-0-1832>1832</a></span>
<span class=normal><a href=#__codelineno-0-1833>1833</a></span>
<span class=normal><a href=#__codelineno-0-1834>1834</a></span>
<span class=normal><a href=#__codelineno-0-1835>1835</a></span>
<span class=normal><a href=#__codelineno-0-1836>1836</a></span>
<span class=normal><a href=#__codelineno-0-1837>1837</a></span>
<span class=normal><a href=#__codelineno-0-1838>1838</a></span>
<span class=normal><a href=#__codelineno-0-1839>1839</a></span>
<span class=normal><a href=#__codelineno-0-1840>1840</a></span>
<span class=normal><a href=#__codelineno-0-1841>1841</a></span>
<span class=normal><a href=#__codelineno-0-1842>1842</a></span>
<span class=normal><a href=#__codelineno-0-1843>1843</a></span>
<span class=normal><a href=#__codelineno-0-1844>1844</a></span>
<span class=normal><a href=#__codelineno-0-1845>1845</a></span>
<span class=normal><a href=#__codelineno-0-1846>1846</a></span>
<span class=normal><a href=#__codelineno-0-1847>1847</a></span>
<span class=normal><a href=#__codelineno-0-1848>1848</a></span>
<span class=normal><a href=#__codelineno-0-1849>1849</a></span>
<span class=normal><a href=#__codelineno-0-1850>1850</a></span>
<span class=normal><a href=#__codelineno-0-1851>1851</a></span>
<span class=normal><a href=#__codelineno-0-1852>1852</a></span>
<span class=normal><a href=#__codelineno-0-1853>1853</a></span>
<span class=normal><a href=#__codelineno-0-1854>1854</a></span>
<span class=normal><a href=#__codelineno-0-1855>1855</a></span>
<span class=normal><a href=#__codelineno-0-1856>1856</a></span>
<span class=normal><a href=#__codelineno-0-1857>1857</a></span>
<span class=normal><a href=#__codelineno-0-1858>1858</a></span>
<span class=normal><a href=#__codelineno-0-1859>1859</a></span>
<span class=normal><a href=#__codelineno-0-1860>1860</a></span>
<span class=normal><a href=#__codelineno-0-1861>1861</a></span>
<span class=normal><a href=#__codelineno-0-1862>1862</a></span>
<span class=normal><a href=#__codelineno-0-1863>1863</a></span>
<span class=normal><a href=#__codelineno-0-1864>1864</a></span>
<span class=normal><a href=#__codelineno-0-1865>1865</a></span>
<span class=normal><a href=#__codelineno-0-1866>1866</a></span>
<span class=normal><a href=#__codelineno-0-1867>1867</a></span>
<span class=normal><a href=#__codelineno-0-1868>1868</a></span>
<span class=normal><a href=#__codelineno-0-1869>1869</a></span>
<span class=normal><a href=#__codelineno-0-1870>1870</a></span>
<span class=normal><a href=#__codelineno-0-1871>1871</a></span>
<span class=normal><a href=#__codelineno-0-1872>1872</a></span>
<span class=normal><a href=#__codelineno-0-1873>1873</a></span>
<span class=normal><a href=#__codelineno-0-1874>1874</a></span>
<span class=normal><a href=#__codelineno-0-1875>1875</a></span>
<span class=normal><a href=#__codelineno-0-1876>1876</a></span>
<span class=normal><a href=#__codelineno-0-1877>1877</a></span>
<span class=normal><a href=#__codelineno-0-1878>1878</a></span>
<span class=normal><a href=#__codelineno-0-1879>1879</a></span>
<span class=normal><a href=#__codelineno-0-1880>1880</a></span>
<span class=normal><a href=#__codelineno-0-1881>1881</a></span>
<span class=normal><a href=#__codelineno-0-1882>1882</a></span>
<span class=normal><a href=#__codelineno-0-1883>1883</a></span>
<span class=normal><a href=#__codelineno-0-1884>1884</a></span>
<span class=normal><a href=#__codelineno-0-1885>1885</a></span>
<span class=normal><a href=#__codelineno-0-1886>1886</a></span>
<span class=normal><a href=#__codelineno-0-1887>1887</a></span>
<span class=normal><a href=#__codelineno-0-1888>1888</a></span>
<span class=normal><a href=#__codelineno-0-1889>1889</a></span>
<span class=normal><a href=#__codelineno-0-1890>1890</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-1693><a id=__codelineno-0-1693 name=__codelineno-0-1693></a><span class=k>def</span><span class=w> </span><span class=nf>create_hdn_configuration</span><span class=p>(</span>
</span><span id=__span-0-1694><a id=__codelineno-0-1694 name=__codelineno-0-1694></a>    <span class=n>experiment_name</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span><span id=__span-0-1695><a id=__codelineno-0-1695 name=__codelineno-0-1695></a>    <span class=n>data_type</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span><span class=s2>&quot;array&quot;</span><span class=p>,</span> <span class=s2>&quot;tiff&quot;</span><span class=p>,</span> <span class=s2>&quot;custom&quot;</span><span class=p>],</span>
</span><span id=__span-0-1696><a id=__codelineno-0-1696 name=__codelineno-0-1696></a>    <span class=n>axes</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span><span id=__span-0-1697><a id=__codelineno-0-1697 name=__codelineno-0-1697></a>    <span class=n>patch_size</span><span class=p>:</span> <span class=n>Sequence</span><span class=p>[</span><span class=nb>int</span><span class=p>],</span>
</span><span id=__span-0-1698><a id=__codelineno-0-1698 name=__codelineno-0-1698></a>    <span class=n>batch_size</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-1699><a id=__codelineno-0-1699 name=__codelineno-0-1699></a>    <span class=n>num_epochs</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>100</span><span class=p>,</span>
</span><span id=__span-0-1700><a id=__codelineno-0-1700 name=__codelineno-0-1700></a>    <span class=n>num_steps</span><span class=p>:</span> <span class=nb>int</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-1701><a id=__codelineno-0-1701 name=__codelineno-0-1701></a>    <span class=n>encoder_conv_strides</span><span class=p>:</span> <span class=nb>tuple</span><span class=p>[</span><span class=nb>int</span><span class=p>,</span> <span class=o>...</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>),</span>
</span><span id=__span-0-1702><a id=__codelineno-0-1702 name=__codelineno-0-1702></a>    <span class=n>decoder_conv_strides</span><span class=p>:</span> <span class=nb>tuple</span><span class=p>[</span><span class=nb>int</span><span class=p>,</span> <span class=o>...</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>),</span>
</span><span id=__span-0-1703><a id=__codelineno-0-1703 name=__codelineno-0-1703></a>    <span class=n>multiscale_count</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
</span><span id=__span-0-1704><a id=__codelineno-0-1704 name=__codelineno-0-1704></a>    <span class=n>z_dims</span><span class=p>:</span> <span class=nb>tuple</span><span class=p>[</span><span class=nb>int</span><span class=p>,</span> <span class=o>...</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=mi>128</span><span class=p>,</span> <span class=mi>128</span><span class=p>),</span>
</span><span id=__span-0-1705><a id=__codelineno-0-1705 name=__codelineno-0-1705></a>    <span class=n>output_channels</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
</span><span id=__span-0-1706><a id=__codelineno-0-1706 name=__codelineno-0-1706></a>    <span class=n>encoder_n_filters</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>32</span><span class=p>,</span>
</span><span id=__span-0-1707><a id=__codelineno-0-1707 name=__codelineno-0-1707></a>    <span class=n>decoder_n_filters</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>32</span><span class=p>,</span>
</span><span id=__span-0-1708><a id=__codelineno-0-1708 name=__codelineno-0-1708></a>    <span class=n>encoder_dropout</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
</span><span id=__span-0-1709><a id=__codelineno-0-1709 name=__codelineno-0-1709></a>    <span class=n>decoder_dropout</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
</span><span id=__span-0-1710><a id=__codelineno-0-1710 name=__codelineno-0-1710></a>    <span class=n>nonlinearity</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span>
</span><span id=__span-0-1711><a id=__codelineno-0-1711 name=__codelineno-0-1711></a>        <span class=s2>&quot;None&quot;</span><span class=p>,</span> <span class=s2>&quot;Sigmoid&quot;</span><span class=p>,</span> <span class=s2>&quot;Softmax&quot;</span><span class=p>,</span> <span class=s2>&quot;Tanh&quot;</span><span class=p>,</span> <span class=s2>&quot;ReLU&quot;</span><span class=p>,</span> <span class=s2>&quot;LeakyReLU&quot;</span><span class=p>,</span> <span class=s2>&quot;ELU&quot;</span>
</span><span id=__span-0-1712><a id=__codelineno-0-1712 name=__codelineno-0-1712></a>    <span class=p>]</span> <span class=o>=</span> <span class=s2>&quot;ReLU&quot;</span><span class=p>,</span>
</span><span id=__span-0-1713><a id=__codelineno-0-1713 name=__codelineno-0-1713></a>    <span class=n>analytical_kl</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-0-1714><a id=__codelineno-0-1714 name=__codelineno-0-1714></a>    <span class=n>predict_logvar</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span><span class=s2>&quot;pixelwise&quot;</span><span class=p>]</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-1715><a id=__codelineno-0-1715 name=__codelineno-0-1715></a>    <span class=n>logvar_lowerbound</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=kc>None</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-1716><a id=__codelineno-0-1716 name=__codelineno-0-1716></a>    <span class=n>logger</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span><span class=s2>&quot;wandb&quot;</span><span class=p>,</span> <span class=s2>&quot;tensorboard&quot;</span><span class=p>,</span> <span class=s2>&quot;none&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=s2>&quot;none&quot;</span><span class=p>,</span>
</span><span id=__span-0-1717><a id=__codelineno-0-1717 name=__codelineno-0-1717></a>    <span class=n>trainer_params</span><span class=p>:</span> <span class=nb>dict</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-1718><a id=__codelineno-0-1718 name=__codelineno-0-1718></a>    <span class=n>augmentations</span><span class=p>:</span> <span class=nb>list</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=n>XYFlipModel</span><span class=p>,</span> <span class=n>XYRandomRotate90Model</span><span class=p>]]</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-1719><a id=__codelineno-0-1719 name=__codelineno-0-1719></a>    <span class=n>train_dataloader_params</span><span class=p>:</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-1720><a id=__codelineno-0-1720 name=__codelineno-0-1720></a>    <span class=n>val_dataloader_params</span><span class=p>:</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-1721><a id=__codelineno-0-1721 name=__codelineno-0-1721></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Configuration</span><span class=p>:</span>
</span><span id=__span-0-1722><a id=__codelineno-0-1722 name=__codelineno-0-1722></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-1723><a id=__codelineno-0-1723 name=__codelineno-0-1723></a><span class=sd>    Create a configuration for training HDN.</span>
</span><span id=__span-0-1724><a id=__codelineno-0-1724 name=__codelineno-0-1724></a>
</span><span id=__span-0-1725><a id=__codelineno-0-1725 name=__codelineno-0-1725></a><span class=sd>    If &quot;Z&quot; is present in `axes`, then `path_size` must be a list of length 3, otherwise</span>
</span><span id=__span-0-1726><a id=__codelineno-0-1726 name=__codelineno-0-1726></a><span class=sd>    2.</span>
</span><span id=__span-0-1727><a id=__codelineno-0-1727 name=__codelineno-0-1727></a>
</span><span id=__span-0-1728><a id=__codelineno-0-1728 name=__codelineno-0-1728></a><span class=sd>    If &quot;C&quot; is present in `axes`, then you need to set `n_channels_in` to the number of</span>
</span><span id=__span-0-1729><a id=__codelineno-0-1729 name=__codelineno-0-1729></a><span class=sd>    channels. Likewise, if you set the number of channels, then &quot;C&quot; must be present in</span>
</span><span id=__span-0-1730><a id=__codelineno-0-1730 name=__codelineno-0-1730></a><span class=sd>    `axes`.</span>
</span><span id=__span-0-1731><a id=__codelineno-0-1731 name=__codelineno-0-1731></a>
</span><span id=__span-0-1732><a id=__codelineno-0-1732 name=__codelineno-0-1732></a><span class=sd>    To set the number of output channels, use the `n_channels_out` parameter. If it is</span>
</span><span id=__span-0-1733><a id=__codelineno-0-1733 name=__codelineno-0-1733></a><span class=sd>    not specified, it will be assumed to be equal to `n_channels_in`.</span>
</span><span id=__span-0-1734><a id=__codelineno-0-1734 name=__codelineno-0-1734></a>
</span><span id=__span-0-1735><a id=__codelineno-0-1735 name=__codelineno-0-1735></a><span class=sd>    By default, all channels are trained independently. To train all channels together,</span>
</span><span id=__span-0-1736><a id=__codelineno-0-1736 name=__codelineno-0-1736></a><span class=sd>    set `independent_channels` to False.</span>
</span><span id=__span-0-1737><a id=__codelineno-0-1737 name=__codelineno-0-1737></a>
</span><span id=__span-0-1738><a id=__codelineno-0-1738 name=__codelineno-0-1738></a><span class=sd>    By setting `augmentations` to `None`, the default transformations (flip in X and Y,</span>
</span><span id=__span-0-1739><a id=__codelineno-0-1739 name=__codelineno-0-1739></a><span class=sd>    rotations by 90 degrees in the XY plane) are applied. Rather than the default</span>
</span><span id=__span-0-1740><a id=__codelineno-0-1740 name=__codelineno-0-1740></a><span class=sd>    transforms, a list of transforms can be passed to the `augmentations` parameter. To</span>
</span><span id=__span-0-1741><a id=__codelineno-0-1741 name=__codelineno-0-1741></a><span class=sd>    disable the transforms, simply pass an empty list.</span>
</span><span id=__span-0-1742><a id=__codelineno-0-1742 name=__codelineno-0-1742></a>
</span><span id=__span-0-1743><a id=__codelineno-0-1743 name=__codelineno-0-1743></a><span class=sd>    # TODO revisit the necessity of model_params</span>
</span><span id=__span-0-1744><a id=__codelineno-0-1744 name=__codelineno-0-1744></a>
</span><span id=__span-0-1745><a id=__codelineno-0-1745 name=__codelineno-0-1745></a><span class=sd>    Parameters</span>
</span><span id=__span-0-1746><a id=__codelineno-0-1746 name=__codelineno-0-1746></a><span class=sd>    ----------</span>
</span><span id=__span-0-1747><a id=__codelineno-0-1747 name=__codelineno-0-1747></a><span class=sd>    experiment_name : str</span>
</span><span id=__span-0-1748><a id=__codelineno-0-1748 name=__codelineno-0-1748></a><span class=sd>        Name of the experiment.</span>
</span><span id=__span-0-1749><a id=__codelineno-0-1749 name=__codelineno-0-1749></a><span class=sd>    data_type : Literal[&quot;array&quot;, &quot;tiff&quot;, &quot;custom&quot;]</span>
</span><span id=__span-0-1750><a id=__codelineno-0-1750 name=__codelineno-0-1750></a><span class=sd>        Type of the data.</span>
</span><span id=__span-0-1751><a id=__codelineno-0-1751 name=__codelineno-0-1751></a><span class=sd>    axes : str</span>
</span><span id=__span-0-1752><a id=__codelineno-0-1752 name=__codelineno-0-1752></a><span class=sd>        Axes of the data (e.g. SYX).</span>
</span><span id=__span-0-1753><a id=__codelineno-0-1753 name=__codelineno-0-1753></a><span class=sd>    patch_size : List[int]</span>
</span><span id=__span-0-1754><a id=__codelineno-0-1754 name=__codelineno-0-1754></a><span class=sd>        Size of the patches along the spatial dimensions (e.g. [64, 64]).</span>
</span><span id=__span-0-1755><a id=__codelineno-0-1755 name=__codelineno-0-1755></a><span class=sd>    batch_size : int</span>
</span><span id=__span-0-1756><a id=__codelineno-0-1756 name=__codelineno-0-1756></a><span class=sd>        Batch size.</span>
</span><span id=__span-0-1757><a id=__codelineno-0-1757 name=__codelineno-0-1757></a><span class=sd>    num_epochs : int, default=100</span>
</span><span id=__span-0-1758><a id=__codelineno-0-1758 name=__codelineno-0-1758></a><span class=sd>        Number of epochs to train for. If provided, this will be added to</span>
</span><span id=__span-0-1759><a id=__codelineno-0-1759 name=__codelineno-0-1759></a><span class=sd>        trainer_params.</span>
</span><span id=__span-0-1760><a id=__codelineno-0-1760 name=__codelineno-0-1760></a><span class=sd>    num_steps : int, optional</span>
</span><span id=__span-0-1761><a id=__codelineno-0-1761 name=__codelineno-0-1761></a><span class=sd>        Number of batches in 1 epoch. If provided, this will be added to trainer_params.</span>
</span><span id=__span-0-1762><a id=__codelineno-0-1762 name=__codelineno-0-1762></a><span class=sd>        Translates to `limit_train_batches` in PyTorch Lightning Trainer. See relevant</span>
</span><span id=__span-0-1763><a id=__codelineno-0-1763 name=__codelineno-0-1763></a><span class=sd>        documentation for more details.</span>
</span><span id=__span-0-1764><a id=__codelineno-0-1764 name=__codelineno-0-1764></a><span class=sd>    encoder_conv_strides : tuple[int, ...], optional</span>
</span><span id=__span-0-1765><a id=__codelineno-0-1765 name=__codelineno-0-1765></a><span class=sd>        Strides for the encoder convolutional layers, by default (2, 2).</span>
</span><span id=__span-0-1766><a id=__codelineno-0-1766 name=__codelineno-0-1766></a><span class=sd>    decoder_conv_strides : tuple[int, ...], optional</span>
</span><span id=__span-0-1767><a id=__codelineno-0-1767 name=__codelineno-0-1767></a><span class=sd>        Strides for the decoder convolutional layers, by default (2, 2).</span>
</span><span id=__span-0-1768><a id=__codelineno-0-1768 name=__codelineno-0-1768></a><span class=sd>    multiscale_count : int, optional</span>
</span><span id=__span-0-1769><a id=__codelineno-0-1769 name=__codelineno-0-1769></a><span class=sd>        Number of scales in the multiscale architecture, by default 1.</span>
</span><span id=__span-0-1770><a id=__codelineno-0-1770 name=__codelineno-0-1770></a><span class=sd>    z_dims : tuple[int, ...], optional</span>
</span><span id=__span-0-1771><a id=__codelineno-0-1771 name=__codelineno-0-1771></a><span class=sd>        Dimensions of the latent space, by default (128, 128).</span>
</span><span id=__span-0-1772><a id=__codelineno-0-1772 name=__codelineno-0-1772></a><span class=sd>    output_channels : int, optional</span>
</span><span id=__span-0-1773><a id=__codelineno-0-1773 name=__codelineno-0-1773></a><span class=sd>        Number of output channels, by default 1.</span>
</span><span id=__span-0-1774><a id=__codelineno-0-1774 name=__codelineno-0-1774></a><span class=sd>    encoder_n_filters : int, optional</span>
</span><span id=__span-0-1775><a id=__codelineno-0-1775 name=__codelineno-0-1775></a><span class=sd>        Number of filters in the encoder, by default 32.</span>
</span><span id=__span-0-1776><a id=__codelineno-0-1776 name=__codelineno-0-1776></a><span class=sd>    decoder_n_filters : int, optional</span>
</span><span id=__span-0-1777><a id=__codelineno-0-1777 name=__codelineno-0-1777></a><span class=sd>        Number of filters in the decoder, by default 32.</span>
</span><span id=__span-0-1778><a id=__codelineno-0-1778 name=__codelineno-0-1778></a><span class=sd>    encoder_dropout : float, optional</span>
</span><span id=__span-0-1779><a id=__codelineno-0-1779 name=__codelineno-0-1779></a><span class=sd>        Dropout rate for the encoder, by default 0.0.</span>
</span><span id=__span-0-1780><a id=__codelineno-0-1780 name=__codelineno-0-1780></a><span class=sd>    decoder_dropout : float, optional</span>
</span><span id=__span-0-1781><a id=__codelineno-0-1781 name=__codelineno-0-1781></a><span class=sd>        Dropout rate for the decoder, by default 0.0.</span>
</span><span id=__span-0-1782><a id=__codelineno-0-1782 name=__codelineno-0-1782></a><span class=sd>    nonlinearity : Literal, optional</span>
</span><span id=__span-0-1783><a id=__codelineno-0-1783 name=__codelineno-0-1783></a><span class=sd>        Nonlinearity function to use, by default &quot;ReLU&quot;.</span>
</span><span id=__span-0-1784><a id=__codelineno-0-1784 name=__codelineno-0-1784></a><span class=sd>    analytical_kl : bool, optional</span>
</span><span id=__span-0-1785><a id=__codelineno-0-1785 name=__codelineno-0-1785></a><span class=sd>        Whether to use analytical KL divergence, by default False.</span>
</span><span id=__span-0-1786><a id=__codelineno-0-1786 name=__codelineno-0-1786></a><span class=sd>    predict_logvar : Literal[None, &quot;pixelwise&quot;], optional</span>
</span><span id=__span-0-1787><a id=__codelineno-0-1787 name=__codelineno-0-1787></a><span class=sd>        Type of log variance prediction, by default None.</span>
</span><span id=__span-0-1788><a id=__codelineno-0-1788 name=__codelineno-0-1788></a><span class=sd>    logvar_lowerbound : Union[float, None], optional</span>
</span><span id=__span-0-1789><a id=__codelineno-0-1789 name=__codelineno-0-1789></a><span class=sd>        Lower bound for the log variance, by default None.</span>
</span><span id=__span-0-1790><a id=__codelineno-0-1790 name=__codelineno-0-1790></a><span class=sd>    logger : Literal[&quot;wandb&quot;, &quot;tensorboard&quot;, &quot;none&quot;], optional</span>
</span><span id=__span-0-1791><a id=__codelineno-0-1791 name=__codelineno-0-1791></a><span class=sd>        Logger to use for training, by default &quot;none&quot;.</span>
</span><span id=__span-0-1792><a id=__codelineno-0-1792 name=__codelineno-0-1792></a><span class=sd>    trainer_params : dict, optional</span>
</span><span id=__span-0-1793><a id=__codelineno-0-1793 name=__codelineno-0-1793></a><span class=sd>        Parameters for the trainer class, see PyTorch Lightning documentation.</span>
</span><span id=__span-0-1794><a id=__codelineno-0-1794 name=__codelineno-0-1794></a><span class=sd>    augmentations : Optional[list[Union[XYFlipModel, XYRandomRotate90Model]]], optional</span>
</span><span id=__span-0-1795><a id=__codelineno-0-1795 name=__codelineno-0-1795></a><span class=sd>        List of augmentations to apply, by default None.</span>
</span><span id=__span-0-1796><a id=__codelineno-0-1796 name=__codelineno-0-1796></a><span class=sd>    train_dataloader_params : Optional[dict[str, Any]], optional</span>
</span><span id=__span-0-1797><a id=__codelineno-0-1797 name=__codelineno-0-1797></a><span class=sd>        Parameters for the training dataloader, by default None.</span>
</span><span id=__span-0-1798><a id=__codelineno-0-1798 name=__codelineno-0-1798></a><span class=sd>    val_dataloader_params : Optional[dict[str, Any]], optional</span>
</span><span id=__span-0-1799><a id=__codelineno-0-1799 name=__codelineno-0-1799></a><span class=sd>        Parameters for the validation dataloader, by default None.</span>
</span><span id=__span-0-1800><a id=__codelineno-0-1800 name=__codelineno-0-1800></a>
</span><span id=__span-0-1801><a id=__codelineno-0-1801 name=__codelineno-0-1801></a><span class=sd>    Returns</span>
</span><span id=__span-0-1802><a id=__codelineno-0-1802 name=__codelineno-0-1802></a><span class=sd>    -------</span>
</span><span id=__span-0-1803><a id=__codelineno-0-1803 name=__codelineno-0-1803></a><span class=sd>    Configuration</span>
</span><span id=__span-0-1804><a id=__codelineno-0-1804 name=__codelineno-0-1804></a><span class=sd>        The configuration object for training HDN.</span>
</span><span id=__span-0-1805><a id=__codelineno-0-1805 name=__codelineno-0-1805></a>
</span><span id=__span-0-1806><a id=__codelineno-0-1806 name=__codelineno-0-1806></a><span class=sd>    Examples</span>
</span><span id=__span-0-1807><a id=__codelineno-0-1807 name=__codelineno-0-1807></a><span class=sd>    --------</span>
</span><span id=__span-0-1808><a id=__codelineno-0-1808 name=__codelineno-0-1808></a><span class=sd>    Minimum example:</span>
</span><span id=__span-0-1809><a id=__codelineno-0-1809 name=__codelineno-0-1809></a><span class=sd>    &gt;&gt;&gt; config = create_hdn_configuration(</span>
</span><span id=__span-0-1810><a id=__codelineno-0-1810 name=__codelineno-0-1810></a><span class=sd>    ...     experiment_name=&quot;hdn_experiment&quot;,</span>
</span><span id=__span-0-1811><a id=__codelineno-0-1811 name=__codelineno-0-1811></a><span class=sd>    ...     data_type=&quot;array&quot;,</span>
</span><span id=__span-0-1812><a id=__codelineno-0-1812 name=__codelineno-0-1812></a><span class=sd>    ...     axes=&quot;YX&quot;,</span>
</span><span id=__span-0-1813><a id=__codelineno-0-1813 name=__codelineno-0-1813></a><span class=sd>    ...     patch_size=[64, 64],</span>
</span><span id=__span-0-1814><a id=__codelineno-0-1814 name=__codelineno-0-1814></a><span class=sd>    ...     batch_size=32,</span>
</span><span id=__span-0-1815><a id=__codelineno-0-1815 name=__codelineno-0-1815></a><span class=sd>    ...     num_epochs=100</span>
</span><span id=__span-0-1816><a id=__codelineno-0-1816 name=__codelineno-0-1816></a><span class=sd>    ... )</span>
</span><span id=__span-0-1817><a id=__codelineno-0-1817 name=__codelineno-0-1817></a>
</span><span id=__span-0-1818><a id=__codelineno-0-1818 name=__codelineno-0-1818></a><span class=sd>    You can also limit the number of batches per epoch:</span>
</span><span id=__span-0-1819><a id=__codelineno-0-1819 name=__codelineno-0-1819></a><span class=sd>    &gt;&gt;&gt; config = create_hdn_configuration(</span>
</span><span id=__span-0-1820><a id=__codelineno-0-1820 name=__codelineno-0-1820></a><span class=sd>    ...     experiment_name=&quot;hdn_experiment&quot;,</span>
</span><span id=__span-0-1821><a id=__codelineno-0-1821 name=__codelineno-0-1821></a><span class=sd>    ...     data_type=&quot;array&quot;,</span>
</span><span id=__span-0-1822><a id=__codelineno-0-1822 name=__codelineno-0-1822></a><span class=sd>    ...     axes=&quot;YX&quot;,</span>
</span><span id=__span-0-1823><a id=__codelineno-0-1823 name=__codelineno-0-1823></a><span class=sd>    ...     patch_size=[64, 64],</span>
</span><span id=__span-0-1824><a id=__codelineno-0-1824 name=__codelineno-0-1824></a><span class=sd>    ...     batch_size=32,</span>
</span><span id=__span-0-1825><a id=__codelineno-0-1825 name=__codelineno-0-1825></a><span class=sd>    ...     num_steps=100  # limit to 100 batches per epoch</span>
</span><span id=__span-0-1826><a id=__codelineno-0-1826 name=__codelineno-0-1826></a><span class=sd>    ... )</span>
</span><span id=__span-0-1827><a id=__codelineno-0-1827 name=__codelineno-0-1827></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-1828><a id=__codelineno-0-1828 name=__codelineno-0-1828></a>    <span class=n>transform_list</span> <span class=o>=</span> <span class=n>_list_spatial_augmentations</span><span class=p>(</span><span class=n>augmentations</span><span class=p>)</span>
</span><span id=__span-0-1829><a id=__codelineno-0-1829 name=__codelineno-0-1829></a>
</span><span id=__span-0-1830><a id=__codelineno-0-1830 name=__codelineno-0-1830></a>    <span class=n>loss_config</span> <span class=o>=</span> <span class=n>LVAELossConfig</span><span class=p>(</span>
</span><span id=__span-0-1831><a id=__codelineno-0-1831 name=__codelineno-0-1831></a>        <span class=n>loss_type</span><span class=o>=</span><span class=s2>&quot;hdn&quot;</span><span class=p>,</span> <span class=n>denoisplit_weight</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>musplit_weight</span><span class=o>=</span><span class=mi>0</span>
</span><span id=__span-0-1832><a id=__codelineno-0-1832 name=__codelineno-0-1832></a>    <span class=p>)</span>  <span class=c1># TODO what are the correct defaults for HDN?</span>
</span><span id=__span-0-1833><a id=__codelineno-0-1833 name=__codelineno-0-1833></a>
</span><span id=__span-0-1834><a id=__codelineno-0-1834 name=__codelineno-0-1834></a>    <span class=n>gaussian_likelihood</span> <span class=o>=</span> <span class=n>GaussianLikelihoodConfig</span><span class=p>(</span>
</span><span id=__span-0-1835><a id=__codelineno-0-1835 name=__codelineno-0-1835></a>        <span class=n>predict_logvar</span><span class=o>=</span><span class=n>predict_logvar</span><span class=p>,</span> <span class=n>logvar_lowerbound</span><span class=o>=</span><span class=n>logvar_lowerbound</span>
</span><span id=__span-0-1836><a id=__codelineno-0-1836 name=__codelineno-0-1836></a>    <span class=p>)</span>
</span><span id=__span-0-1837><a id=__codelineno-0-1837 name=__codelineno-0-1837></a>
</span><span id=__span-0-1838><a id=__codelineno-0-1838 name=__codelineno-0-1838></a>    <span class=c1># algorithm &amp; model</span>
</span><span id=__span-0-1839><a id=__codelineno-0-1839 name=__codelineno-0-1839></a>    <span class=n>algorithm_params</span> <span class=o>=</span> <span class=n>_create_vae_based_algorithm</span><span class=p>(</span>
</span><span id=__span-0-1840><a id=__codelineno-0-1840 name=__codelineno-0-1840></a>        <span class=n>algorithm</span><span class=o>=</span><span class=s2>&quot;hdn&quot;</span><span class=p>,</span>
</span><span id=__span-0-1841><a id=__codelineno-0-1841 name=__codelineno-0-1841></a>        <span class=n>loss</span><span class=o>=</span><span class=n>loss_config</span><span class=p>,</span>
</span><span id=__span-0-1842><a id=__codelineno-0-1842 name=__codelineno-0-1842></a>        <span class=n>input_shape</span><span class=o>=</span><span class=n>patch_size</span><span class=p>,</span>
</span><span id=__span-0-1843><a id=__codelineno-0-1843 name=__codelineno-0-1843></a>        <span class=n>encoder_conv_strides</span><span class=o>=</span><span class=n>encoder_conv_strides</span><span class=p>,</span>
</span><span id=__span-0-1844><a id=__codelineno-0-1844 name=__codelineno-0-1844></a>        <span class=n>decoder_conv_strides</span><span class=o>=</span><span class=n>decoder_conv_strides</span><span class=p>,</span>
</span><span id=__span-0-1845><a id=__codelineno-0-1845 name=__codelineno-0-1845></a>        <span class=n>multiscale_count</span><span class=o>=</span><span class=n>multiscale_count</span><span class=p>,</span>
</span><span id=__span-0-1846><a id=__codelineno-0-1846 name=__codelineno-0-1846></a>        <span class=n>z_dims</span><span class=o>=</span><span class=n>z_dims</span><span class=p>,</span>
</span><span id=__span-0-1847><a id=__codelineno-0-1847 name=__codelineno-0-1847></a>        <span class=n>output_channels</span><span class=o>=</span><span class=n>output_channels</span><span class=p>,</span>
</span><span id=__span-0-1848><a id=__codelineno-0-1848 name=__codelineno-0-1848></a>        <span class=n>encoder_n_filters</span><span class=o>=</span><span class=n>encoder_n_filters</span><span class=p>,</span>
</span><span id=__span-0-1849><a id=__codelineno-0-1849 name=__codelineno-0-1849></a>        <span class=n>decoder_n_filters</span><span class=o>=</span><span class=n>decoder_n_filters</span><span class=p>,</span>
</span><span id=__span-0-1850><a id=__codelineno-0-1850 name=__codelineno-0-1850></a>        <span class=n>encoder_dropout</span><span class=o>=</span><span class=n>encoder_dropout</span><span class=p>,</span>
</span><span id=__span-0-1851><a id=__codelineno-0-1851 name=__codelineno-0-1851></a>        <span class=n>decoder_dropout</span><span class=o>=</span><span class=n>decoder_dropout</span><span class=p>,</span>
</span><span id=__span-0-1852><a id=__codelineno-0-1852 name=__codelineno-0-1852></a>        <span class=n>nonlinearity</span><span class=o>=</span><span class=n>nonlinearity</span><span class=p>,</span>
</span><span id=__span-0-1853><a id=__codelineno-0-1853 name=__codelineno-0-1853></a>        <span class=n>predict_logvar</span><span class=o>=</span><span class=n>predict_logvar</span><span class=p>,</span>
</span><span id=__span-0-1854><a id=__codelineno-0-1854 name=__codelineno-0-1854></a>        <span class=n>analytical_kl</span><span class=o>=</span><span class=n>analytical_kl</span><span class=p>,</span>
</span><span id=__span-0-1855><a id=__codelineno-0-1855 name=__codelineno-0-1855></a>        <span class=n>gaussian_likelihood</span><span class=o>=</span><span class=n>gaussian_likelihood</span><span class=p>,</span>
</span><span id=__span-0-1856><a id=__codelineno-0-1856 name=__codelineno-0-1856></a>        <span class=n>nm_likelihood</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-1857><a id=__codelineno-0-1857 name=__codelineno-0-1857></a>    <span class=p>)</span>
</span><span id=__span-0-1858><a id=__codelineno-0-1858 name=__codelineno-0-1858></a>
</span><span id=__span-0-1859><a id=__codelineno-0-1859 name=__codelineno-0-1859></a>    <span class=c1># data</span>
</span><span id=__span-0-1860><a id=__codelineno-0-1860 name=__codelineno-0-1860></a>    <span class=n>data_params</span> <span class=o>=</span> <span class=n>_create_data_configuration</span><span class=p>(</span>
</span><span id=__span-0-1861><a id=__codelineno-0-1861 name=__codelineno-0-1861></a>        <span class=n>data_type</span><span class=o>=</span><span class=n>data_type</span><span class=p>,</span>
</span><span id=__span-0-1862><a id=__codelineno-0-1862 name=__codelineno-0-1862></a>        <span class=n>axes</span><span class=o>=</span><span class=n>axes</span><span class=p>,</span>
</span><span id=__span-0-1863><a id=__codelineno-0-1863 name=__codelineno-0-1863></a>        <span class=n>patch_size</span><span class=o>=</span><span class=n>patch_size</span><span class=p>,</span>
</span><span id=__span-0-1864><a id=__codelineno-0-1864 name=__codelineno-0-1864></a>        <span class=n>batch_size</span><span class=o>=</span><span class=n>batch_size</span><span class=p>,</span>
</span><span id=__span-0-1865><a id=__codelineno-0-1865 name=__codelineno-0-1865></a>        <span class=n>augmentations</span><span class=o>=</span><span class=n>transform_list</span><span class=p>,</span>
</span><span id=__span-0-1866><a id=__codelineno-0-1866 name=__codelineno-0-1866></a>        <span class=n>train_dataloader_params</span><span class=o>=</span><span class=n>train_dataloader_params</span><span class=p>,</span>
</span><span id=__span-0-1867><a id=__codelineno-0-1867 name=__codelineno-0-1867></a>        <span class=n>val_dataloader_params</span><span class=o>=</span><span class=n>val_dataloader_params</span><span class=p>,</span>
</span><span id=__span-0-1868><a id=__codelineno-0-1868 name=__codelineno-0-1868></a>    <span class=p>)</span>
</span><span id=__span-0-1869><a id=__codelineno-0-1869 name=__codelineno-0-1869></a>
</span><span id=__span-0-1870><a id=__codelineno-0-1870 name=__codelineno-0-1870></a>    <span class=c1># Handle trainer parameters with num_epochs and num_steps</span>
</span><span id=__span-0-1871><a id=__codelineno-0-1871 name=__codelineno-0-1871></a>    <span class=n>final_trainer_params</span> <span class=o>=</span> <span class=p>{}</span> <span class=k>if</span> <span class=n>trainer_params</span> <span class=ow>is</span> <span class=kc>None</span> <span class=k>else</span> <span class=n>trainer_params</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span><span id=__span-0-1872><a id=__codelineno-0-1872 name=__codelineno-0-1872></a>
</span><span id=__span-0-1873><a id=__codelineno-0-1873 name=__codelineno-0-1873></a>    <span class=c1># Add num_epochs and num_steps if provided</span>
</span><span id=__span-0-1874><a id=__codelineno-0-1874 name=__codelineno-0-1874></a>    <span class=k>if</span> <span class=n>num_epochs</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-1875><a id=__codelineno-0-1875 name=__codelineno-0-1875></a>        <span class=n>final_trainer_params</span><span class=p>[</span><span class=s2>&quot;max_epochs&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>num_epochs</span>
</span><span id=__span-0-1876><a id=__codelineno-0-1876 name=__codelineno-0-1876></a>    <span class=k>if</span> <span class=n>num_steps</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-1877><a id=__codelineno-0-1877 name=__codelineno-0-1877></a>        <span class=n>final_trainer_params</span><span class=p>[</span><span class=s2>&quot;limit_train_batches&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>num_steps</span>
</span><span id=__span-0-1878><a id=__codelineno-0-1878 name=__codelineno-0-1878></a>
</span><span id=__span-0-1879><a id=__codelineno-0-1879 name=__codelineno-0-1879></a>    <span class=c1># training</span>
</span><span id=__span-0-1880><a id=__codelineno-0-1880 name=__codelineno-0-1880></a>    <span class=n>training_params</span> <span class=o>=</span> <span class=n>_create_training_configuration</span><span class=p>(</span>
</span><span id=__span-0-1881><a id=__codelineno-0-1881 name=__codelineno-0-1881></a>        <span class=n>trainer_params</span><span class=o>=</span><span class=n>final_trainer_params</span><span class=p>,</span>
</span><span id=__span-0-1882><a id=__codelineno-0-1882 name=__codelineno-0-1882></a>        <span class=n>logger</span><span class=o>=</span><span class=n>logger</span><span class=p>,</span>
</span><span id=__span-0-1883><a id=__codelineno-0-1883 name=__codelineno-0-1883></a>    <span class=p>)</span>
</span><span id=__span-0-1884><a id=__codelineno-0-1884 name=__codelineno-0-1884></a>
</span><span id=__span-0-1885><a id=__codelineno-0-1885 name=__codelineno-0-1885></a>    <span class=k>return</span> <span class=n>Configuration</span><span class=p>(</span>
</span><span id=__span-0-1886><a id=__codelineno-0-1886 name=__codelineno-0-1886></a>        <span class=n>experiment_name</span><span class=o>=</span><span class=n>experiment_name</span><span class=p>,</span>
</span><span id=__span-0-1887><a id=__codelineno-0-1887 name=__codelineno-0-1887></a>        <span class=n>algorithm_config</span><span class=o>=</span><span class=n>algorithm_params</span><span class=p>,</span>
</span><span id=__span-0-1888><a id=__codelineno-0-1888 name=__codelineno-0-1888></a>        <span class=n>data_config</span><span class=o>=</span><span class=n>data_params</span><span class=p>,</span>
</span><span id=__span-0-1889><a id=__codelineno-0-1889 name=__codelineno-0-1889></a>        <span class=n>training_config</span><span class=o>=</span><span class=n>training_params</span><span class=p>,</span>
</span><span id=__span-0-1890><a id=__codelineno-0-1890 name=__codelineno-0-1890></a>    <span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=careamics.config.configuration_factories.create_microsplit_configuration class="doc doc-heading"> <code class="highlight language-python"><span class=n>create_microsplit_configuration</span><span class=p>(</span><span class=n>experiment_name</span><span class=p>,</span> <span class=n>data_type</span><span class=p>,</span> <span class=n>axes</span><span class=p>,</span> <span class=n>patch_size</span><span class=p>,</span> <span class=n>batch_size</span><span class=p>,</span> <span class=n>num_epochs</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>num_steps</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>encoder_conv_strides</span><span class=o>=</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>),</span> <span class=n>decoder_conv_strides</span><span class=o>=</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>),</span> <span class=n>multiscale_count</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span> <span class=n>grid_size</span><span class=o>=</span><span class=mi>32</span><span class=p>,</span> <span class=n>z_dims</span><span class=o>=</span><span class=p>(</span><span class=mi>128</span><span class=p>,</span> <span class=mi>128</span><span class=p>),</span> <span class=n>output_channels</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>encoder_n_filters</span><span class=o>=</span><span class=mi>32</span><span class=p>,</span> <span class=n>decoder_n_filters</span><span class=o>=</span><span class=mi>32</span><span class=p>,</span> <span class=n>encoder_dropout</span><span class=o>=</span><span class=mf>0.0</span><span class=p>,</span> <span class=n>decoder_dropout</span><span class=o>=</span><span class=mf>0.0</span><span class=p>,</span> <span class=n>nonlinearity</span><span class=o>=</span><span class=s1>&#39;ReLU&#39;</span><span class=p>,</span> <span class=n>analytical_kl</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>predict_logvar</span><span class=o>=</span><span class=s1>&#39;pixelwise&#39;</span><span class=p>,</span> <span class=n>logvar_lowerbound</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=s1>&#39;none&#39;</span><span class=p>,</span> <span class=n>trainer_params</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>augmentations</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>nm_paths</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>data_stats</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>train_dataloader_params</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>val_dataloader_params</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#careamics.config.configuration_factories.create_microsplit_configuration class=headerlink title="Permanent link">#</a></h2> <div class="doc doc-contents "> <p>Create a configuration for training MicroSplit.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>experiment_name</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>Name of the experiment.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>data_type</code> </td> <td> <code><span title=typing.Literal>Literal</span>[&#39;array&#39;, &#39;tiff&#39;, &#39;custom&#39;]</code> </td> <td> <div class=doc-md-description> <p>Type of the data.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>axes</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>Axes of the data (e.g. SYX).</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>patch_size</code> </td> <td> <code><span title=collections.abc.Sequence>Sequence</span>[<span title=int>int</span>]</code> </td> <td> <div class=doc-md-description> <p>Size of the patches along the spatial dimensions (e.g. [64, 64]).</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>batch_size</code> </td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>Batch size.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>num_epochs</code> </td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>Number of epochs to train for. If provided, this will be added to trainer_params.</p> </div> </td> <td> <code>100</code> </td> </tr> <tr class=doc-section-item> <td> <code>num_steps</code> </td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>Number of batches in 1 epoch. If provided, this will be added to trainer_params. Translates to <code>limit_train_batches</code> in PyTorch Lightning Trainer. See relevant documentation for more details.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>encoder_conv_strides</code> </td> <td> <code><span title=tuple>tuple</span>[<span title=int>int</span>, ...]</code> </td> <td> <div class=doc-md-description> <p>Strides for the encoder convolutional layers, by default (2, 2).</p> </div> </td> <td> <code>(2, 2)</code> </td> </tr> <tr class=doc-section-item> <td> <code>decoder_conv_strides</code> </td> <td> <code><span title=tuple>tuple</span>[<span title=int>int</span>, ...]</code> </td> <td> <div class=doc-md-description> <p>Strides for the decoder convolutional layers, by default (2, 2).</p> </div> </td> <td> <code>(2, 2)</code> </td> </tr> <tr class=doc-section-item> <td> <code>multiscale_count</code> </td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>Number of multiscale levels, by default 1.</p> </div> </td> <td> <code>3</code> </td> </tr> <tr class=doc-section-item> <td> <code>grid_size</code> </td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>Size of the grid for the lateral context, by default 32.</p> </div> </td> <td> <code>32</code> </td> </tr> <tr class=doc-section-item> <td> <code>z_dims</code> </td> <td> <code><span title=tuple>tuple</span>[<span title=int>int</span>, ...]</code> </td> <td> <div class=doc-md-description> <p>List of latent dimensions for each hierarchy level in the LVAE, by default (128, 128).</p> </div> </td> <td> <code>(128, 128)</code> </td> </tr> <tr class=doc-section-item> <td> <code>output_channels</code> </td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>Number of output channels for the model, by default 1.</p> </div> </td> <td> <code>1</code> </td> </tr> <tr class=doc-section-item> <td> <code>encoder_n_filters</code> </td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>Number of filters in the encoder, by default 32.</p> </div> </td> <td> <code>32</code> </td> </tr> <tr class=doc-section-item> <td> <code>decoder_n_filters</code> </td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>Number of filters in the decoder, by default 32.</p> </div> </td> <td> <code>32</code> </td> </tr> <tr class=doc-section-item> <td> <code>encoder_dropout</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>Dropout rate for the encoder, by default 0.0.</p> </div> </td> <td> <code>0.0</code> </td> </tr> <tr class=doc-section-item> <td> <code>decoder_dropout</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>Dropout rate for the decoder, by default 0.0.</p> </div> </td> <td> <code>0.0</code> </td> </tr> <tr class=doc-section-item> <td> <code>nonlinearity</code> </td> <td> <code><span title=typing.Literal>Literal</span></code> </td> <td> <div class=doc-md-description> <p>Nonlinearity to use in the model, by default "ReLU".</p> </div> </td> <td> <code>&#39;ReLU&#39;</code> </td> </tr> <tr class=doc-section-item> <td> <code>analytical_kl</code> </td> <td> <code><span title=bool>bool</span></code> </td> <td> <div class=doc-md-description> <p>Whether to use analytical KL divergence, by default False.</p> </div> </td> <td> <code>False</code> </td> </tr> <tr class=doc-section-item> <td> <code>predict_logvar</code> </td> <td> <code><span title=typing.Literal>Literal</span>[&#39;pixelwise&#39;] | None</code> </td> <td> <div class=doc-md-description> <p>Type of log-variance prediction, by default None.</p> </div> </td> <td> <code>&#39;pixelwise&#39;</code> </td> </tr> <tr class=doc-section-item> <td> <code>logvar_lowerbound</code> </td> <td> <code><span title=typing.Union>Union</span>[<span title=float>float</span>, None]</code> </td> <td> <div class=doc-md-description> <p>Lower bound for the log variance, by default None.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>logger</code> </td> <td> <code><span title=typing.Literal>Literal</span>[&#39;wandb&#39;, &#39;tensorboard&#39;, &#39;none&#39;]</code> </td> <td> <div class=doc-md-description> <p>Logger to use for training, by default "none".</p> </div> </td> <td> <code>&#39;none&#39;</code> </td> </tr> <tr class=doc-section-item> <td> <code>trainer_params</code> </td> <td> <code><span title=dict>dict</span></code> </td> <td> <div class=doc-md-description> <p>Parameters for the trainer class, see PyTorch Lightning documentation.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>augmentations</code> </td> <td> <code><span title=list>list</span>[<span title=typing.Union>Union</span>[<a class="autorefs autorefs-internal" title="XYFlipModel (careamics.config.transformations.XYFlipModel)" href=../transformations/xy_flip_model/#careamics.config.transformations.xy_flip_model.XYFlipModel>XYFlipModel</a>, <a class="autorefs autorefs-internal" title="XYRandomRotate90Model (careamics.config.transformations.XYRandomRotate90Model)" href=../transformations/xy_random_rotate90_model/#careamics.config.transformations.xy_random_rotate90_model.XYRandomRotate90Model>XYRandomRotate90Model</a>]] | None</code> </td> <td> <div class=doc-md-description> <p>List of augmentations to apply, by default None.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>nm_paths</code> </td> <td> <code><span title=list>list</span>[<span title=str>str</span>] | None</code> </td> <td> <div class=doc-md-description> <p>Paths to the noise model files, by default None.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>data_stats</code> </td> <td> <code><span title=tuple>tuple</span>[<span title=float>float</span>, <span title=float>float</span>] | None</code> </td> <td> <div class=doc-md-description> <p>Data statistics (mean, std), by default None.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>train_dataloader_params</code> </td> <td> <code><span title=dict>dict</span>[<span title=str>str</span>, <span title=typing.Any>Any</span>] | None</code> </td> <td> <div class=doc-md-description> <p>Parameters for the training dataloader, by default None.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>val_dataloader_params</code> </td> <td> <code><span title=dict>dict</span>[<span title=str>str</span>, <span title=typing.Any>Any</span>] | None</code> </td> <td> <div class=doc-md-description> <p>Parameters for the validation dataloader, by default None.</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-internal" title="Configuration (careamics.config.configuration.Configuration)" href=../configuration/#careamics.config.configuration.Configuration>Configuration</a></code> </td> <td> <div class=doc-md-description> <p>A configuration object for the microsplit algorithm.</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Examples:</span></p> <p>Minimum example:</p> <h3 id=careamics.config.configuration_factories.create_microsplit_configuration--config-create_microsplit_configuration>&gt;&gt;&gt; config = create_microsplit_configuration(<a class=headerlink href=#careamics.config.configuration_factories.create_microsplit_configuration--config-create_microsplit_configuration title="Permanent link">#</a></h3> <h3 id=careamics.config.configuration_factories.create_microsplit_configuration--experiment_namemicrosplit_experiment>... experiment_name="microsplit_experiment",<a class=headerlink href=#careamics.config.configuration_factories.create_microsplit_configuration--experiment_namemicrosplit_experiment title="Permanent link">#</a></h3> <h3 id=careamics.config.configuration_factories.create_microsplit_configuration--data_typearray>... data_type="array",<a class=headerlink href=#careamics.config.configuration_factories.create_microsplit_configuration--data_typearray title="Permanent link">#</a></h3> <h3 id=careamics.config.configuration_factories.create_microsplit_configuration--axesyx>... axes="YX",<a class=headerlink href=#careamics.config.configuration_factories.create_microsplit_configuration--axesyx title="Permanent link">#</a></h3> <h3 id=careamics.config.configuration_factories.create_microsplit_configuration--patch_size64-64>... patch_size=[64, 64],<a class=headerlink href=#careamics.config.configuration_factories.create_microsplit_configuration--patch_size64-64 title="Permanent link">#</a></h3> <h3 id=careamics.config.configuration_factories.create_microsplit_configuration--batch_size32>... batch_size=32,<a class=headerlink href=#careamics.config.configuration_factories.create_microsplit_configuration--batch_size32 title="Permanent link">#</a></h3> <h3 id=careamics.config.configuration_factories.create_microsplit_configuration--num_epochs100>... num_epochs=100<a class=headerlink href=#careamics.config.configuration_factories.create_microsplit_configuration--num_epochs100 title="Permanent link">#</a></h3> <h3 id=careamics.config.configuration_factories.create_microsplit_configuration--_1>... )<a class=headerlink href=#careamics.config.configuration_factories.create_microsplit_configuration--_1 title="Permanent link">#</a></h3> <h3 id=careamics.config.configuration_factories.create_microsplit_configuration--you-can-also-limit-the-number-of-batches-per-epoch>You can also limit the number of batches per epoch:<a class=headerlink href=#careamics.config.configuration_factories.create_microsplit_configuration--you-can-also-limit-the-number-of-batches-per-epoch title="Permanent link">#</a></h3> <h3 id=careamics.config.configuration_factories.create_microsplit_configuration--config-create_microsplit_configuration_1>&gt;&gt;&gt; config = create_microsplit_configuration(<a class=headerlink href=#careamics.config.configuration_factories.create_microsplit_configuration--config-create_microsplit_configuration_1 title="Permanent link">#</a></h3> <h3 id=careamics.config.configuration_factories.create_microsplit_configuration--experiment_namemicrosplit_experiment_1>... experiment_name="microsplit_experiment",<a class=headerlink href=#careamics.config.configuration_factories.create_microsplit_configuration--experiment_namemicrosplit_experiment_1 title="Permanent link">#</a></h3> <h3 id=careamics.config.configuration_factories.create_microsplit_configuration--data_typearray_1>... data_type="array",<a class=headerlink href=#careamics.config.configuration_factories.create_microsplit_configuration--data_typearray_1 title="Permanent link">#</a></h3> <h3 id=careamics.config.configuration_factories.create_microsplit_configuration--axesyx_1>... axes="YX",<a class=headerlink href=#careamics.config.configuration_factories.create_microsplit_configuration--axesyx_1 title="Permanent link">#</a></h3> <h3 id=careamics.config.configuration_factories.create_microsplit_configuration--patch_size64-64_1>... patch_size=[64, 64],<a class=headerlink href=#careamics.config.configuration_factories.create_microsplit_configuration--patch_size64-64_1 title="Permanent link">#</a></h3> <h3 id=careamics.config.configuration_factories.create_microsplit_configuration--batch_size32_1>... batch_size=32,<a class=headerlink href=#careamics.config.configuration_factories.create_microsplit_configuration--batch_size32_1 title="Permanent link">#</a></h3> <h3 id=careamics.config.configuration_factories.create_microsplit_configuration--num_steps100-limit-to-100-batches-per-epoch>... num_steps=100 # limit to 100 batches per epoch<a class=headerlink href=#careamics.config.configuration_factories.create_microsplit_configuration--num_steps100-limit-to-100-batches-per-epoch title="Permanent link">#</a></h3> <h3 id=careamics.config.configuration_factories.create_microsplit_configuration--_2>... )<a class=headerlink href=#careamics.config.configuration_factories.create_microsplit_configuration--_2 title="Permanent link">#</a></h3> <details class=quote> <summary>Source code in <code>src/careamics/config/configuration_factories.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-1893>1893</a></span>
<span class=normal><a href=#__codelineno-0-1894>1894</a></span>
<span class=normal><a href=#__codelineno-0-1895>1895</a></span>
<span class=normal><a href=#__codelineno-0-1896>1896</a></span>
<span class=normal><a href=#__codelineno-0-1897>1897</a></span>
<span class=normal><a href=#__codelineno-0-1898>1898</a></span>
<span class=normal><a href=#__codelineno-0-1899>1899</a></span>
<span class=normal><a href=#__codelineno-0-1900>1900</a></span>
<span class=normal><a href=#__codelineno-0-1901>1901</a></span>
<span class=normal><a href=#__codelineno-0-1902>1902</a></span>
<span class=normal><a href=#__codelineno-0-1903>1903</a></span>
<span class=normal><a href=#__codelineno-0-1904>1904</a></span>
<span class=normal><a href=#__codelineno-0-1905>1905</a></span>
<span class=normal><a href=#__codelineno-0-1906>1906</a></span>
<span class=normal><a href=#__codelineno-0-1907>1907</a></span>
<span class=normal><a href=#__codelineno-0-1908>1908</a></span>
<span class=normal><a href=#__codelineno-0-1909>1909</a></span>
<span class=normal><a href=#__codelineno-0-1910>1910</a></span>
<span class=normal><a href=#__codelineno-0-1911>1911</a></span>
<span class=normal><a href=#__codelineno-0-1912>1912</a></span>
<span class=normal><a href=#__codelineno-0-1913>1913</a></span>
<span class=normal><a href=#__codelineno-0-1914>1914</a></span>
<span class=normal><a href=#__codelineno-0-1915>1915</a></span>
<span class=normal><a href=#__codelineno-0-1916>1916</a></span>
<span class=normal><a href=#__codelineno-0-1917>1917</a></span>
<span class=normal><a href=#__codelineno-0-1918>1918</a></span>
<span class=normal><a href=#__codelineno-0-1919>1919</a></span>
<span class=normal><a href=#__codelineno-0-1920>1920</a></span>
<span class=normal><a href=#__codelineno-0-1921>1921</a></span>
<span class=normal><a href=#__codelineno-0-1922>1922</a></span>
<span class=normal><a href=#__codelineno-0-1923>1923</a></span>
<span class=normal><a href=#__codelineno-0-1924>1924</a></span>
<span class=normal><a href=#__codelineno-0-1925>1925</a></span>
<span class=normal><a href=#__codelineno-0-1926>1926</a></span>
<span class=normal><a href=#__codelineno-0-1927>1927</a></span>
<span class=normal><a href=#__codelineno-0-1928>1928</a></span>
<span class=normal><a href=#__codelineno-0-1929>1929</a></span>
<span class=normal><a href=#__codelineno-0-1930>1930</a></span>
<span class=normal><a href=#__codelineno-0-1931>1931</a></span>
<span class=normal><a href=#__codelineno-0-1932>1932</a></span>
<span class=normal><a href=#__codelineno-0-1933>1933</a></span>
<span class=normal><a href=#__codelineno-0-1934>1934</a></span>
<span class=normal><a href=#__codelineno-0-1935>1935</a></span>
<span class=normal><a href=#__codelineno-0-1936>1936</a></span>
<span class=normal><a href=#__codelineno-0-1937>1937</a></span>
<span class=normal><a href=#__codelineno-0-1938>1938</a></span>
<span class=normal><a href=#__codelineno-0-1939>1939</a></span>
<span class=normal><a href=#__codelineno-0-1940>1940</a></span>
<span class=normal><a href=#__codelineno-0-1941>1941</a></span>
<span class=normal><a href=#__codelineno-0-1942>1942</a></span>
<span class=normal><a href=#__codelineno-0-1943>1943</a></span>
<span class=normal><a href=#__codelineno-0-1944>1944</a></span>
<span class=normal><a href=#__codelineno-0-1945>1945</a></span>
<span class=normal><a href=#__codelineno-0-1946>1946</a></span>
<span class=normal><a href=#__codelineno-0-1947>1947</a></span>
<span class=normal><a href=#__codelineno-0-1948>1948</a></span>
<span class=normal><a href=#__codelineno-0-1949>1949</a></span>
<span class=normal><a href=#__codelineno-0-1950>1950</a></span>
<span class=normal><a href=#__codelineno-0-1951>1951</a></span>
<span class=normal><a href=#__codelineno-0-1952>1952</a></span>
<span class=normal><a href=#__codelineno-0-1953>1953</a></span>
<span class=normal><a href=#__codelineno-0-1954>1954</a></span>
<span class=normal><a href=#__codelineno-0-1955>1955</a></span>
<span class=normal><a href=#__codelineno-0-1956>1956</a></span>
<span class=normal><a href=#__codelineno-0-1957>1957</a></span>
<span class=normal><a href=#__codelineno-0-1958>1958</a></span>
<span class=normal><a href=#__codelineno-0-1959>1959</a></span>
<span class=normal><a href=#__codelineno-0-1960>1960</a></span>
<span class=normal><a href=#__codelineno-0-1961>1961</a></span>
<span class=normal><a href=#__codelineno-0-1962>1962</a></span>
<span class=normal><a href=#__codelineno-0-1963>1963</a></span>
<span class=normal><a href=#__codelineno-0-1964>1964</a></span>
<span class=normal><a href=#__codelineno-0-1965>1965</a></span>
<span class=normal><a href=#__codelineno-0-1966>1966</a></span>
<span class=normal><a href=#__codelineno-0-1967>1967</a></span>
<span class=normal><a href=#__codelineno-0-1968>1968</a></span>
<span class=normal><a href=#__codelineno-0-1969>1969</a></span>
<span class=normal><a href=#__codelineno-0-1970>1970</a></span>
<span class=normal><a href=#__codelineno-0-1971>1971</a></span>
<span class=normal><a href=#__codelineno-0-1972>1972</a></span>
<span class=normal><a href=#__codelineno-0-1973>1973</a></span>
<span class=normal><a href=#__codelineno-0-1974>1974</a></span>
<span class=normal><a href=#__codelineno-0-1975>1975</a></span>
<span class=normal><a href=#__codelineno-0-1976>1976</a></span>
<span class=normal><a href=#__codelineno-0-1977>1977</a></span>
<span class=normal><a href=#__codelineno-0-1978>1978</a></span>
<span class=normal><a href=#__codelineno-0-1979>1979</a></span>
<span class=normal><a href=#__codelineno-0-1980>1980</a></span>
<span class=normal><a href=#__codelineno-0-1981>1981</a></span>
<span class=normal><a href=#__codelineno-0-1982>1982</a></span>
<span class=normal><a href=#__codelineno-0-1983>1983</a></span>
<span class=normal><a href=#__codelineno-0-1984>1984</a></span>
<span class=normal><a href=#__codelineno-0-1985>1985</a></span>
<span class=normal><a href=#__codelineno-0-1986>1986</a></span>
<span class=normal><a href=#__codelineno-0-1987>1987</a></span>
<span class=normal><a href=#__codelineno-0-1988>1988</a></span>
<span class=normal><a href=#__codelineno-0-1989>1989</a></span>
<span class=normal><a href=#__codelineno-0-1990>1990</a></span>
<span class=normal><a href=#__codelineno-0-1991>1991</a></span>
<span class=normal><a href=#__codelineno-0-1992>1992</a></span>
<span class=normal><a href=#__codelineno-0-1993>1993</a></span>
<span class=normal><a href=#__codelineno-0-1994>1994</a></span>
<span class=normal><a href=#__codelineno-0-1995>1995</a></span>
<span class=normal><a href=#__codelineno-0-1996>1996</a></span>
<span class=normal><a href=#__codelineno-0-1997>1997</a></span>
<span class=normal><a href=#__codelineno-0-1998>1998</a></span>
<span class=normal><a href=#__codelineno-0-1999>1999</a></span>
<span class=normal><a href=#__codelineno-0-2000>2000</a></span>
<span class=normal><a href=#__codelineno-0-2001>2001</a></span>
<span class=normal><a href=#__codelineno-0-2002>2002</a></span>
<span class=normal><a href=#__codelineno-0-2003>2003</a></span>
<span class=normal><a href=#__codelineno-0-2004>2004</a></span>
<span class=normal><a href=#__codelineno-0-2005>2005</a></span>
<span class=normal><a href=#__codelineno-0-2006>2006</a></span>
<span class=normal><a href=#__codelineno-0-2007>2007</a></span>
<span class=normal><a href=#__codelineno-0-2008>2008</a></span>
<span class=normal><a href=#__codelineno-0-2009>2009</a></span>
<span class=normal><a href=#__codelineno-0-2010>2010</a></span>
<span class=normal><a href=#__codelineno-0-2011>2011</a></span>
<span class=normal><a href=#__codelineno-0-2012>2012</a></span>
<span class=normal><a href=#__codelineno-0-2013>2013</a></span>
<span class=normal><a href=#__codelineno-0-2014>2014</a></span>
<span class=normal><a href=#__codelineno-0-2015>2015</a></span>
<span class=normal><a href=#__codelineno-0-2016>2016</a></span>
<span class=normal><a href=#__codelineno-0-2017>2017</a></span>
<span class=normal><a href=#__codelineno-0-2018>2018</a></span>
<span class=normal><a href=#__codelineno-0-2019>2019</a></span>
<span class=normal><a href=#__codelineno-0-2020>2020</a></span>
<span class=normal><a href=#__codelineno-0-2021>2021</a></span>
<span class=normal><a href=#__codelineno-0-2022>2022</a></span>
<span class=normal><a href=#__codelineno-0-2023>2023</a></span>
<span class=normal><a href=#__codelineno-0-2024>2024</a></span>
<span class=normal><a href=#__codelineno-0-2025>2025</a></span>
<span class=normal><a href=#__codelineno-0-2026>2026</a></span>
<span class=normal><a href=#__codelineno-0-2027>2027</a></span>
<span class=normal><a href=#__codelineno-0-2028>2028</a></span>
<span class=normal><a href=#__codelineno-0-2029>2029</a></span>
<span class=normal><a href=#__codelineno-0-2030>2030</a></span>
<span class=normal><a href=#__codelineno-0-2031>2031</a></span>
<span class=normal><a href=#__codelineno-0-2032>2032</a></span>
<span class=normal><a href=#__codelineno-0-2033>2033</a></span>
<span class=normal><a href=#__codelineno-0-2034>2034</a></span>
<span class=normal><a href=#__codelineno-0-2035>2035</a></span>
<span class=normal><a href=#__codelineno-0-2036>2036</a></span>
<span class=normal><a href=#__codelineno-0-2037>2037</a></span>
<span class=normal><a href=#__codelineno-0-2038>2038</a></span>
<span class=normal><a href=#__codelineno-0-2039>2039</a></span>
<span class=normal><a href=#__codelineno-0-2040>2040</a></span>
<span class=normal><a href=#__codelineno-0-2041>2041</a></span>
<span class=normal><a href=#__codelineno-0-2042>2042</a></span>
<span class=normal><a href=#__codelineno-0-2043>2043</a></span>
<span class=normal><a href=#__codelineno-0-2044>2044</a></span>
<span class=normal><a href=#__codelineno-0-2045>2045</a></span>
<span class=normal><a href=#__codelineno-0-2046>2046</a></span>
<span class=normal><a href=#__codelineno-0-2047>2047</a></span>
<span class=normal><a href=#__codelineno-0-2048>2048</a></span>
<span class=normal><a href=#__codelineno-0-2049>2049</a></span>
<span class=normal><a href=#__codelineno-0-2050>2050</a></span>
<span class=normal><a href=#__codelineno-0-2051>2051</a></span>
<span class=normal><a href=#__codelineno-0-2052>2052</a></span>
<span class=normal><a href=#__codelineno-0-2053>2053</a></span>
<span class=normal><a href=#__codelineno-0-2054>2054</a></span>
<span class=normal><a href=#__codelineno-0-2055>2055</a></span>
<span class=normal><a href=#__codelineno-0-2056>2056</a></span>
<span class=normal><a href=#__codelineno-0-2057>2057</a></span>
<span class=normal><a href=#__codelineno-0-2058>2058</a></span>
<span class=normal><a href=#__codelineno-0-2059>2059</a></span>
<span class=normal><a href=#__codelineno-0-2060>2060</a></span>
<span class=normal><a href=#__codelineno-0-2061>2061</a></span>
<span class=normal><a href=#__codelineno-0-2062>2062</a></span>
<span class=normal><a href=#__codelineno-0-2063>2063</a></span>
<span class=normal><a href=#__codelineno-0-2064>2064</a></span>
<span class=normal><a href=#__codelineno-0-2065>2065</a></span>
<span class=normal><a href=#__codelineno-0-2066>2066</a></span>
<span class=normal><a href=#__codelineno-0-2067>2067</a></span>
<span class=normal><a href=#__codelineno-0-2068>2068</a></span>
<span class=normal><a href=#__codelineno-0-2069>2069</a></span>
<span class=normal><a href=#__codelineno-0-2070>2070</a></span>
<span class=normal><a href=#__codelineno-0-2071>2071</a></span>
<span class=normal><a href=#__codelineno-0-2072>2072</a></span>
<span class=normal><a href=#__codelineno-0-2073>2073</a></span>
<span class=normal><a href=#__codelineno-0-2074>2074</a></span>
<span class=normal><a href=#__codelineno-0-2075>2075</a></span>
<span class=normal><a href=#__codelineno-0-2076>2076</a></span>
<span class=normal><a href=#__codelineno-0-2077>2077</a></span>
<span class=normal><a href=#__codelineno-0-2078>2078</a></span>
<span class=normal><a href=#__codelineno-0-2079>2079</a></span>
<span class=normal><a href=#__codelineno-0-2080>2080</a></span>
<span class=normal><a href=#__codelineno-0-2081>2081</a></span>
<span class=normal><a href=#__codelineno-0-2082>2082</a></span>
<span class=normal><a href=#__codelineno-0-2083>2083</a></span>
<span class=normal><a href=#__codelineno-0-2084>2084</a></span>
<span class=normal><a href=#__codelineno-0-2085>2085</a></span>
<span class=normal><a href=#__codelineno-0-2086>2086</a></span>
<span class=normal><a href=#__codelineno-0-2087>2087</a></span>
<span class=normal><a href=#__codelineno-0-2088>2088</a></span>
<span class=normal><a href=#__codelineno-0-2089>2089</a></span>
<span class=normal><a href=#__codelineno-0-2090>2090</a></span>
<span class=normal><a href=#__codelineno-0-2091>2091</a></span>
<span class=normal><a href=#__codelineno-0-2092>2092</a></span>
<span class=normal><a href=#__codelineno-0-2093>2093</a></span>
<span class=normal><a href=#__codelineno-0-2094>2094</a></span>
<span class=normal><a href=#__codelineno-0-2095>2095</a></span>
<span class=normal><a href=#__codelineno-0-2096>2096</a></span>
<span class=normal><a href=#__codelineno-0-2097>2097</a></span>
<span class=normal><a href=#__codelineno-0-2098>2098</a></span>
<span class=normal><a href=#__codelineno-0-2099>2099</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-1893><a id=__codelineno-0-1893 name=__codelineno-0-1893></a><span class=k>def</span><span class=w> </span><span class=nf>create_microsplit_configuration</span><span class=p>(</span>
</span><span id=__span-0-1894><a id=__codelineno-0-1894 name=__codelineno-0-1894></a>    <span class=n>experiment_name</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span><span id=__span-0-1895><a id=__codelineno-0-1895 name=__codelineno-0-1895></a>    <span class=n>data_type</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span><span class=s2>&quot;array&quot;</span><span class=p>,</span> <span class=s2>&quot;tiff&quot;</span><span class=p>,</span> <span class=s2>&quot;custom&quot;</span><span class=p>],</span>
</span><span id=__span-0-1896><a id=__codelineno-0-1896 name=__codelineno-0-1896></a>    <span class=n>axes</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span><span id=__span-0-1897><a id=__codelineno-0-1897 name=__codelineno-0-1897></a>    <span class=n>patch_size</span><span class=p>:</span> <span class=n>Sequence</span><span class=p>[</span><span class=nb>int</span><span class=p>],</span>
</span><span id=__span-0-1898><a id=__codelineno-0-1898 name=__codelineno-0-1898></a>    <span class=n>batch_size</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-1899><a id=__codelineno-0-1899 name=__codelineno-0-1899></a>    <span class=n>num_epochs</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>100</span><span class=p>,</span>
</span><span id=__span-0-1900><a id=__codelineno-0-1900 name=__codelineno-0-1900></a>    <span class=n>num_steps</span><span class=p>:</span> <span class=nb>int</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-1901><a id=__codelineno-0-1901 name=__codelineno-0-1901></a>    <span class=n>encoder_conv_strides</span><span class=p>:</span> <span class=nb>tuple</span><span class=p>[</span><span class=nb>int</span><span class=p>,</span> <span class=o>...</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>),</span>
</span><span id=__span-0-1902><a id=__codelineno-0-1902 name=__codelineno-0-1902></a>    <span class=n>decoder_conv_strides</span><span class=p>:</span> <span class=nb>tuple</span><span class=p>[</span><span class=nb>int</span><span class=p>,</span> <span class=o>...</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>),</span>
</span><span id=__span-0-1903><a id=__codelineno-0-1903 name=__codelineno-0-1903></a>    <span class=n>multiscale_count</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>3</span><span class=p>,</span>
</span><span id=__span-0-1904><a id=__codelineno-0-1904 name=__codelineno-0-1904></a>    <span class=n>grid_size</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>32</span><span class=p>,</span>  <span class=c1># TODO most likely can be derived from patch size</span>
</span><span id=__span-0-1905><a id=__codelineno-0-1905 name=__codelineno-0-1905></a>    <span class=n>z_dims</span><span class=p>:</span> <span class=nb>tuple</span><span class=p>[</span><span class=nb>int</span><span class=p>,</span> <span class=o>...</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=mi>128</span><span class=p>,</span> <span class=mi>128</span><span class=p>),</span>
</span><span id=__span-0-1906><a id=__codelineno-0-1906 name=__codelineno-0-1906></a>    <span class=n>output_channels</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
</span><span id=__span-0-1907><a id=__codelineno-0-1907 name=__codelineno-0-1907></a>    <span class=n>encoder_n_filters</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>32</span><span class=p>,</span>
</span><span id=__span-0-1908><a id=__codelineno-0-1908 name=__codelineno-0-1908></a>    <span class=n>decoder_n_filters</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>32</span><span class=p>,</span>
</span><span id=__span-0-1909><a id=__codelineno-0-1909 name=__codelineno-0-1909></a>    <span class=n>encoder_dropout</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
</span><span id=__span-0-1910><a id=__codelineno-0-1910 name=__codelineno-0-1910></a>    <span class=n>decoder_dropout</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>,</span>
</span><span id=__span-0-1911><a id=__codelineno-0-1911 name=__codelineno-0-1911></a>    <span class=n>nonlinearity</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span>
</span><span id=__span-0-1912><a id=__codelineno-0-1912 name=__codelineno-0-1912></a>        <span class=s2>&quot;None&quot;</span><span class=p>,</span> <span class=s2>&quot;Sigmoid&quot;</span><span class=p>,</span> <span class=s2>&quot;Softmax&quot;</span><span class=p>,</span> <span class=s2>&quot;Tanh&quot;</span><span class=p>,</span> <span class=s2>&quot;ReLU&quot;</span><span class=p>,</span> <span class=s2>&quot;LeakyReLU&quot;</span><span class=p>,</span> <span class=s2>&quot;ELU&quot;</span>
</span><span id=__span-0-1913><a id=__codelineno-0-1913 name=__codelineno-0-1913></a>    <span class=p>]</span> <span class=o>=</span> <span class=s2>&quot;ReLU&quot;</span><span class=p>,</span>  <span class=c1># TODO do we need all these?</span>
</span><span id=__span-0-1914><a id=__codelineno-0-1914 name=__codelineno-0-1914></a>    <span class=n>analytical_kl</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-0-1915><a id=__codelineno-0-1915 name=__codelineno-0-1915></a>    <span class=n>predict_logvar</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span><span class=s2>&quot;pixelwise&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=s2>&quot;pixelwise&quot;</span><span class=p>,</span>
</span><span id=__span-0-1916><a id=__codelineno-0-1916 name=__codelineno-0-1916></a>    <span class=n>logvar_lowerbound</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=kc>None</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-1917><a id=__codelineno-0-1917 name=__codelineno-0-1917></a>    <span class=n>logger</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span><span class=s2>&quot;wandb&quot;</span><span class=p>,</span> <span class=s2>&quot;tensorboard&quot;</span><span class=p>,</span> <span class=s2>&quot;none&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=s2>&quot;none&quot;</span><span class=p>,</span>
</span><span id=__span-0-1918><a id=__codelineno-0-1918 name=__codelineno-0-1918></a>    <span class=n>trainer_params</span><span class=p>:</span> <span class=nb>dict</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-1919><a id=__codelineno-0-1919 name=__codelineno-0-1919></a>    <span class=n>augmentations</span><span class=p>:</span> <span class=nb>list</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=n>XYFlipModel</span><span class=p>,</span> <span class=n>XYRandomRotate90Model</span><span class=p>]]</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-1920><a id=__codelineno-0-1920 name=__codelineno-0-1920></a>    <span class=n>nm_paths</span><span class=p>:</span> <span class=nb>list</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-1921><a id=__codelineno-0-1921 name=__codelineno-0-1921></a>    <span class=n>data_stats</span><span class=p>:</span> <span class=nb>tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>]</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-1922><a id=__codelineno-0-1922 name=__codelineno-0-1922></a>    <span class=n>train_dataloader_params</span><span class=p>:</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-1923><a id=__codelineno-0-1923 name=__codelineno-0-1923></a>    <span class=n>val_dataloader_params</span><span class=p>:</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-1924><a id=__codelineno-0-1924 name=__codelineno-0-1924></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Configuration</span><span class=p>:</span>
</span><span id=__span-0-1925><a id=__codelineno-0-1925 name=__codelineno-0-1925></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-1926><a id=__codelineno-0-1926 name=__codelineno-0-1926></a><span class=sd>    Create a configuration for training MicroSplit.</span>
</span><span id=__span-0-1927><a id=__codelineno-0-1927 name=__codelineno-0-1927></a>
</span><span id=__span-0-1928><a id=__codelineno-0-1928 name=__codelineno-0-1928></a><span class=sd>    Parameters</span>
</span><span id=__span-0-1929><a id=__codelineno-0-1929 name=__codelineno-0-1929></a><span class=sd>    ----------</span>
</span><span id=__span-0-1930><a id=__codelineno-0-1930 name=__codelineno-0-1930></a><span class=sd>    experiment_name : str</span>
</span><span id=__span-0-1931><a id=__codelineno-0-1931 name=__codelineno-0-1931></a><span class=sd>        Name of the experiment.</span>
</span><span id=__span-0-1932><a id=__codelineno-0-1932 name=__codelineno-0-1932></a><span class=sd>    data_type : Literal[&quot;array&quot;, &quot;tiff&quot;, &quot;custom&quot;]</span>
</span><span id=__span-0-1933><a id=__codelineno-0-1933 name=__codelineno-0-1933></a><span class=sd>        Type of the data.</span>
</span><span id=__span-0-1934><a id=__codelineno-0-1934 name=__codelineno-0-1934></a><span class=sd>    axes : str</span>
</span><span id=__span-0-1935><a id=__codelineno-0-1935 name=__codelineno-0-1935></a><span class=sd>        Axes of the data (e.g. SYX).</span>
</span><span id=__span-0-1936><a id=__codelineno-0-1936 name=__codelineno-0-1936></a><span class=sd>    patch_size : Sequence[int]</span>
</span><span id=__span-0-1937><a id=__codelineno-0-1937 name=__codelineno-0-1937></a><span class=sd>        Size of the patches along the spatial dimensions (e.g. [64, 64]).</span>
</span><span id=__span-0-1938><a id=__codelineno-0-1938 name=__codelineno-0-1938></a><span class=sd>    batch_size : int</span>
</span><span id=__span-0-1939><a id=__codelineno-0-1939 name=__codelineno-0-1939></a><span class=sd>        Batch size.</span>
</span><span id=__span-0-1940><a id=__codelineno-0-1940 name=__codelineno-0-1940></a><span class=sd>    num_epochs : int, default=100</span>
</span><span id=__span-0-1941><a id=__codelineno-0-1941 name=__codelineno-0-1941></a><span class=sd>        Number of epochs to train for. If provided, this will be added to</span>
</span><span id=__span-0-1942><a id=__codelineno-0-1942 name=__codelineno-0-1942></a><span class=sd>        trainer_params.</span>
</span><span id=__span-0-1943><a id=__codelineno-0-1943 name=__codelineno-0-1943></a><span class=sd>    num_steps : int, optional</span>
</span><span id=__span-0-1944><a id=__codelineno-0-1944 name=__codelineno-0-1944></a><span class=sd>        Number of batches in 1 epoch. If provided, this will be added to trainer_params.</span>
</span><span id=__span-0-1945><a id=__codelineno-0-1945 name=__codelineno-0-1945></a><span class=sd>        Translates to `limit_train_batches` in PyTorch Lightning Trainer. See relevant</span>
</span><span id=__span-0-1946><a id=__codelineno-0-1946 name=__codelineno-0-1946></a><span class=sd>        documentation for more details.</span>
</span><span id=__span-0-1947><a id=__codelineno-0-1947 name=__codelineno-0-1947></a><span class=sd>    encoder_conv_strides : tuple[int, ...], optional</span>
</span><span id=__span-0-1948><a id=__codelineno-0-1948 name=__codelineno-0-1948></a><span class=sd>        Strides for the encoder convolutional layers, by default (2, 2).</span>
</span><span id=__span-0-1949><a id=__codelineno-0-1949 name=__codelineno-0-1949></a><span class=sd>    decoder_conv_strides : tuple[int, ...], optional</span>
</span><span id=__span-0-1950><a id=__codelineno-0-1950 name=__codelineno-0-1950></a><span class=sd>        Strides for the decoder convolutional layers, by default (2, 2).</span>
</span><span id=__span-0-1951><a id=__codelineno-0-1951 name=__codelineno-0-1951></a><span class=sd>    multiscale_count : int, optional</span>
</span><span id=__span-0-1952><a id=__codelineno-0-1952 name=__codelineno-0-1952></a><span class=sd>        Number of multiscale levels, by default 1.</span>
</span><span id=__span-0-1953><a id=__codelineno-0-1953 name=__codelineno-0-1953></a><span class=sd>    grid_size : int, optional</span>
</span><span id=__span-0-1954><a id=__codelineno-0-1954 name=__codelineno-0-1954></a><span class=sd>        Size of the grid for the lateral context, by default 32.</span>
</span><span id=__span-0-1955><a id=__codelineno-0-1955 name=__codelineno-0-1955></a><span class=sd>    z_dims : tuple[int, ...], optional</span>
</span><span id=__span-0-1956><a id=__codelineno-0-1956 name=__codelineno-0-1956></a><span class=sd>        List of latent dimensions for each hierarchy level in the LVAE, by default</span>
</span><span id=__span-0-1957><a id=__codelineno-0-1957 name=__codelineno-0-1957></a><span class=sd>        (128, 128).</span>
</span><span id=__span-0-1958><a id=__codelineno-0-1958 name=__codelineno-0-1958></a><span class=sd>    output_channels : int, optional</span>
</span><span id=__span-0-1959><a id=__codelineno-0-1959 name=__codelineno-0-1959></a><span class=sd>        Number of output channels for the model, by default 1.</span>
</span><span id=__span-0-1960><a id=__codelineno-0-1960 name=__codelineno-0-1960></a><span class=sd>    encoder_n_filters : int, optional</span>
</span><span id=__span-0-1961><a id=__codelineno-0-1961 name=__codelineno-0-1961></a><span class=sd>        Number of filters in the encoder, by default 32.</span>
</span><span id=__span-0-1962><a id=__codelineno-0-1962 name=__codelineno-0-1962></a><span class=sd>    decoder_n_filters : int, optional</span>
</span><span id=__span-0-1963><a id=__codelineno-0-1963 name=__codelineno-0-1963></a><span class=sd>        Number of filters in the decoder, by default 32.</span>
</span><span id=__span-0-1964><a id=__codelineno-0-1964 name=__codelineno-0-1964></a><span class=sd>    encoder_dropout : float, optional</span>
</span><span id=__span-0-1965><a id=__codelineno-0-1965 name=__codelineno-0-1965></a><span class=sd>        Dropout rate for the encoder, by default 0.0.</span>
</span><span id=__span-0-1966><a id=__codelineno-0-1966 name=__codelineno-0-1966></a><span class=sd>    decoder_dropout : float, optional</span>
</span><span id=__span-0-1967><a id=__codelineno-0-1967 name=__codelineno-0-1967></a><span class=sd>        Dropout rate for the decoder, by default 0.0.</span>
</span><span id=__span-0-1968><a id=__codelineno-0-1968 name=__codelineno-0-1968></a><span class=sd>    nonlinearity : Literal, optional</span>
</span><span id=__span-0-1969><a id=__codelineno-0-1969 name=__codelineno-0-1969></a><span class=sd>        Nonlinearity to use in the model, by default &quot;ReLU&quot;.</span>
</span><span id=__span-0-1970><a id=__codelineno-0-1970 name=__codelineno-0-1970></a><span class=sd>    analytical_kl : bool, optional</span>
</span><span id=__span-0-1971><a id=__codelineno-0-1971 name=__codelineno-0-1971></a><span class=sd>        Whether to use analytical KL divergence, by default False.</span>
</span><span id=__span-0-1972><a id=__codelineno-0-1972 name=__codelineno-0-1972></a><span class=sd>    predict_logvar : Literal[&quot;pixelwise&quot;] | None, optional</span>
</span><span id=__span-0-1973><a id=__codelineno-0-1973 name=__codelineno-0-1973></a><span class=sd>        Type of log-variance prediction, by default None.</span>
</span><span id=__span-0-1974><a id=__codelineno-0-1974 name=__codelineno-0-1974></a><span class=sd>    logvar_lowerbound : Union[float, None], optional</span>
</span><span id=__span-0-1975><a id=__codelineno-0-1975 name=__codelineno-0-1975></a><span class=sd>        Lower bound for the log variance, by default None.</span>
</span><span id=__span-0-1976><a id=__codelineno-0-1976 name=__codelineno-0-1976></a><span class=sd>    logger : Literal[&quot;wandb&quot;, &quot;tensorboard&quot;, &quot;none&quot;], optional</span>
</span><span id=__span-0-1977><a id=__codelineno-0-1977 name=__codelineno-0-1977></a><span class=sd>        Logger to use for training, by default &quot;none&quot;.</span>
</span><span id=__span-0-1978><a id=__codelineno-0-1978 name=__codelineno-0-1978></a><span class=sd>    trainer_params : dict, optional</span>
</span><span id=__span-0-1979><a id=__codelineno-0-1979 name=__codelineno-0-1979></a><span class=sd>        Parameters for the trainer class, see PyTorch Lightning documentation.</span>
</span><span id=__span-0-1980><a id=__codelineno-0-1980 name=__codelineno-0-1980></a><span class=sd>    augmentations : list[Union[XYFlipModel, XYRandomRotate90Model]] | None, optional</span>
</span><span id=__span-0-1981><a id=__codelineno-0-1981 name=__codelineno-0-1981></a><span class=sd>        List of augmentations to apply, by default None.</span>
</span><span id=__span-0-1982><a id=__codelineno-0-1982 name=__codelineno-0-1982></a><span class=sd>    nm_paths : list[str] | None, optional</span>
</span><span id=__span-0-1983><a id=__codelineno-0-1983 name=__codelineno-0-1983></a><span class=sd>        Paths to the noise model files, by default None.</span>
</span><span id=__span-0-1984><a id=__codelineno-0-1984 name=__codelineno-0-1984></a><span class=sd>    data_stats : tuple[float, float] | None, optional</span>
</span><span id=__span-0-1985><a id=__codelineno-0-1985 name=__codelineno-0-1985></a><span class=sd>        Data statistics (mean, std), by default None.</span>
</span><span id=__span-0-1986><a id=__codelineno-0-1986 name=__codelineno-0-1986></a><span class=sd>    train_dataloader_params : dict[str, Any] | None, optional</span>
</span><span id=__span-0-1987><a id=__codelineno-0-1987 name=__codelineno-0-1987></a><span class=sd>        Parameters for the training dataloader, by default None.</span>
</span><span id=__span-0-1988><a id=__codelineno-0-1988 name=__codelineno-0-1988></a><span class=sd>    val_dataloader_params : dict[str, Any] | None, optional</span>
</span><span id=__span-0-1989><a id=__codelineno-0-1989 name=__codelineno-0-1989></a><span class=sd>        Parameters for the validation dataloader, by default None.</span>
</span><span id=__span-0-1990><a id=__codelineno-0-1990 name=__codelineno-0-1990></a>
</span><span id=__span-0-1991><a id=__codelineno-0-1991 name=__codelineno-0-1991></a><span class=sd>    Returns</span>
</span><span id=__span-0-1992><a id=__codelineno-0-1992 name=__codelineno-0-1992></a><span class=sd>    -------</span>
</span><span id=__span-0-1993><a id=__codelineno-0-1993 name=__codelineno-0-1993></a><span class=sd>    Configuration</span>
</span><span id=__span-0-1994><a id=__codelineno-0-1994 name=__codelineno-0-1994></a><span class=sd>        A configuration object for the microsplit algorithm.</span>
</span><span id=__span-0-1995><a id=__codelineno-0-1995 name=__codelineno-0-1995></a>
</span><span id=__span-0-1996><a id=__codelineno-0-1996 name=__codelineno-0-1996></a><span class=sd>    Examples</span>
</span><span id=__span-0-1997><a id=__codelineno-0-1997 name=__codelineno-0-1997></a><span class=sd>    --------</span>
</span><span id=__span-0-1998><a id=__codelineno-0-1998 name=__codelineno-0-1998></a><span class=sd>    Minimum example:</span>
</span><span id=__span-0-1999><a id=__codelineno-0-1999 name=__codelineno-0-1999></a><span class=sd>    # &gt;&gt;&gt; config = create_microsplit_configuration(</span>
</span><span id=__span-0-2000><a id=__codelineno-0-2000 name=__codelineno-0-2000></a><span class=sd>    # ...     experiment_name=&quot;microsplit_experiment&quot;,</span>
</span><span id=__span-0-2001><a id=__codelineno-0-2001 name=__codelineno-0-2001></a><span class=sd>    # ...     data_type=&quot;array&quot;,</span>
</span><span id=__span-0-2002><a id=__codelineno-0-2002 name=__codelineno-0-2002></a><span class=sd>    # ...     axes=&quot;YX&quot;,</span>
</span><span id=__span-0-2003><a id=__codelineno-0-2003 name=__codelineno-0-2003></a><span class=sd>    # ...     patch_size=[64, 64],</span>
</span><span id=__span-0-2004><a id=__codelineno-0-2004 name=__codelineno-0-2004></a><span class=sd>    # ...     batch_size=32,</span>
</span><span id=__span-0-2005><a id=__codelineno-0-2005 name=__codelineno-0-2005></a><span class=sd>    # ...     num_epochs=100</span>
</span><span id=__span-0-2006><a id=__codelineno-0-2006 name=__codelineno-0-2006></a>
</span><span id=__span-0-2007><a id=__codelineno-0-2007 name=__codelineno-0-2007></a><span class=sd>    # ... )</span>
</span><span id=__span-0-2008><a id=__codelineno-0-2008 name=__codelineno-0-2008></a>
</span><span id=__span-0-2009><a id=__codelineno-0-2009 name=__codelineno-0-2009></a><span class=sd>    # You can also limit the number of batches per epoch:</span>
</span><span id=__span-0-2010><a id=__codelineno-0-2010 name=__codelineno-0-2010></a><span class=sd>    # &gt;&gt;&gt; config = create_microsplit_configuration(</span>
</span><span id=__span-0-2011><a id=__codelineno-0-2011 name=__codelineno-0-2011></a><span class=sd>    # ...     experiment_name=&quot;microsplit_experiment&quot;,</span>
</span><span id=__span-0-2012><a id=__codelineno-0-2012 name=__codelineno-0-2012></a><span class=sd>    # ...     data_type=&quot;array&quot;,</span>
</span><span id=__span-0-2013><a id=__codelineno-0-2013 name=__codelineno-0-2013></a><span class=sd>    # ...     axes=&quot;YX&quot;,</span>
</span><span id=__span-0-2014><a id=__codelineno-0-2014 name=__codelineno-0-2014></a><span class=sd>    # ...     patch_size=[64, 64],</span>
</span><span id=__span-0-2015><a id=__codelineno-0-2015 name=__codelineno-0-2015></a><span class=sd>    # ...     batch_size=32,</span>
</span><span id=__span-0-2016><a id=__codelineno-0-2016 name=__codelineno-0-2016></a><span class=sd>    # ...     num_steps=100  # limit to 100 batches per epoch</span>
</span><span id=__span-0-2017><a id=__codelineno-0-2017 name=__codelineno-0-2017></a><span class=sd>    # ... )</span>
</span><span id=__span-0-2018><a id=__codelineno-0-2018 name=__codelineno-0-2018></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-2019><a id=__codelineno-0-2019 name=__codelineno-0-2019></a>    <span class=n>transform_list</span> <span class=o>=</span> <span class=n>_list_spatial_augmentations</span><span class=p>(</span><span class=n>augmentations</span><span class=p>)</span>
</span><span id=__span-0-2020><a id=__codelineno-0-2020 name=__codelineno-0-2020></a>
</span><span id=__span-0-2021><a id=__codelineno-0-2021 name=__codelineno-0-2021></a>    <span class=n>loss_config</span> <span class=o>=</span> <span class=n>LVAELossConfig</span><span class=p>(</span>
</span><span id=__span-0-2022><a id=__codelineno-0-2022 name=__codelineno-0-2022></a>        <span class=n>loss_type</span><span class=o>=</span><span class=s2>&quot;denoisplit_musplit&quot;</span><span class=p>,</span> <span class=n>denoisplit_weight</span><span class=o>=</span><span class=mf>0.9</span><span class=p>,</span> <span class=n>musplit_weight</span><span class=o>=</span><span class=mf>0.1</span>
</span><span id=__span-0-2023><a id=__codelineno-0-2023 name=__codelineno-0-2023></a>    <span class=p>)</span>  <span class=c1># TODO losses need to be refactored! just for example. Add validator if sum to 1</span>
</span><span id=__span-0-2024><a id=__codelineno-0-2024 name=__codelineno-0-2024></a>
</span><span id=__span-0-2025><a id=__codelineno-0-2025 name=__codelineno-0-2025></a>    <span class=c1># Create likelihood configurations</span>
</span><span id=__span-0-2026><a id=__codelineno-0-2026 name=__codelineno-0-2026></a>    <span class=n>gaussian_likelihood_config</span><span class=p>,</span> <span class=n>noise_model_config</span><span class=p>,</span> <span class=n>nm_likelihood_config</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-2027><a id=__codelineno-0-2027 name=__codelineno-0-2027></a>        <span class=n>get_likelihood_config</span><span class=p>(</span>
</span><span id=__span-0-2028><a id=__codelineno-0-2028 name=__codelineno-0-2028></a>            <span class=n>loss_type</span><span class=o>=</span><span class=s2>&quot;denoisplit_musplit&quot;</span><span class=p>,</span>
</span><span id=__span-0-2029><a id=__codelineno-0-2029 name=__codelineno-0-2029></a>            <span class=n>predict_logvar</span><span class=o>=</span><span class=n>predict_logvar</span><span class=p>,</span>
</span><span id=__span-0-2030><a id=__codelineno-0-2030 name=__codelineno-0-2030></a>            <span class=n>logvar_lowerbound</span><span class=o>=</span><span class=n>logvar_lowerbound</span><span class=p>,</span>
</span><span id=__span-0-2031><a id=__codelineno-0-2031 name=__codelineno-0-2031></a>            <span class=n>nm_paths</span><span class=o>=</span><span class=n>nm_paths</span><span class=p>,</span>
</span><span id=__span-0-2032><a id=__codelineno-0-2032 name=__codelineno-0-2032></a>            <span class=n>data_stats</span><span class=o>=</span><span class=n>data_stats</span><span class=p>,</span>
</span><span id=__span-0-2033><a id=__codelineno-0-2033 name=__codelineno-0-2033></a>        <span class=p>)</span>
</span><span id=__span-0-2034><a id=__codelineno-0-2034 name=__codelineno-0-2034></a>    <span class=p>)</span>
</span><span id=__span-0-2035><a id=__codelineno-0-2035 name=__codelineno-0-2035></a>
</span><span id=__span-0-2036><a id=__codelineno-0-2036 name=__codelineno-0-2036></a>    <span class=c1># Create the LVAE model</span>
</span><span id=__span-0-2037><a id=__codelineno-0-2037 name=__codelineno-0-2037></a>    <span class=n>network_model</span> <span class=o>=</span> <span class=n>_create_vae_configuration</span><span class=p>(</span>
</span><span id=__span-0-2038><a id=__codelineno-0-2038 name=__codelineno-0-2038></a>        <span class=n>input_shape</span><span class=o>=</span><span class=n>patch_size</span><span class=p>,</span>
</span><span id=__span-0-2039><a id=__codelineno-0-2039 name=__codelineno-0-2039></a>        <span class=n>encoder_conv_strides</span><span class=o>=</span><span class=n>encoder_conv_strides</span><span class=p>,</span>
</span><span id=__span-0-2040><a id=__codelineno-0-2040 name=__codelineno-0-2040></a>        <span class=n>decoder_conv_strides</span><span class=o>=</span><span class=n>decoder_conv_strides</span><span class=p>,</span>
</span><span id=__span-0-2041><a id=__codelineno-0-2041 name=__codelineno-0-2041></a>        <span class=n>multiscale_count</span><span class=o>=</span><span class=n>multiscale_count</span><span class=p>,</span>
</span><span id=__span-0-2042><a id=__codelineno-0-2042 name=__codelineno-0-2042></a>        <span class=n>z_dims</span><span class=o>=</span><span class=n>z_dims</span><span class=p>,</span>
</span><span id=__span-0-2043><a id=__codelineno-0-2043 name=__codelineno-0-2043></a>        <span class=n>output_channels</span><span class=o>=</span><span class=n>output_channels</span><span class=p>,</span>
</span><span id=__span-0-2044><a id=__codelineno-0-2044 name=__codelineno-0-2044></a>        <span class=n>encoder_n_filters</span><span class=o>=</span><span class=n>encoder_n_filters</span><span class=p>,</span>
</span><span id=__span-0-2045><a id=__codelineno-0-2045 name=__codelineno-0-2045></a>        <span class=n>decoder_n_filters</span><span class=o>=</span><span class=n>decoder_n_filters</span><span class=p>,</span>
</span><span id=__span-0-2046><a id=__codelineno-0-2046 name=__codelineno-0-2046></a>        <span class=n>encoder_dropout</span><span class=o>=</span><span class=n>encoder_dropout</span><span class=p>,</span>
</span><span id=__span-0-2047><a id=__codelineno-0-2047 name=__codelineno-0-2047></a>        <span class=n>decoder_dropout</span><span class=o>=</span><span class=n>decoder_dropout</span><span class=p>,</span>
</span><span id=__span-0-2048><a id=__codelineno-0-2048 name=__codelineno-0-2048></a>        <span class=n>nonlinearity</span><span class=o>=</span><span class=n>nonlinearity</span><span class=p>,</span>
</span><span id=__span-0-2049><a id=__codelineno-0-2049 name=__codelineno-0-2049></a>        <span class=n>predict_logvar</span><span class=o>=</span><span class=n>predict_logvar</span><span class=p>,</span>
</span><span id=__span-0-2050><a id=__codelineno-0-2050 name=__codelineno-0-2050></a>        <span class=n>analytical_kl</span><span class=o>=</span><span class=n>analytical_kl</span><span class=p>,</span>
</span><span id=__span-0-2051><a id=__codelineno-0-2051 name=__codelineno-0-2051></a>    <span class=p>)</span>
</span><span id=__span-0-2052><a id=__codelineno-0-2052 name=__codelineno-0-2052></a>
</span><span id=__span-0-2053><a id=__codelineno-0-2053 name=__codelineno-0-2053></a>    <span class=c1># Create the MicroSplit algorithm configuration</span>
</span><span id=__span-0-2054><a id=__codelineno-0-2054 name=__codelineno-0-2054></a>    <span class=n>algorithm_params</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-0-2055><a id=__codelineno-0-2055 name=__codelineno-0-2055></a>        <span class=s2>&quot;algorithm&quot;</span><span class=p>:</span> <span class=s2>&quot;microsplit&quot;</span><span class=p>,</span>
</span><span id=__span-0-2056><a id=__codelineno-0-2056 name=__codelineno-0-2056></a>        <span class=s2>&quot;loss&quot;</span><span class=p>:</span> <span class=n>loss_config</span><span class=p>,</span>
</span><span id=__span-0-2057><a id=__codelineno-0-2057 name=__codelineno-0-2057></a>        <span class=s2>&quot;model&quot;</span><span class=p>:</span> <span class=n>network_model</span><span class=p>,</span>
</span><span id=__span-0-2058><a id=__codelineno-0-2058 name=__codelineno-0-2058></a>        <span class=s2>&quot;gaussian_likelihood&quot;</span><span class=p>:</span> <span class=n>gaussian_likelihood_config</span><span class=p>,</span>
</span><span id=__span-0-2059><a id=__codelineno-0-2059 name=__codelineno-0-2059></a>        <span class=s2>&quot;noise_model&quot;</span><span class=p>:</span> <span class=n>noise_model_config</span><span class=p>,</span>
</span><span id=__span-0-2060><a id=__codelineno-0-2060 name=__codelineno-0-2060></a>        <span class=s2>&quot;noise_model_likelihood&quot;</span><span class=p>:</span> <span class=n>nm_likelihood_config</span><span class=p>,</span>
</span><span id=__span-0-2061><a id=__codelineno-0-2061 name=__codelineno-0-2061></a>    <span class=p>}</span>
</span><span id=__span-0-2062><a id=__codelineno-0-2062 name=__codelineno-0-2062></a>
</span><span id=__span-0-2063><a id=__codelineno-0-2063 name=__codelineno-0-2063></a>    <span class=c1># Convert to MicroSplitAlgorithm instance</span>
</span><span id=__span-0-2064><a id=__codelineno-0-2064 name=__codelineno-0-2064></a>    <span class=n>algorithm_config</span> <span class=o>=</span> <span class=n>MicroSplitAlgorithm</span><span class=p>(</span><span class=o>**</span><span class=n>algorithm_params</span><span class=p>)</span>
</span><span id=__span-0-2065><a id=__codelineno-0-2065 name=__codelineno-0-2065></a>
</span><span id=__span-0-2066><a id=__codelineno-0-2066 name=__codelineno-0-2066></a>    <span class=c1># data</span>
</span><span id=__span-0-2067><a id=__codelineno-0-2067 name=__codelineno-0-2067></a>    <span class=n>data_params</span> <span class=o>=</span> <span class=n>_create_microsplit_data_configuration</span><span class=p>(</span>
</span><span id=__span-0-2068><a id=__codelineno-0-2068 name=__codelineno-0-2068></a>        <span class=n>data_type</span><span class=o>=</span><span class=n>data_type</span><span class=p>,</span>
</span><span id=__span-0-2069><a id=__codelineno-0-2069 name=__codelineno-0-2069></a>        <span class=n>axes</span><span class=o>=</span><span class=n>axes</span><span class=p>,</span>
</span><span id=__span-0-2070><a id=__codelineno-0-2070 name=__codelineno-0-2070></a>        <span class=n>patch_size</span><span class=o>=</span><span class=n>patch_size</span><span class=p>,</span>
</span><span id=__span-0-2071><a id=__codelineno-0-2071 name=__codelineno-0-2071></a>        <span class=n>grid_size</span><span class=o>=</span><span class=n>grid_size</span><span class=p>,</span>
</span><span id=__span-0-2072><a id=__codelineno-0-2072 name=__codelineno-0-2072></a>        <span class=n>multiscale_count</span><span class=o>=</span><span class=n>multiscale_count</span><span class=p>,</span>
</span><span id=__span-0-2073><a id=__codelineno-0-2073 name=__codelineno-0-2073></a>        <span class=n>batch_size</span><span class=o>=</span><span class=n>batch_size</span><span class=p>,</span>
</span><span id=__span-0-2074><a id=__codelineno-0-2074 name=__codelineno-0-2074></a>        <span class=n>augmentations</span><span class=o>=</span><span class=n>transform_list</span><span class=p>,</span>
</span><span id=__span-0-2075><a id=__codelineno-0-2075 name=__codelineno-0-2075></a>        <span class=n>train_dataloader_params</span><span class=o>=</span><span class=n>train_dataloader_params</span><span class=p>,</span>
</span><span id=__span-0-2076><a id=__codelineno-0-2076 name=__codelineno-0-2076></a>        <span class=n>val_dataloader_params</span><span class=o>=</span><span class=n>val_dataloader_params</span><span class=p>,</span>
</span><span id=__span-0-2077><a id=__codelineno-0-2077 name=__codelineno-0-2077></a>    <span class=p>)</span>
</span><span id=__span-0-2078><a id=__codelineno-0-2078 name=__codelineno-0-2078></a>
</span><span id=__span-0-2079><a id=__codelineno-0-2079 name=__codelineno-0-2079></a>    <span class=c1># Handle trainer parameters with num_epochs and num_steps</span>
</span><span id=__span-0-2080><a id=__codelineno-0-2080 name=__codelineno-0-2080></a>    <span class=n>final_trainer_params</span> <span class=o>=</span> <span class=p>{}</span> <span class=k>if</span> <span class=n>trainer_params</span> <span class=ow>is</span> <span class=kc>None</span> <span class=k>else</span> <span class=n>trainer_params</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span><span id=__span-0-2081><a id=__codelineno-0-2081 name=__codelineno-0-2081></a>
</span><span id=__span-0-2082><a id=__codelineno-0-2082 name=__codelineno-0-2082></a>    <span class=c1># Add num_epochs and num_steps if provided</span>
</span><span id=__span-0-2083><a id=__codelineno-0-2083 name=__codelineno-0-2083></a>    <span class=k>if</span> <span class=n>num_epochs</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-2084><a id=__codelineno-0-2084 name=__codelineno-0-2084></a>        <span class=n>final_trainer_params</span><span class=p>[</span><span class=s2>&quot;max_epochs&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>num_epochs</span>
</span><span id=__span-0-2085><a id=__codelineno-0-2085 name=__codelineno-0-2085></a>    <span class=k>if</span> <span class=n>num_steps</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-2086><a id=__codelineno-0-2086 name=__codelineno-0-2086></a>        <span class=n>final_trainer_params</span><span class=p>[</span><span class=s2>&quot;limit_train_batches&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>num_steps</span>
</span><span id=__span-0-2087><a id=__codelineno-0-2087 name=__codelineno-0-2087></a>
</span><span id=__span-0-2088><a id=__codelineno-0-2088 name=__codelineno-0-2088></a>    <span class=c1># training</span>
</span><span id=__span-0-2089><a id=__codelineno-0-2089 name=__codelineno-0-2089></a>    <span class=n>training_params</span> <span class=o>=</span> <span class=n>_create_training_configuration</span><span class=p>(</span>
</span><span id=__span-0-2090><a id=__codelineno-0-2090 name=__codelineno-0-2090></a>        <span class=n>trainer_params</span><span class=o>=</span><span class=n>final_trainer_params</span><span class=p>,</span>
</span><span id=__span-0-2091><a id=__codelineno-0-2091 name=__codelineno-0-2091></a>        <span class=n>logger</span><span class=o>=</span><span class=n>logger</span><span class=p>,</span>
</span><span id=__span-0-2092><a id=__codelineno-0-2092 name=__codelineno-0-2092></a>    <span class=p>)</span>
</span><span id=__span-0-2093><a id=__codelineno-0-2093 name=__codelineno-0-2093></a>
</span><span id=__span-0-2094><a id=__codelineno-0-2094 name=__codelineno-0-2094></a>    <span class=k>return</span> <span class=n>Configuration</span><span class=p>(</span>
</span><span id=__span-0-2095><a id=__codelineno-0-2095 name=__codelineno-0-2095></a>        <span class=n>experiment_name</span><span class=o>=</span><span class=n>experiment_name</span><span class=p>,</span>
</span><span id=__span-0-2096><a id=__codelineno-0-2096 name=__codelineno-0-2096></a>        <span class=n>algorithm_config</span><span class=o>=</span><span class=n>algorithm_config</span><span class=p>,</span>
</span><span id=__span-0-2097><a id=__codelineno-0-2097 name=__codelineno-0-2097></a>        <span class=n>data_config</span><span class=o>=</span><span class=n>data_params</span><span class=p>,</span>
</span><span id=__span-0-2098><a id=__codelineno-0-2098 name=__codelineno-0-2098></a>        <span class=n>training_config</span><span class=o>=</span><span class=n>training_params</span><span class=p>,</span>
</span><span id=__span-0-2099><a id=__codelineno-0-2099 name=__codelineno-0-2099></a>    <span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=careamics.config.configuration_factories.create_n2n_configuration class="doc doc-heading"> <code class="highlight language-python"><span class=n>create_n2n_configuration</span><span class=p>(</span><span class=n>experiment_name</span><span class=p>,</span> <span class=n>data_type</span><span class=p>,</span> <span class=n>axes</span><span class=p>,</span> <span class=n>patch_size</span><span class=p>,</span> <span class=n>batch_size</span><span class=p>,</span> <span class=n>num_epochs</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>num_steps</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>augmentations</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>independent_channels</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>loss</span><span class=o>=</span><span class=s1>&#39;mae&#39;</span><span class=p>,</span> <span class=n>n_channels_in</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>n_channels_out</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=s1>&#39;none&#39;</span><span class=p>,</span> <span class=n>trainer_params</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>model_params</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>optimizer</span><span class=o>=</span><span class=s1>&#39;Adam&#39;</span><span class=p>,</span> <span class=n>optimizer_params</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>lr_scheduler</span><span class=o>=</span><span class=s1>&#39;ReduceLROnPlateau&#39;</span><span class=p>,</span> <span class=n>lr_scheduler_params</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>train_dataloader_params</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>val_dataloader_params</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>checkpoint_params</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#careamics.config.configuration_factories.create_n2n_configuration class=headerlink title="Permanent link">#</a></h2> <div class="doc doc-contents "> <p>Create a configuration for training Noise2Noise.</p> <p>If "Z" is present in <code>axes</code>, then <code>path_size</code> must be a list of length 3, otherwise 2.</p> <p>If "C" is present in <code>axes</code>, then you need to set <code>n_channels_in</code> to the number of channels. Likewise, if you set the number of channels, then "C" must be present in <code>axes</code>.</p> <p>To set the number of output channels, use the <code>n_channels_out</code> parameter. If it is not specified, it will be assumed to be equal to <code>n_channels_in</code>.</p> <p>By default, all channels are trained together. To train all channels independently, set <code>independent_channels</code> to True.</p> <p>By setting <code>augmentations</code> to <code>None</code>, the default transformations (flip in X and Y, rotations by 90 degrees in the XY plane) are applied. Rather than the default transforms, a list of transforms can be passed to the <code>augmentations</code> parameter. To disable the transforms, simply pass an empty list.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>experiment_name</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>Name of the experiment.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>data_type</code> </td> <td> <code><span title=typing.Literal>Literal</span>[&#39;array&#39;, &#39;tiff&#39;, &#39;czi&#39;, &#39;custom&#39;]</code> </td> <td> <div class=doc-md-description> <p>Type of the data.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>axes</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>Axes of the data (e.g. SYX).</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>patch_size</code> </td> <td> <code><span title=List>List</span>[<span title=int>int</span>]</code> </td> <td> <div class=doc-md-description> <p>Size of the patches along the spatial dimensions (e.g. [64, 64]).</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>batch_size</code> </td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>Batch size.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>num_epochs</code> </td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>Number of epochs to train for. If provided, this will be added to trainer_params.</p> </div> </td> <td> <code>100</code> </td> </tr> <tr class=doc-section-item> <td> <code>num_steps</code> </td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>Number of batches in 1 epoch. If provided, this will be added to trainer_params. Translates to <code>limit_train_batches</code> in PyTorch Lightning Trainer. See relevant documentation for more details.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>augmentations</code> </td> <td> <code>list of transforms</code> </td> <td> <div class=doc-md-description> <p>List of transforms to apply, either both or one of XYFlipModel and XYRandomRotate90Model. By default, it applies both XYFlip (on X and Y) and XYRandomRotate90 (in XY) to the images.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>independent_channels</code> </td> <td> <code><span title=bool>bool</span></code> </td> <td> <div class=doc-md-description> <p>Whether to train all channels independently, by default False.</p> </div> </td> <td> <code>True</code> </td> </tr> <tr class=doc-section-item> <td> <code>loss</code> </td> <td> <code><span title=typing.Literal>Literal</span>[&#39;mae&#39;, &#39;mse&#39;]</code> </td> <td> <div class=doc-md-description> <p>Loss function to use, by default "mae".</p> </div> </td> <td> <code>&#39;mae&#39;</code> </td> </tr> <tr class=doc-section-item> <td> <code>n_channels_in</code> </td> <td> <code><span title=int>int</span> or None</code> </td> <td> <div class=doc-md-description> <p>Number of channels in.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>n_channels_out</code> </td> <td> <code><span title=int>int</span> or None</code> </td> <td> <div class=doc-md-description> <p>Number of channels out.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>logger</code> </td> <td> <code><span title=typing.Literal>Literal</span>[&#39;wandb&#39;, &#39;tensorboard&#39;, &#39;none&#39;]</code> </td> <td> <div class=doc-md-description> <p>Logger to use, by default "none".</p> </div> </td> <td> <code>&#39;none&#39;</code> </td> </tr> <tr class=doc-section-item> <td> <code>trainer_params</code> </td> <td> <code><span title=dict>dict</span></code> </td> <td> <div class=doc-md-description> <p>Parameters for the trainer class, see PyTorch Lightning documentation.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>model_params</code> </td> <td> <code><span title=dict>dict</span></code> </td> <td> <div class=doc-md-description> <p>UNetModel parameters.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>optimizer</code> </td> <td> <code><span title=typing.Literal>Literal</span>[&#39;Adam&#39;, &#39;Adamax&#39;, &#39;SGD&#39;]</code> </td> <td> <div class=doc-md-description> <p>Optimizer to use.</p> </div> </td> <td> <code>&#34;Adam&#34;</code> </td> </tr> <tr class=doc-section-item> <td> <code>optimizer_params</code> </td> <td> <code><span title=dict>dict</span></code> </td> <td> <div class=doc-md-description> <p>Parameters for the optimizer, see PyTorch documentation for more details.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>lr_scheduler</code> </td> <td> <code><span title=typing.Literal>Literal</span>[&#39;ReduceLROnPlateau&#39;, &#39;StepLR&#39;]</code> </td> <td> <div class=doc-md-description> <p>Learning rate scheduler to use.</p> </div> </td> <td> <code>&#34;ReduceLROnPlateau&#34;</code> </td> </tr> <tr class=doc-section-item> <td> <code>lr_scheduler_params</code> </td> <td> <code><span title=dict>dict</span></code> </td> <td> <div class=doc-md-description> <p>Parameters for the learning rate scheduler, see PyTorch documentation for more details.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>train_dataloader_params</code> </td> <td> <code><span title=dict>dict</span></code> </td> <td> <div class=doc-md-description> <p>Parameters for the training dataloader, see the PyTorch docs for <code>DataLoader</code>. If left as <code>None</code>, the dict <code>{"shuffle": True}</code> will be used, this is set in the <code>GeneralDataConfig</code>.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>val_dataloader_params</code> </td> <td> <code><span title=dict>dict</span></code> </td> <td> <div class=doc-md-description> <p>Parameters for the validation dataloader, see PyTorch the docs for <code>DataLoader</code>. If left as <code>None</code>, the empty dict <code>{}</code> will be used, this is set in the <code>GeneralDataConfig</code>.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>checkpoint_params</code> </td> <td> <code><span title=dict>dict</span></code> </td> <td> <div class=doc-md-description> <p>Parameters for the checkpoint callback, see PyTorch Lightning documentation (<code>ModelCheckpoint</code>) for the list of available parameters.</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-internal" title="Configuration (careamics.config.configuration.Configuration)" href=../configuration/#careamics.config.configuration.Configuration>Configuration</a></code> </td> <td> <div class=doc-md-description> <p>Configuration for training Noise2Noise.</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Examples:</span></p> <p>Minimum example:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>config</span> <span class=o>=</span> <span class=n>create_n2n_configuration</span><span class=p>(</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=gp>... </span>    <span class=n>experiment_name</span><span class=o>=</span><span class=s2>&quot;n2n_experiment&quot;</span><span class=p>,</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=gp>... </span>    <span class=n>data_type</span><span class=o>=</span><span class=s2>&quot;array&quot;</span><span class=p>,</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=gp>... </span>    <span class=n>axes</span><span class=o>=</span><span class=s2>&quot;YX&quot;</span><span class=p>,</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=gp>... </span>    <span class=n>patch_size</span><span class=o>=</span><span class=p>[</span><span class=mi>64</span><span class=p>,</span> <span class=mi>64</span><span class=p>],</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=gp>... </span>    <span class=n>batch_size</span><span class=o>=</span><span class=mi>32</span><span class=p>,</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=gp>... </span>    <span class=n>num_epochs</span><span class=o>=</span><span class=mi>100</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a><span class=gp>... </span><span class=p>)</span>
</span></code></pre></div> <p>You can also limit the number of batches per epoch:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>config</span> <span class=o>=</span> <span class=n>create_n2n_configuration</span><span class=p>(</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=gp>... </span>    <span class=n>experiment_name</span><span class=o>=</span><span class=s2>&quot;n2n_experiment&quot;</span><span class=p>,</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=gp>... </span>    <span class=n>data_type</span><span class=o>=</span><span class=s2>&quot;array&quot;</span><span class=p>,</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=gp>... </span>    <span class=n>axes</span><span class=o>=</span><span class=s2>&quot;YX&quot;</span><span class=p>,</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=gp>... </span>    <span class=n>patch_size</span><span class=o>=</span><span class=p>[</span><span class=mi>64</span><span class=p>,</span> <span class=mi>64</span><span class=p>],</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=gp>... </span>    <span class=n>batch_size</span><span class=o>=</span><span class=mi>32</span><span class=p>,</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=gp>... </span>    <span class=n>num_steps</span><span class=o>=</span><span class=mi>100</span>  <span class=c1># limit to 100 batches per epoch</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a><span class=gp>... </span><span class=p>)</span>
</span></code></pre></div> <p>To disable transforms, simply set <code>augmentations</code> to an empty list:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>config</span> <span class=o>=</span> <span class=n>create_n2n_configuration</span><span class=p>(</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=gp>... </span>    <span class=n>experiment_name</span><span class=o>=</span><span class=s2>&quot;n2n_experiment&quot;</span><span class=p>,</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=gp>... </span>    <span class=n>data_type</span><span class=o>=</span><span class=s2>&quot;array&quot;</span><span class=p>,</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=gp>... </span>    <span class=n>axes</span><span class=o>=</span><span class=s2>&quot;YX&quot;</span><span class=p>,</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=gp>... </span>    <span class=n>patch_size</span><span class=o>=</span><span class=p>[</span><span class=mi>64</span><span class=p>,</span> <span class=mi>64</span><span class=p>],</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=gp>... </span>    <span class=n>batch_size</span><span class=o>=</span><span class=mi>32</span><span class=p>,</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=gp>... </span>    <span class=n>num_epochs</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a><span class=gp>... </span>    <span class=n>augmentations</span><span class=o>=</span><span class=p>[]</span>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a><span class=gp>... </span><span class=p>)</span>
</span></code></pre></div> <p>A list of transforms can be passed to the <code>augmentations</code> parameter:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span><span class=w> </span><span class=nn>careamics.config.transformations</span><span class=w> </span><span class=kn>import</span> <span class=n>XYFlipModel</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=gp>&gt;&gt;&gt; </span><span class=n>config</span> <span class=o>=</span> <span class=n>create_n2n_configuration</span><span class=p>(</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=gp>... </span>    <span class=n>experiment_name</span><span class=o>=</span><span class=s2>&quot;n2n_experiment&quot;</span><span class=p>,</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=gp>... </span>    <span class=n>data_type</span><span class=o>=</span><span class=s2>&quot;array&quot;</span><span class=p>,</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=gp>... </span>    <span class=n>axes</span><span class=o>=</span><span class=s2>&quot;YX&quot;</span><span class=p>,</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=gp>... </span>    <span class=n>patch_size</span><span class=o>=</span><span class=p>[</span><span class=mi>64</span><span class=p>,</span> <span class=mi>64</span><span class=p>],</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=gp>... </span>    <span class=n>batch_size</span><span class=o>=</span><span class=mi>32</span><span class=p>,</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a><span class=gp>... </span>    <span class=n>num_epochs</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a><span class=gp>... </span>    <span class=n>augmentations</span><span class=o>=</span><span class=p>[</span>
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a><span class=gp>... </span>        <span class=c1># No rotation and only Y flipping</span>
</span><span id=__span-0-11><a id=__codelineno-0-11 name=__codelineno-0-11 href=#__codelineno-0-11></a><span class=gp>... </span>        <span class=n>XYFlipModel</span><span class=p>(</span><span class=n>flip_x</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span> <span class=n>flip_y</span> <span class=o>=</span> <span class=kc>True</span><span class=p>)</span>
</span><span id=__span-0-12><a id=__codelineno-0-12 name=__codelineno-0-12 href=#__codelineno-0-12></a><span class=gp>... </span>    <span class=p>]</span>
</span><span id=__span-0-13><a id=__codelineno-0-13 name=__codelineno-0-13 href=#__codelineno-0-13></a><span class=gp>... </span><span class=p>)</span>
</span></code></pre></div> <p>If you are training multiple channels they will be trained independently by default, you simply need to specify the number of channels input (and optionally, the number of channels output):</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>config</span> <span class=o>=</span> <span class=n>create_n2n_configuration</span><span class=p>(</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=gp>... </span>    <span class=n>experiment_name</span><span class=o>=</span><span class=s2>&quot;n2n_experiment&quot;</span><span class=p>,</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=gp>... </span>    <span class=n>data_type</span><span class=o>=</span><span class=s2>&quot;array&quot;</span><span class=p>,</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=gp>... </span>    <span class=n>axes</span><span class=o>=</span><span class=s2>&quot;YXC&quot;</span><span class=p>,</span> <span class=c1># channels must be in the axes</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=gp>... </span>    <span class=n>patch_size</span><span class=o>=</span><span class=p>[</span><span class=mi>64</span><span class=p>,</span> <span class=mi>64</span><span class=p>],</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=gp>... </span>    <span class=n>batch_size</span><span class=o>=</span><span class=mi>32</span><span class=p>,</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=gp>... </span>    <span class=n>num_epochs</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a><span class=gp>... </span>    <span class=n>n_channels_in</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span> <span class=c1># number of input channels</span>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a><span class=gp>... </span>    <span class=n>n_channels_out</span><span class=o>=</span><span class=mi>1</span> <span class=c1># if applicable</span>
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a><span class=gp>... </span><span class=p>)</span>
</span></code></pre></div> <p>If instead you want to train multiple channels together, you need to turn off the <code>independent_channels</code> parameter:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>config</span> <span class=o>=</span> <span class=n>create_n2n_configuration</span><span class=p>(</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=gp>... </span>    <span class=n>experiment_name</span><span class=o>=</span><span class=s2>&quot;n2n_experiment&quot;</span><span class=p>,</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=gp>... </span>    <span class=n>data_type</span><span class=o>=</span><span class=s2>&quot;array&quot;</span><span class=p>,</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=gp>... </span>    <span class=n>axes</span><span class=o>=</span><span class=s2>&quot;YXC&quot;</span><span class=p>,</span> <span class=c1># channels must be in the axes</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=gp>... </span>    <span class=n>patch_size</span><span class=o>=</span><span class=p>[</span><span class=mi>64</span><span class=p>,</span> <span class=mi>64</span><span class=p>],</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=gp>... </span>    <span class=n>batch_size</span><span class=o>=</span><span class=mi>32</span><span class=p>,</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=gp>... </span>    <span class=n>num_epochs</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a><span class=gp>... </span>    <span class=n>independent_channels</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a><span class=gp>... </span>    <span class=n>n_channels_in</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span>
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a><span class=gp>... </span>    <span class=n>n_channels_out</span><span class=o>=</span><span class=mi>1</span> <span class=c1># if applicable</span>
</span><span id=__span-0-11><a id=__codelineno-0-11 name=__codelineno-0-11 href=#__codelineno-0-11></a><span class=gp>... </span><span class=p>)</span>
</span></code></pre></div> <p>If you would like to train on CZI files, use <code>"czi"</code> as <code>data_type</code> and <code>"SCYX"</code> as <code>axes</code> for 2-D or <code>"SCZYX"</code> for 3-D denoising. Note that <code>"SCYX"</code> can also be used for 3-D data but spatial context along the Z dimension will then not be taken into account.</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>config_2d</span> <span class=o>=</span> <span class=n>create_n2n_configuration</span><span class=p>(</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=gp>... </span>    <span class=n>experiment_name</span><span class=o>=</span><span class=s2>&quot;n2n_experiment&quot;</span><span class=p>,</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=gp>... </span>    <span class=n>data_type</span><span class=o>=</span><span class=s2>&quot;czi&quot;</span><span class=p>,</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=gp>... </span>    <span class=n>axes</span><span class=o>=</span><span class=s2>&quot;SCYX&quot;</span><span class=p>,</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=gp>... </span>    <span class=n>patch_size</span><span class=o>=</span><span class=p>[</span><span class=mi>64</span><span class=p>,</span> <span class=mi>64</span><span class=p>],</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=gp>... </span>    <span class=n>batch_size</span><span class=o>=</span><span class=mi>32</span><span class=p>,</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=gp>... </span>    <span class=n>num_epochs</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a><span class=gp>... </span>    <span class=n>n_channels_in</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a><span class=gp>&gt;&gt;&gt; </span><span class=n>config_3d</span> <span class=o>=</span> <span class=n>create_n2n_configuration</span><span class=p>(</span>
</span><span id=__span-0-11><a id=__codelineno-0-11 name=__codelineno-0-11 href=#__codelineno-0-11></a><span class=gp>... </span>    <span class=n>experiment_name</span><span class=o>=</span><span class=s2>&quot;n2n_experiment&quot;</span><span class=p>,</span>
</span><span id=__span-0-12><a id=__codelineno-0-12 name=__codelineno-0-12 href=#__codelineno-0-12></a><span class=gp>... </span>    <span class=n>data_type</span><span class=o>=</span><span class=s2>&quot;czi&quot;</span><span class=p>,</span>
</span><span id=__span-0-13><a id=__codelineno-0-13 name=__codelineno-0-13 href=#__codelineno-0-13></a><span class=gp>... </span>    <span class=n>axes</span><span class=o>=</span><span class=s2>&quot;SCZYX&quot;</span><span class=p>,</span>
</span><span id=__span-0-14><a id=__codelineno-0-14 name=__codelineno-0-14 href=#__codelineno-0-14></a><span class=gp>... </span>    <span class=n>patch_size</span><span class=o>=</span><span class=p>[</span><span class=mi>16</span><span class=p>,</span> <span class=mi>64</span><span class=p>,</span> <span class=mi>64</span><span class=p>],</span>
</span><span id=__span-0-15><a id=__codelineno-0-15 name=__codelineno-0-15 href=#__codelineno-0-15></a><span class=gp>... </span>    <span class=n>batch_size</span><span class=o>=</span><span class=mi>16</span><span class=p>,</span>
</span><span id=__span-0-16><a id=__codelineno-0-16 name=__codelineno-0-16 href=#__codelineno-0-16></a><span class=gp>... </span>    <span class=n>num_epochs</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span>
</span><span id=__span-0-17><a id=__codelineno-0-17 name=__codelineno-0-17 href=#__codelineno-0-17></a><span class=gp>... </span>    <span class=n>n_channels_in</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
</span><span id=__span-0-18><a id=__codelineno-0-18 name=__codelineno-0-18 href=#__codelineno-0-18></a><span class=gp>... </span><span class=p>)</span>
</span></code></pre></div> <details class=quote> <summary>Source code in <code>src/careamics/config/configuration_factories.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-867> 867</a></span>
<span class=normal><a href=#__codelineno-0-868> 868</a></span>
<span class=normal><a href=#__codelineno-0-869> 869</a></span>
<span class=normal><a href=#__codelineno-0-870> 870</a></span>
<span class=normal><a href=#__codelineno-0-871> 871</a></span>
<span class=normal><a href=#__codelineno-0-872> 872</a></span>
<span class=normal><a href=#__codelineno-0-873> 873</a></span>
<span class=normal><a href=#__codelineno-0-874> 874</a></span>
<span class=normal><a href=#__codelineno-0-875> 875</a></span>
<span class=normal><a href=#__codelineno-0-876> 876</a></span>
<span class=normal><a href=#__codelineno-0-877> 877</a></span>
<span class=normal><a href=#__codelineno-0-878> 878</a></span>
<span class=normal><a href=#__codelineno-0-879> 879</a></span>
<span class=normal><a href=#__codelineno-0-880> 880</a></span>
<span class=normal><a href=#__codelineno-0-881> 881</a></span>
<span class=normal><a href=#__codelineno-0-882> 882</a></span>
<span class=normal><a href=#__codelineno-0-883> 883</a></span>
<span class=normal><a href=#__codelineno-0-884> 884</a></span>
<span class=normal><a href=#__codelineno-0-885> 885</a></span>
<span class=normal><a href=#__codelineno-0-886> 886</a></span>
<span class=normal><a href=#__codelineno-0-887> 887</a></span>
<span class=normal><a href=#__codelineno-0-888> 888</a></span>
<span class=normal><a href=#__codelineno-0-889> 889</a></span>
<span class=normal><a href=#__codelineno-0-890> 890</a></span>
<span class=normal><a href=#__codelineno-0-891> 891</a></span>
<span class=normal><a href=#__codelineno-0-892> 892</a></span>
<span class=normal><a href=#__codelineno-0-893> 893</a></span>
<span class=normal><a href=#__codelineno-0-894> 894</a></span>
<span class=normal><a href=#__codelineno-0-895> 895</a></span>
<span class=normal><a href=#__codelineno-0-896> 896</a></span>
<span class=normal><a href=#__codelineno-0-897> 897</a></span>
<span class=normal><a href=#__codelineno-0-898> 898</a></span>
<span class=normal><a href=#__codelineno-0-899> 899</a></span>
<span class=normal><a href=#__codelineno-0-900> 900</a></span>
<span class=normal><a href=#__codelineno-0-901> 901</a></span>
<span class=normal><a href=#__codelineno-0-902> 902</a></span>
<span class=normal><a href=#__codelineno-0-903> 903</a></span>
<span class=normal><a href=#__codelineno-0-904> 904</a></span>
<span class=normal><a href=#__codelineno-0-905> 905</a></span>
<span class=normal><a href=#__codelineno-0-906> 906</a></span>
<span class=normal><a href=#__codelineno-0-907> 907</a></span>
<span class=normal><a href=#__codelineno-0-908> 908</a></span>
<span class=normal><a href=#__codelineno-0-909> 909</a></span>
<span class=normal><a href=#__codelineno-0-910> 910</a></span>
<span class=normal><a href=#__codelineno-0-911> 911</a></span>
<span class=normal><a href=#__codelineno-0-912> 912</a></span>
<span class=normal><a href=#__codelineno-0-913> 913</a></span>
<span class=normal><a href=#__codelineno-0-914> 914</a></span>
<span class=normal><a href=#__codelineno-0-915> 915</a></span>
<span class=normal><a href=#__codelineno-0-916> 916</a></span>
<span class=normal><a href=#__codelineno-0-917> 917</a></span>
<span class=normal><a href=#__codelineno-0-918> 918</a></span>
<span class=normal><a href=#__codelineno-0-919> 919</a></span>
<span class=normal><a href=#__codelineno-0-920> 920</a></span>
<span class=normal><a href=#__codelineno-0-921> 921</a></span>
<span class=normal><a href=#__codelineno-0-922> 922</a></span>
<span class=normal><a href=#__codelineno-0-923> 923</a></span>
<span class=normal><a href=#__codelineno-0-924> 924</a></span>
<span class=normal><a href=#__codelineno-0-925> 925</a></span>
<span class=normal><a href=#__codelineno-0-926> 926</a></span>
<span class=normal><a href=#__codelineno-0-927> 927</a></span>
<span class=normal><a href=#__codelineno-0-928> 928</a></span>
<span class=normal><a href=#__codelineno-0-929> 929</a></span>
<span class=normal><a href=#__codelineno-0-930> 930</a></span>
<span class=normal><a href=#__codelineno-0-931> 931</a></span>
<span class=normal><a href=#__codelineno-0-932> 932</a></span>
<span class=normal><a href=#__codelineno-0-933> 933</a></span>
<span class=normal><a href=#__codelineno-0-934> 934</a></span>
<span class=normal><a href=#__codelineno-0-935> 935</a></span>
<span class=normal><a href=#__codelineno-0-936> 936</a></span>
<span class=normal><a href=#__codelineno-0-937> 937</a></span>
<span class=normal><a href=#__codelineno-0-938> 938</a></span>
<span class=normal><a href=#__codelineno-0-939> 939</a></span>
<span class=normal><a href=#__codelineno-0-940> 940</a></span>
<span class=normal><a href=#__codelineno-0-941> 941</a></span>
<span class=normal><a href=#__codelineno-0-942> 942</a></span>
<span class=normal><a href=#__codelineno-0-943> 943</a></span>
<span class=normal><a href=#__codelineno-0-944> 944</a></span>
<span class=normal><a href=#__codelineno-0-945> 945</a></span>
<span class=normal><a href=#__codelineno-0-946> 946</a></span>
<span class=normal><a href=#__codelineno-0-947> 947</a></span>
<span class=normal><a href=#__codelineno-0-948> 948</a></span>
<span class=normal><a href=#__codelineno-0-949> 949</a></span>
<span class=normal><a href=#__codelineno-0-950> 950</a></span>
<span class=normal><a href=#__codelineno-0-951> 951</a></span>
<span class=normal><a href=#__codelineno-0-952> 952</a></span>
<span class=normal><a href=#__codelineno-0-953> 953</a></span>
<span class=normal><a href=#__codelineno-0-954> 954</a></span>
<span class=normal><a href=#__codelineno-0-955> 955</a></span>
<span class=normal><a href=#__codelineno-0-956> 956</a></span>
<span class=normal><a href=#__codelineno-0-957> 957</a></span>
<span class=normal><a href=#__codelineno-0-958> 958</a></span>
<span class=normal><a href=#__codelineno-0-959> 959</a></span>
<span class=normal><a href=#__codelineno-0-960> 960</a></span>
<span class=normal><a href=#__codelineno-0-961> 961</a></span>
<span class=normal><a href=#__codelineno-0-962> 962</a></span>
<span class=normal><a href=#__codelineno-0-963> 963</a></span>
<span class=normal><a href=#__codelineno-0-964> 964</a></span>
<span class=normal><a href=#__codelineno-0-965> 965</a></span>
<span class=normal><a href=#__codelineno-0-966> 966</a></span>
<span class=normal><a href=#__codelineno-0-967> 967</a></span>
<span class=normal><a href=#__codelineno-0-968> 968</a></span>
<span class=normal><a href=#__codelineno-0-969> 969</a></span>
<span class=normal><a href=#__codelineno-0-970> 970</a></span>
<span class=normal><a href=#__codelineno-0-971> 971</a></span>
<span class=normal><a href=#__codelineno-0-972> 972</a></span>
<span class=normal><a href=#__codelineno-0-973> 973</a></span>
<span class=normal><a href=#__codelineno-0-974> 974</a></span>
<span class=normal><a href=#__codelineno-0-975> 975</a></span>
<span class=normal><a href=#__codelineno-0-976> 976</a></span>
<span class=normal><a href=#__codelineno-0-977> 977</a></span>
<span class=normal><a href=#__codelineno-0-978> 978</a></span>
<span class=normal><a href=#__codelineno-0-979> 979</a></span>
<span class=normal><a href=#__codelineno-0-980> 980</a></span>
<span class=normal><a href=#__codelineno-0-981> 981</a></span>
<span class=normal><a href=#__codelineno-0-982> 982</a></span>
<span class=normal><a href=#__codelineno-0-983> 983</a></span>
<span class=normal><a href=#__codelineno-0-984> 984</a></span>
<span class=normal><a href=#__codelineno-0-985> 985</a></span>
<span class=normal><a href=#__codelineno-0-986> 986</a></span>
<span class=normal><a href=#__codelineno-0-987> 987</a></span>
<span class=normal><a href=#__codelineno-0-988> 988</a></span>
<span class=normal><a href=#__codelineno-0-989> 989</a></span>
<span class=normal><a href=#__codelineno-0-990> 990</a></span>
<span class=normal><a href=#__codelineno-0-991> 991</a></span>
<span class=normal><a href=#__codelineno-0-992> 992</a></span>
<span class=normal><a href=#__codelineno-0-993> 993</a></span>
<span class=normal><a href=#__codelineno-0-994> 994</a></span>
<span class=normal><a href=#__codelineno-0-995> 995</a></span>
<span class=normal><a href=#__codelineno-0-996> 996</a></span>
<span class=normal><a href=#__codelineno-0-997> 997</a></span>
<span class=normal><a href=#__codelineno-0-998> 998</a></span>
<span class=normal><a href=#__codelineno-0-999> 999</a></span>
<span class=normal><a href=#__codelineno-0-1000>1000</a></span>
<span class=normal><a href=#__codelineno-0-1001>1001</a></span>
<span class=normal><a href=#__codelineno-0-1002>1002</a></span>
<span class=normal><a href=#__codelineno-0-1003>1003</a></span>
<span class=normal><a href=#__codelineno-0-1004>1004</a></span>
<span class=normal><a href=#__codelineno-0-1005>1005</a></span>
<span class=normal><a href=#__codelineno-0-1006>1006</a></span>
<span class=normal><a href=#__codelineno-0-1007>1007</a></span>
<span class=normal><a href=#__codelineno-0-1008>1008</a></span>
<span class=normal><a href=#__codelineno-0-1009>1009</a></span>
<span class=normal><a href=#__codelineno-0-1010>1010</a></span>
<span class=normal><a href=#__codelineno-0-1011>1011</a></span>
<span class=normal><a href=#__codelineno-0-1012>1012</a></span>
<span class=normal><a href=#__codelineno-0-1013>1013</a></span>
<span class=normal><a href=#__codelineno-0-1014>1014</a></span>
<span class=normal><a href=#__codelineno-0-1015>1015</a></span>
<span class=normal><a href=#__codelineno-0-1016>1016</a></span>
<span class=normal><a href=#__codelineno-0-1017>1017</a></span>
<span class=normal><a href=#__codelineno-0-1018>1018</a></span>
<span class=normal><a href=#__codelineno-0-1019>1019</a></span>
<span class=normal><a href=#__codelineno-0-1020>1020</a></span>
<span class=normal><a href=#__codelineno-0-1021>1021</a></span>
<span class=normal><a href=#__codelineno-0-1022>1022</a></span>
<span class=normal><a href=#__codelineno-0-1023>1023</a></span>
<span class=normal><a href=#__codelineno-0-1024>1024</a></span>
<span class=normal><a href=#__codelineno-0-1025>1025</a></span>
<span class=normal><a href=#__codelineno-0-1026>1026</a></span>
<span class=normal><a href=#__codelineno-0-1027>1027</a></span>
<span class=normal><a href=#__codelineno-0-1028>1028</a></span>
<span class=normal><a href=#__codelineno-0-1029>1029</a></span>
<span class=normal><a href=#__codelineno-0-1030>1030</a></span>
<span class=normal><a href=#__codelineno-0-1031>1031</a></span>
<span class=normal><a href=#__codelineno-0-1032>1032</a></span>
<span class=normal><a href=#__codelineno-0-1033>1033</a></span>
<span class=normal><a href=#__codelineno-0-1034>1034</a></span>
<span class=normal><a href=#__codelineno-0-1035>1035</a></span>
<span class=normal><a href=#__codelineno-0-1036>1036</a></span>
<span class=normal><a href=#__codelineno-0-1037>1037</a></span>
<span class=normal><a href=#__codelineno-0-1038>1038</a></span>
<span class=normal><a href=#__codelineno-0-1039>1039</a></span>
<span class=normal><a href=#__codelineno-0-1040>1040</a></span>
<span class=normal><a href=#__codelineno-0-1041>1041</a></span>
<span class=normal><a href=#__codelineno-0-1042>1042</a></span>
<span class=normal><a href=#__codelineno-0-1043>1043</a></span>
<span class=normal><a href=#__codelineno-0-1044>1044</a></span>
<span class=normal><a href=#__codelineno-0-1045>1045</a></span>
<span class=normal><a href=#__codelineno-0-1046>1046</a></span>
<span class=normal><a href=#__codelineno-0-1047>1047</a></span>
<span class=normal><a href=#__codelineno-0-1048>1048</a></span>
<span class=normal><a href=#__codelineno-0-1049>1049</a></span>
<span class=normal><a href=#__codelineno-0-1050>1050</a></span>
<span class=normal><a href=#__codelineno-0-1051>1051</a></span>
<span class=normal><a href=#__codelineno-0-1052>1052</a></span>
<span class=normal><a href=#__codelineno-0-1053>1053</a></span>
<span class=normal><a href=#__codelineno-0-1054>1054</a></span>
<span class=normal><a href=#__codelineno-0-1055>1055</a></span>
<span class=normal><a href=#__codelineno-0-1056>1056</a></span>
<span class=normal><a href=#__codelineno-0-1057>1057</a></span>
<span class=normal><a href=#__codelineno-0-1058>1058</a></span>
<span class=normal><a href=#__codelineno-0-1059>1059</a></span>
<span class=normal><a href=#__codelineno-0-1060>1060</a></span>
<span class=normal><a href=#__codelineno-0-1061>1061</a></span>
<span class=normal><a href=#__codelineno-0-1062>1062</a></span>
<span class=normal><a href=#__codelineno-0-1063>1063</a></span>
<span class=normal><a href=#__codelineno-0-1064>1064</a></span>
<span class=normal><a href=#__codelineno-0-1065>1065</a></span>
<span class=normal><a href=#__codelineno-0-1066>1066</a></span>
<span class=normal><a href=#__codelineno-0-1067>1067</a></span>
<span class=normal><a href=#__codelineno-0-1068>1068</a></span>
<span class=normal><a href=#__codelineno-0-1069>1069</a></span>
<span class=normal><a href=#__codelineno-0-1070>1070</a></span>
<span class=normal><a href=#__codelineno-0-1071>1071</a></span>
<span class=normal><a href=#__codelineno-0-1072>1072</a></span>
<span class=normal><a href=#__codelineno-0-1073>1073</a></span>
<span class=normal><a href=#__codelineno-0-1074>1074</a></span>
<span class=normal><a href=#__codelineno-0-1075>1075</a></span>
<span class=normal><a href=#__codelineno-0-1076>1076</a></span>
<span class=normal><a href=#__codelineno-0-1077>1077</a></span>
<span class=normal><a href=#__codelineno-0-1078>1078</a></span>
<span class=normal><a href=#__codelineno-0-1079>1079</a></span>
<span class=normal><a href=#__codelineno-0-1080>1080</a></span>
<span class=normal><a href=#__codelineno-0-1081>1081</a></span>
<span class=normal><a href=#__codelineno-0-1082>1082</a></span>
<span class=normal><a href=#__codelineno-0-1083>1083</a></span>
<span class=normal><a href=#__codelineno-0-1084>1084</a></span>
<span class=normal><a href=#__codelineno-0-1085>1085</a></span>
<span class=normal><a href=#__codelineno-0-1086>1086</a></span>
<span class=normal><a href=#__codelineno-0-1087>1087</a></span>
<span class=normal><a href=#__codelineno-0-1088>1088</a></span>
<span class=normal><a href=#__codelineno-0-1089>1089</a></span>
<span class=normal><a href=#__codelineno-0-1090>1090</a></span>
<span class=normal><a href=#__codelineno-0-1091>1091</a></span>
<span class=normal><a href=#__codelineno-0-1092>1092</a></span>
<span class=normal><a href=#__codelineno-0-1093>1093</a></span>
<span class=normal><a href=#__codelineno-0-1094>1094</a></span>
<span class=normal><a href=#__codelineno-0-1095>1095</a></span>
<span class=normal><a href=#__codelineno-0-1096>1096</a></span>
<span class=normal><a href=#__codelineno-0-1097>1097</a></span>
<span class=normal><a href=#__codelineno-0-1098>1098</a></span>
<span class=normal><a href=#__codelineno-0-1099>1099</a></span>
<span class=normal><a href=#__codelineno-0-1100>1100</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-867><a id=__codelineno-0-867 name=__codelineno-0-867></a><span class=k>def</span><span class=w> </span><span class=nf>create_n2n_configuration</span><span class=p>(</span>
</span><span id=__span-0-868><a id=__codelineno-0-868 name=__codelineno-0-868></a>    <span class=n>experiment_name</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span><span id=__span-0-869><a id=__codelineno-0-869 name=__codelineno-0-869></a>    <span class=n>data_type</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span><span class=s2>&quot;array&quot;</span><span class=p>,</span> <span class=s2>&quot;tiff&quot;</span><span class=p>,</span> <span class=s2>&quot;czi&quot;</span><span class=p>,</span> <span class=s2>&quot;custom&quot;</span><span class=p>],</span>
</span><span id=__span-0-870><a id=__codelineno-0-870 name=__codelineno-0-870></a>    <span class=n>axes</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span><span id=__span-0-871><a id=__codelineno-0-871 name=__codelineno-0-871></a>    <span class=n>patch_size</span><span class=p>:</span> <span class=n>Sequence</span><span class=p>[</span><span class=nb>int</span><span class=p>],</span>
</span><span id=__span-0-872><a id=__codelineno-0-872 name=__codelineno-0-872></a>    <span class=n>batch_size</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-873><a id=__codelineno-0-873 name=__codelineno-0-873></a>    <span class=n>num_epochs</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>100</span><span class=p>,</span>
</span><span id=__span-0-874><a id=__codelineno-0-874 name=__codelineno-0-874></a>    <span class=n>num_steps</span><span class=p>:</span> <span class=nb>int</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-875><a id=__codelineno-0-875 name=__codelineno-0-875></a>    <span class=n>augmentations</span><span class=p>:</span> <span class=nb>list</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=n>XYFlipModel</span><span class=p>,</span> <span class=n>XYRandomRotate90Model</span><span class=p>]]</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-876><a id=__codelineno-0-876 name=__codelineno-0-876></a>    <span class=n>independent_channels</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
</span><span id=__span-0-877><a id=__codelineno-0-877 name=__codelineno-0-877></a>    <span class=n>loss</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span><span class=s2>&quot;mae&quot;</span><span class=p>,</span> <span class=s2>&quot;mse&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=s2>&quot;mae&quot;</span><span class=p>,</span>
</span><span id=__span-0-878><a id=__codelineno-0-878 name=__codelineno-0-878></a>    <span class=n>n_channels_in</span><span class=p>:</span> <span class=nb>int</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-879><a id=__codelineno-0-879 name=__codelineno-0-879></a>    <span class=n>n_channels_out</span><span class=p>:</span> <span class=nb>int</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-880><a id=__codelineno-0-880 name=__codelineno-0-880></a>    <span class=n>logger</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span><span class=s2>&quot;wandb&quot;</span><span class=p>,</span> <span class=s2>&quot;tensorboard&quot;</span><span class=p>,</span> <span class=s2>&quot;none&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=s2>&quot;none&quot;</span><span class=p>,</span>
</span><span id=__span-0-881><a id=__codelineno-0-881 name=__codelineno-0-881></a>    <span class=n>trainer_params</span><span class=p>:</span> <span class=nb>dict</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-882><a id=__codelineno-0-882 name=__codelineno-0-882></a>    <span class=n>model_params</span><span class=p>:</span> <span class=nb>dict</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-883><a id=__codelineno-0-883 name=__codelineno-0-883></a>    <span class=n>optimizer</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span><span class=s2>&quot;Adam&quot;</span><span class=p>,</span> <span class=s2>&quot;Adamax&quot;</span><span class=p>,</span> <span class=s2>&quot;SGD&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=s2>&quot;Adam&quot;</span><span class=p>,</span>
</span><span id=__span-0-884><a id=__codelineno-0-884 name=__codelineno-0-884></a>    <span class=n>optimizer_params</span><span class=p>:</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-885><a id=__codelineno-0-885 name=__codelineno-0-885></a>    <span class=n>lr_scheduler</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span><span class=s2>&quot;ReduceLROnPlateau&quot;</span><span class=p>,</span> <span class=s2>&quot;StepLR&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=s2>&quot;ReduceLROnPlateau&quot;</span><span class=p>,</span>
</span><span id=__span-0-886><a id=__codelineno-0-886 name=__codelineno-0-886></a>    <span class=n>lr_scheduler_params</span><span class=p>:</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-887><a id=__codelineno-0-887 name=__codelineno-0-887></a>    <span class=n>train_dataloader_params</span><span class=p>:</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-888><a id=__codelineno-0-888 name=__codelineno-0-888></a>    <span class=n>val_dataloader_params</span><span class=p>:</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-889><a id=__codelineno-0-889 name=__codelineno-0-889></a>    <span class=n>checkpoint_params</span><span class=p>:</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-890><a id=__codelineno-0-890 name=__codelineno-0-890></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Configuration</span><span class=p>:</span>
</span><span id=__span-0-891><a id=__codelineno-0-891 name=__codelineno-0-891></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-892><a id=__codelineno-0-892 name=__codelineno-0-892></a><span class=sd>    Create a configuration for training Noise2Noise.</span>
</span><span id=__span-0-893><a id=__codelineno-0-893 name=__codelineno-0-893></a>
</span><span id=__span-0-894><a id=__codelineno-0-894 name=__codelineno-0-894></a><span class=sd>    If &quot;Z&quot; is present in `axes`, then `path_size` must be a list of length 3, otherwise</span>
</span><span id=__span-0-895><a id=__codelineno-0-895 name=__codelineno-0-895></a><span class=sd>    2.</span>
</span><span id=__span-0-896><a id=__codelineno-0-896 name=__codelineno-0-896></a>
</span><span id=__span-0-897><a id=__codelineno-0-897 name=__codelineno-0-897></a><span class=sd>    If &quot;C&quot; is present in `axes`, then you need to set `n_channels_in` to the number of</span>
</span><span id=__span-0-898><a id=__codelineno-0-898 name=__codelineno-0-898></a><span class=sd>    channels. Likewise, if you set the number of channels, then &quot;C&quot; must be present in</span>
</span><span id=__span-0-899><a id=__codelineno-0-899 name=__codelineno-0-899></a><span class=sd>    `axes`.</span>
</span><span id=__span-0-900><a id=__codelineno-0-900 name=__codelineno-0-900></a>
</span><span id=__span-0-901><a id=__codelineno-0-901 name=__codelineno-0-901></a><span class=sd>    To set the number of output channels, use the `n_channels_out` parameter. If it is</span>
</span><span id=__span-0-902><a id=__codelineno-0-902 name=__codelineno-0-902></a><span class=sd>    not specified, it will be assumed to be equal to `n_channels_in`.</span>
</span><span id=__span-0-903><a id=__codelineno-0-903 name=__codelineno-0-903></a>
</span><span id=__span-0-904><a id=__codelineno-0-904 name=__codelineno-0-904></a><span class=sd>    By default, all channels are trained together. To train all channels independently,</span>
</span><span id=__span-0-905><a id=__codelineno-0-905 name=__codelineno-0-905></a><span class=sd>    set `independent_channels` to True.</span>
</span><span id=__span-0-906><a id=__codelineno-0-906 name=__codelineno-0-906></a>
</span><span id=__span-0-907><a id=__codelineno-0-907 name=__codelineno-0-907></a><span class=sd>    By setting `augmentations` to `None`, the default transformations (flip in X and Y,</span>
</span><span id=__span-0-908><a id=__codelineno-0-908 name=__codelineno-0-908></a><span class=sd>    rotations by 90 degrees in the XY plane) are applied. Rather than the default</span>
</span><span id=__span-0-909><a id=__codelineno-0-909 name=__codelineno-0-909></a><span class=sd>    transforms, a list of transforms can be passed to the `augmentations` parameter. To</span>
</span><span id=__span-0-910><a id=__codelineno-0-910 name=__codelineno-0-910></a><span class=sd>    disable the transforms, simply pass an empty list.</span>
</span><span id=__span-0-911><a id=__codelineno-0-911 name=__codelineno-0-911></a>
</span><span id=__span-0-912><a id=__codelineno-0-912 name=__codelineno-0-912></a><span class=sd>    Parameters</span>
</span><span id=__span-0-913><a id=__codelineno-0-913 name=__codelineno-0-913></a><span class=sd>    ----------</span>
</span><span id=__span-0-914><a id=__codelineno-0-914 name=__codelineno-0-914></a><span class=sd>    experiment_name : str</span>
</span><span id=__span-0-915><a id=__codelineno-0-915 name=__codelineno-0-915></a><span class=sd>        Name of the experiment.</span>
</span><span id=__span-0-916><a id=__codelineno-0-916 name=__codelineno-0-916></a><span class=sd>    data_type : Literal[&quot;array&quot;, &quot;tiff&quot;, &quot;czi&quot;, &quot;custom&quot;]</span>
</span><span id=__span-0-917><a id=__codelineno-0-917 name=__codelineno-0-917></a><span class=sd>        Type of the data.</span>
</span><span id=__span-0-918><a id=__codelineno-0-918 name=__codelineno-0-918></a><span class=sd>    axes : str</span>
</span><span id=__span-0-919><a id=__codelineno-0-919 name=__codelineno-0-919></a><span class=sd>        Axes of the data (e.g. SYX).</span>
</span><span id=__span-0-920><a id=__codelineno-0-920 name=__codelineno-0-920></a><span class=sd>    patch_size : List[int]</span>
</span><span id=__span-0-921><a id=__codelineno-0-921 name=__codelineno-0-921></a><span class=sd>        Size of the patches along the spatial dimensions (e.g. [64, 64]).</span>
</span><span id=__span-0-922><a id=__codelineno-0-922 name=__codelineno-0-922></a><span class=sd>    batch_size : int</span>
</span><span id=__span-0-923><a id=__codelineno-0-923 name=__codelineno-0-923></a><span class=sd>        Batch size.</span>
</span><span id=__span-0-924><a id=__codelineno-0-924 name=__codelineno-0-924></a><span class=sd>    num_epochs : int, default=100</span>
</span><span id=__span-0-925><a id=__codelineno-0-925 name=__codelineno-0-925></a><span class=sd>        Number of epochs to train for. If provided, this will be added to</span>
</span><span id=__span-0-926><a id=__codelineno-0-926 name=__codelineno-0-926></a><span class=sd>        trainer_params.</span>
</span><span id=__span-0-927><a id=__codelineno-0-927 name=__codelineno-0-927></a><span class=sd>    num_steps : int, optional</span>
</span><span id=__span-0-928><a id=__codelineno-0-928 name=__codelineno-0-928></a><span class=sd>        Number of batches in 1 epoch. If provided, this will be added to trainer_params.</span>
</span><span id=__span-0-929><a id=__codelineno-0-929 name=__codelineno-0-929></a><span class=sd>        Translates to `limit_train_batches` in PyTorch Lightning Trainer. See relevant</span>
</span><span id=__span-0-930><a id=__codelineno-0-930 name=__codelineno-0-930></a><span class=sd>        documentation for more details.</span>
</span><span id=__span-0-931><a id=__codelineno-0-931 name=__codelineno-0-931></a><span class=sd>    augmentations : list of transforms, default=None</span>
</span><span id=__span-0-932><a id=__codelineno-0-932 name=__codelineno-0-932></a><span class=sd>        List of transforms to apply, either both or one of XYFlipModel and</span>
</span><span id=__span-0-933><a id=__codelineno-0-933 name=__codelineno-0-933></a><span class=sd>        XYRandomRotate90Model. By default, it applies both XYFlip (on X and Y)</span>
</span><span id=__span-0-934><a id=__codelineno-0-934 name=__codelineno-0-934></a><span class=sd>        and XYRandomRotate90 (in XY) to the images.</span>
</span><span id=__span-0-935><a id=__codelineno-0-935 name=__codelineno-0-935></a><span class=sd>    independent_channels : bool, optional</span>
</span><span id=__span-0-936><a id=__codelineno-0-936 name=__codelineno-0-936></a><span class=sd>        Whether to train all channels independently, by default False.</span>
</span><span id=__span-0-937><a id=__codelineno-0-937 name=__codelineno-0-937></a><span class=sd>    loss : Literal[&quot;mae&quot;, &quot;mse&quot;], optional</span>
</span><span id=__span-0-938><a id=__codelineno-0-938 name=__codelineno-0-938></a><span class=sd>        Loss function to use, by default &quot;mae&quot;.</span>
</span><span id=__span-0-939><a id=__codelineno-0-939 name=__codelineno-0-939></a><span class=sd>    n_channels_in : int or None, default=None</span>
</span><span id=__span-0-940><a id=__codelineno-0-940 name=__codelineno-0-940></a><span class=sd>        Number of channels in.</span>
</span><span id=__span-0-941><a id=__codelineno-0-941 name=__codelineno-0-941></a><span class=sd>    n_channels_out : int or None, default=None</span>
</span><span id=__span-0-942><a id=__codelineno-0-942 name=__codelineno-0-942></a><span class=sd>        Number of channels out.</span>
</span><span id=__span-0-943><a id=__codelineno-0-943 name=__codelineno-0-943></a><span class=sd>    logger : Literal[&quot;wandb&quot;, &quot;tensorboard&quot;, &quot;none&quot;], optional</span>
</span><span id=__span-0-944><a id=__codelineno-0-944 name=__codelineno-0-944></a><span class=sd>        Logger to use, by default &quot;none&quot;.</span>
</span><span id=__span-0-945><a id=__codelineno-0-945 name=__codelineno-0-945></a><span class=sd>    trainer_params : dict, optional</span>
</span><span id=__span-0-946><a id=__codelineno-0-946 name=__codelineno-0-946></a><span class=sd>        Parameters for the trainer class, see PyTorch Lightning documentation.</span>
</span><span id=__span-0-947><a id=__codelineno-0-947 name=__codelineno-0-947></a><span class=sd>    model_params : dict, default=None</span>
</span><span id=__span-0-948><a id=__codelineno-0-948 name=__codelineno-0-948></a><span class=sd>        UNetModel parameters.</span>
</span><span id=__span-0-949><a id=__codelineno-0-949 name=__codelineno-0-949></a><span class=sd>    optimizer : Literal[&quot;Adam&quot;, &quot;Adamax&quot;, &quot;SGD&quot;], default=&quot;Adam&quot;</span>
</span><span id=__span-0-950><a id=__codelineno-0-950 name=__codelineno-0-950></a><span class=sd>        Optimizer to use.</span>
</span><span id=__span-0-951><a id=__codelineno-0-951 name=__codelineno-0-951></a><span class=sd>    optimizer_params : dict, default=None</span>
</span><span id=__span-0-952><a id=__codelineno-0-952 name=__codelineno-0-952></a><span class=sd>        Parameters for the optimizer, see PyTorch documentation for more details.</span>
</span><span id=__span-0-953><a id=__codelineno-0-953 name=__codelineno-0-953></a><span class=sd>    lr_scheduler : Literal[&quot;ReduceLROnPlateau&quot;, &quot;StepLR&quot;], default=&quot;ReduceLROnPlateau&quot;</span>
</span><span id=__span-0-954><a id=__codelineno-0-954 name=__codelineno-0-954></a><span class=sd>        Learning rate scheduler to use.</span>
</span><span id=__span-0-955><a id=__codelineno-0-955 name=__codelineno-0-955></a><span class=sd>    lr_scheduler_params : dict, default=None</span>
</span><span id=__span-0-956><a id=__codelineno-0-956 name=__codelineno-0-956></a><span class=sd>        Parameters for the learning rate scheduler, see PyTorch documentation for more</span>
</span><span id=__span-0-957><a id=__codelineno-0-957 name=__codelineno-0-957></a><span class=sd>        details.</span>
</span><span id=__span-0-958><a id=__codelineno-0-958 name=__codelineno-0-958></a><span class=sd>    train_dataloader_params : dict, optional</span>
</span><span id=__span-0-959><a id=__codelineno-0-959 name=__codelineno-0-959></a><span class=sd>        Parameters for the training dataloader, see the PyTorch docs for `DataLoader`.</span>
</span><span id=__span-0-960><a id=__codelineno-0-960 name=__codelineno-0-960></a><span class=sd>        If left as `None`, the dict `{&quot;shuffle&quot;: True}` will be used, this is set in</span>
</span><span id=__span-0-961><a id=__codelineno-0-961 name=__codelineno-0-961></a><span class=sd>        the `GeneralDataConfig`.</span>
</span><span id=__span-0-962><a id=__codelineno-0-962 name=__codelineno-0-962></a><span class=sd>    val_dataloader_params : dict, optional</span>
</span><span id=__span-0-963><a id=__codelineno-0-963 name=__codelineno-0-963></a><span class=sd>        Parameters for the validation dataloader, see PyTorch the docs for `DataLoader`.</span>
</span><span id=__span-0-964><a id=__codelineno-0-964 name=__codelineno-0-964></a><span class=sd>        If left as `None`, the empty dict `{}` will be used, this is set in the</span>
</span><span id=__span-0-965><a id=__codelineno-0-965 name=__codelineno-0-965></a><span class=sd>        `GeneralDataConfig`.</span>
</span><span id=__span-0-966><a id=__codelineno-0-966 name=__codelineno-0-966></a><span class=sd>    checkpoint_params : dict, default=None</span>
</span><span id=__span-0-967><a id=__codelineno-0-967 name=__codelineno-0-967></a><span class=sd>        Parameters for the checkpoint callback, see PyTorch Lightning documentation</span>
</span><span id=__span-0-968><a id=__codelineno-0-968 name=__codelineno-0-968></a><span class=sd>        (`ModelCheckpoint`) for the list of available parameters.</span>
</span><span id=__span-0-969><a id=__codelineno-0-969 name=__codelineno-0-969></a>
</span><span id=__span-0-970><a id=__codelineno-0-970 name=__codelineno-0-970></a><span class=sd>    Returns</span>
</span><span id=__span-0-971><a id=__codelineno-0-971 name=__codelineno-0-971></a><span class=sd>    -------</span>
</span><span id=__span-0-972><a id=__codelineno-0-972 name=__codelineno-0-972></a><span class=sd>    Configuration</span>
</span><span id=__span-0-973><a id=__codelineno-0-973 name=__codelineno-0-973></a><span class=sd>        Configuration for training Noise2Noise.</span>
</span><span id=__span-0-974><a id=__codelineno-0-974 name=__codelineno-0-974></a>
</span><span id=__span-0-975><a id=__codelineno-0-975 name=__codelineno-0-975></a><span class=sd>    Examples</span>
</span><span id=__span-0-976><a id=__codelineno-0-976 name=__codelineno-0-976></a><span class=sd>    --------</span>
</span><span id=__span-0-977><a id=__codelineno-0-977 name=__codelineno-0-977></a><span class=sd>    Minimum example:</span>
</span><span id=__span-0-978><a id=__codelineno-0-978 name=__codelineno-0-978></a><span class=sd>    &gt;&gt;&gt; config = create_n2n_configuration(</span>
</span><span id=__span-0-979><a id=__codelineno-0-979 name=__codelineno-0-979></a><span class=sd>    ...     experiment_name=&quot;n2n_experiment&quot;,</span>
</span><span id=__span-0-980><a id=__codelineno-0-980 name=__codelineno-0-980></a><span class=sd>    ...     data_type=&quot;array&quot;,</span>
</span><span id=__span-0-981><a id=__codelineno-0-981 name=__codelineno-0-981></a><span class=sd>    ...     axes=&quot;YX&quot;,</span>
</span><span id=__span-0-982><a id=__codelineno-0-982 name=__codelineno-0-982></a><span class=sd>    ...     patch_size=[64, 64],</span>
</span><span id=__span-0-983><a id=__codelineno-0-983 name=__codelineno-0-983></a><span class=sd>    ...     batch_size=32,</span>
</span><span id=__span-0-984><a id=__codelineno-0-984 name=__codelineno-0-984></a><span class=sd>    ...     num_epochs=100</span>
</span><span id=__span-0-985><a id=__codelineno-0-985 name=__codelineno-0-985></a><span class=sd>    ... )</span>
</span><span id=__span-0-986><a id=__codelineno-0-986 name=__codelineno-0-986></a>
</span><span id=__span-0-987><a id=__codelineno-0-987 name=__codelineno-0-987></a><span class=sd>    You can also limit the number of batches per epoch:</span>
</span><span id=__span-0-988><a id=__codelineno-0-988 name=__codelineno-0-988></a><span class=sd>    &gt;&gt;&gt; config = create_n2n_configuration(</span>
</span><span id=__span-0-989><a id=__codelineno-0-989 name=__codelineno-0-989></a><span class=sd>    ...     experiment_name=&quot;n2n_experiment&quot;,</span>
</span><span id=__span-0-990><a id=__codelineno-0-990 name=__codelineno-0-990></a><span class=sd>    ...     data_type=&quot;array&quot;,</span>
</span><span id=__span-0-991><a id=__codelineno-0-991 name=__codelineno-0-991></a><span class=sd>    ...     axes=&quot;YX&quot;,</span>
</span><span id=__span-0-992><a id=__codelineno-0-992 name=__codelineno-0-992></a><span class=sd>    ...     patch_size=[64, 64],</span>
</span><span id=__span-0-993><a id=__codelineno-0-993 name=__codelineno-0-993></a><span class=sd>    ...     batch_size=32,</span>
</span><span id=__span-0-994><a id=__codelineno-0-994 name=__codelineno-0-994></a><span class=sd>    ...     num_steps=100  # limit to 100 batches per epoch</span>
</span><span id=__span-0-995><a id=__codelineno-0-995 name=__codelineno-0-995></a><span class=sd>    ... )</span>
</span><span id=__span-0-996><a id=__codelineno-0-996 name=__codelineno-0-996></a>
</span><span id=__span-0-997><a id=__codelineno-0-997 name=__codelineno-0-997></a><span class=sd>    To disable transforms, simply set `augmentations` to an empty list:</span>
</span><span id=__span-0-998><a id=__codelineno-0-998 name=__codelineno-0-998></a><span class=sd>    &gt;&gt;&gt; config = create_n2n_configuration(</span>
</span><span id=__span-0-999><a id=__codelineno-0-999 name=__codelineno-0-999></a><span class=sd>    ...     experiment_name=&quot;n2n_experiment&quot;,</span>
</span><span id=__span-0-1000><a id=__codelineno-0-1000 name=__codelineno-0-1000></a><span class=sd>    ...     data_type=&quot;array&quot;,</span>
</span><span id=__span-0-1001><a id=__codelineno-0-1001 name=__codelineno-0-1001></a><span class=sd>    ...     axes=&quot;YX&quot;,</span>
</span><span id=__span-0-1002><a id=__codelineno-0-1002 name=__codelineno-0-1002></a><span class=sd>    ...     patch_size=[64, 64],</span>
</span><span id=__span-0-1003><a id=__codelineno-0-1003 name=__codelineno-0-1003></a><span class=sd>    ...     batch_size=32,</span>
</span><span id=__span-0-1004><a id=__codelineno-0-1004 name=__codelineno-0-1004></a><span class=sd>    ...     num_epochs=100,</span>
</span><span id=__span-0-1005><a id=__codelineno-0-1005 name=__codelineno-0-1005></a><span class=sd>    ...     augmentations=[]</span>
</span><span id=__span-0-1006><a id=__codelineno-0-1006 name=__codelineno-0-1006></a><span class=sd>    ... )</span>
</span><span id=__span-0-1007><a id=__codelineno-0-1007 name=__codelineno-0-1007></a>
</span><span id=__span-0-1008><a id=__codelineno-0-1008 name=__codelineno-0-1008></a><span class=sd>    A list of transforms can be passed to the `augmentations` parameter:</span>
</span><span id=__span-0-1009><a id=__codelineno-0-1009 name=__codelineno-0-1009></a><span class=sd>    &gt;&gt;&gt; from careamics.config.transformations import XYFlipModel</span>
</span><span id=__span-0-1010><a id=__codelineno-0-1010 name=__codelineno-0-1010></a><span class=sd>    &gt;&gt;&gt; config = create_n2n_configuration(</span>
</span><span id=__span-0-1011><a id=__codelineno-0-1011 name=__codelineno-0-1011></a><span class=sd>    ...     experiment_name=&quot;n2n_experiment&quot;,</span>
</span><span id=__span-0-1012><a id=__codelineno-0-1012 name=__codelineno-0-1012></a><span class=sd>    ...     data_type=&quot;array&quot;,</span>
</span><span id=__span-0-1013><a id=__codelineno-0-1013 name=__codelineno-0-1013></a><span class=sd>    ...     axes=&quot;YX&quot;,</span>
</span><span id=__span-0-1014><a id=__codelineno-0-1014 name=__codelineno-0-1014></a><span class=sd>    ...     patch_size=[64, 64],</span>
</span><span id=__span-0-1015><a id=__codelineno-0-1015 name=__codelineno-0-1015></a><span class=sd>    ...     batch_size=32,</span>
</span><span id=__span-0-1016><a id=__codelineno-0-1016 name=__codelineno-0-1016></a><span class=sd>    ...     num_epochs=100,</span>
</span><span id=__span-0-1017><a id=__codelineno-0-1017 name=__codelineno-0-1017></a><span class=sd>    ...     augmentations=[</span>
</span><span id=__span-0-1018><a id=__codelineno-0-1018 name=__codelineno-0-1018></a><span class=sd>    ...         # No rotation and only Y flipping</span>
</span><span id=__span-0-1019><a id=__codelineno-0-1019 name=__codelineno-0-1019></a><span class=sd>    ...         XYFlipModel(flip_x = False, flip_y = True)</span>
</span><span id=__span-0-1020><a id=__codelineno-0-1020 name=__codelineno-0-1020></a><span class=sd>    ...     ]</span>
</span><span id=__span-0-1021><a id=__codelineno-0-1021 name=__codelineno-0-1021></a><span class=sd>    ... )</span>
</span><span id=__span-0-1022><a id=__codelineno-0-1022 name=__codelineno-0-1022></a>
</span><span id=__span-0-1023><a id=__codelineno-0-1023 name=__codelineno-0-1023></a><span class=sd>    If you are training multiple channels they will be trained independently by default,</span>
</span><span id=__span-0-1024><a id=__codelineno-0-1024 name=__codelineno-0-1024></a><span class=sd>    you simply need to specify the number of channels input (and optionally, the number</span>
</span><span id=__span-0-1025><a id=__codelineno-0-1025 name=__codelineno-0-1025></a><span class=sd>    of channels output):</span>
</span><span id=__span-0-1026><a id=__codelineno-0-1026 name=__codelineno-0-1026></a><span class=sd>    &gt;&gt;&gt; config = create_n2n_configuration(</span>
</span><span id=__span-0-1027><a id=__codelineno-0-1027 name=__codelineno-0-1027></a><span class=sd>    ...     experiment_name=&quot;n2n_experiment&quot;,</span>
</span><span id=__span-0-1028><a id=__codelineno-0-1028 name=__codelineno-0-1028></a><span class=sd>    ...     data_type=&quot;array&quot;,</span>
</span><span id=__span-0-1029><a id=__codelineno-0-1029 name=__codelineno-0-1029></a><span class=sd>    ...     axes=&quot;YXC&quot;, # channels must be in the axes</span>
</span><span id=__span-0-1030><a id=__codelineno-0-1030 name=__codelineno-0-1030></a><span class=sd>    ...     patch_size=[64, 64],</span>
</span><span id=__span-0-1031><a id=__codelineno-0-1031 name=__codelineno-0-1031></a><span class=sd>    ...     batch_size=32,</span>
</span><span id=__span-0-1032><a id=__codelineno-0-1032 name=__codelineno-0-1032></a><span class=sd>    ...     num_epochs=100,</span>
</span><span id=__span-0-1033><a id=__codelineno-0-1033 name=__codelineno-0-1033></a><span class=sd>    ...     n_channels_in=3, # number of input channels</span>
</span><span id=__span-0-1034><a id=__codelineno-0-1034 name=__codelineno-0-1034></a><span class=sd>    ...     n_channels_out=1 # if applicable</span>
</span><span id=__span-0-1035><a id=__codelineno-0-1035 name=__codelineno-0-1035></a><span class=sd>    ... )</span>
</span><span id=__span-0-1036><a id=__codelineno-0-1036 name=__codelineno-0-1036></a>
</span><span id=__span-0-1037><a id=__codelineno-0-1037 name=__codelineno-0-1037></a><span class=sd>    If instead you want to train multiple channels together, you need to turn off the</span>
</span><span id=__span-0-1038><a id=__codelineno-0-1038 name=__codelineno-0-1038></a><span class=sd>    `independent_channels` parameter:</span>
</span><span id=__span-0-1039><a id=__codelineno-0-1039 name=__codelineno-0-1039></a><span class=sd>    &gt;&gt;&gt; config = create_n2n_configuration(</span>
</span><span id=__span-0-1040><a id=__codelineno-0-1040 name=__codelineno-0-1040></a><span class=sd>    ...     experiment_name=&quot;n2n_experiment&quot;,</span>
</span><span id=__span-0-1041><a id=__codelineno-0-1041 name=__codelineno-0-1041></a><span class=sd>    ...     data_type=&quot;array&quot;,</span>
</span><span id=__span-0-1042><a id=__codelineno-0-1042 name=__codelineno-0-1042></a><span class=sd>    ...     axes=&quot;YXC&quot;, # channels must be in the axes</span>
</span><span id=__span-0-1043><a id=__codelineno-0-1043 name=__codelineno-0-1043></a><span class=sd>    ...     patch_size=[64, 64],</span>
</span><span id=__span-0-1044><a id=__codelineno-0-1044 name=__codelineno-0-1044></a><span class=sd>    ...     batch_size=32,</span>
</span><span id=__span-0-1045><a id=__codelineno-0-1045 name=__codelineno-0-1045></a><span class=sd>    ...     num_epochs=100,</span>
</span><span id=__span-0-1046><a id=__codelineno-0-1046 name=__codelineno-0-1046></a><span class=sd>    ...     independent_channels=False,</span>
</span><span id=__span-0-1047><a id=__codelineno-0-1047 name=__codelineno-0-1047></a><span class=sd>    ...     n_channels_in=3,</span>
</span><span id=__span-0-1048><a id=__codelineno-0-1048 name=__codelineno-0-1048></a><span class=sd>    ...     n_channels_out=1 # if applicable</span>
</span><span id=__span-0-1049><a id=__codelineno-0-1049 name=__codelineno-0-1049></a><span class=sd>    ... )</span>
</span><span id=__span-0-1050><a id=__codelineno-0-1050 name=__codelineno-0-1050></a>
</span><span id=__span-0-1051><a id=__codelineno-0-1051 name=__codelineno-0-1051></a><span class=sd>    If you would like to train on CZI files, use `&quot;czi&quot;` as `data_type` and `&quot;SCYX&quot;` as</span>
</span><span id=__span-0-1052><a id=__codelineno-0-1052 name=__codelineno-0-1052></a><span class=sd>    `axes` for 2-D or `&quot;SCZYX&quot;` for 3-D denoising. Note that `&quot;SCYX&quot;` can also be used</span>
</span><span id=__span-0-1053><a id=__codelineno-0-1053 name=__codelineno-0-1053></a><span class=sd>    for 3-D data but spatial context along the Z dimension will then not be taken into</span>
</span><span id=__span-0-1054><a id=__codelineno-0-1054 name=__codelineno-0-1054></a><span class=sd>    account.</span>
</span><span id=__span-0-1055><a id=__codelineno-0-1055 name=__codelineno-0-1055></a><span class=sd>    &gt;&gt;&gt; config_2d = create_n2n_configuration(</span>
</span><span id=__span-0-1056><a id=__codelineno-0-1056 name=__codelineno-0-1056></a><span class=sd>    ...     experiment_name=&quot;n2n_experiment&quot;,</span>
</span><span id=__span-0-1057><a id=__codelineno-0-1057 name=__codelineno-0-1057></a><span class=sd>    ...     data_type=&quot;czi&quot;,</span>
</span><span id=__span-0-1058><a id=__codelineno-0-1058 name=__codelineno-0-1058></a><span class=sd>    ...     axes=&quot;SCYX&quot;,</span>
</span><span id=__span-0-1059><a id=__codelineno-0-1059 name=__codelineno-0-1059></a><span class=sd>    ...     patch_size=[64, 64],</span>
</span><span id=__span-0-1060><a id=__codelineno-0-1060 name=__codelineno-0-1060></a><span class=sd>    ...     batch_size=32,</span>
</span><span id=__span-0-1061><a id=__codelineno-0-1061 name=__codelineno-0-1061></a><span class=sd>    ...     num_epochs=100,</span>
</span><span id=__span-0-1062><a id=__codelineno-0-1062 name=__codelineno-0-1062></a><span class=sd>    ...     n_channels_in=1,</span>
</span><span id=__span-0-1063><a id=__codelineno-0-1063 name=__codelineno-0-1063></a><span class=sd>    ... )</span>
</span><span id=__span-0-1064><a id=__codelineno-0-1064 name=__codelineno-0-1064></a><span class=sd>    &gt;&gt;&gt; config_3d = create_n2n_configuration(</span>
</span><span id=__span-0-1065><a id=__codelineno-0-1065 name=__codelineno-0-1065></a><span class=sd>    ...     experiment_name=&quot;n2n_experiment&quot;,</span>
</span><span id=__span-0-1066><a id=__codelineno-0-1066 name=__codelineno-0-1066></a><span class=sd>    ...     data_type=&quot;czi&quot;,</span>
</span><span id=__span-0-1067><a id=__codelineno-0-1067 name=__codelineno-0-1067></a><span class=sd>    ...     axes=&quot;SCZYX&quot;,</span>
</span><span id=__span-0-1068><a id=__codelineno-0-1068 name=__codelineno-0-1068></a><span class=sd>    ...     patch_size=[16, 64, 64],</span>
</span><span id=__span-0-1069><a id=__codelineno-0-1069 name=__codelineno-0-1069></a><span class=sd>    ...     batch_size=16,</span>
</span><span id=__span-0-1070><a id=__codelineno-0-1070 name=__codelineno-0-1070></a><span class=sd>    ...     num_epochs=100,</span>
</span><span id=__span-0-1071><a id=__codelineno-0-1071 name=__codelineno-0-1071></a><span class=sd>    ...     n_channels_in=1,</span>
</span><span id=__span-0-1072><a id=__codelineno-0-1072 name=__codelineno-0-1072></a><span class=sd>    ... )</span>
</span><span id=__span-0-1073><a id=__codelineno-0-1073 name=__codelineno-0-1073></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-1074><a id=__codelineno-0-1074 name=__codelineno-0-1074></a>    <span class=k>return</span> <span class=n>Configuration</span><span class=p>(</span>
</span><span id=__span-0-1075><a id=__codelineno-0-1075 name=__codelineno-0-1075></a>        <span class=o>**</span><span class=n>_create_supervised_config_dict</span><span class=p>(</span>
</span><span id=__span-0-1076><a id=__codelineno-0-1076 name=__codelineno-0-1076></a>            <span class=n>algorithm</span><span class=o>=</span><span class=s2>&quot;n2n&quot;</span><span class=p>,</span>
</span><span id=__span-0-1077><a id=__codelineno-0-1077 name=__codelineno-0-1077></a>            <span class=n>experiment_name</span><span class=o>=</span><span class=n>experiment_name</span><span class=p>,</span>
</span><span id=__span-0-1078><a id=__codelineno-0-1078 name=__codelineno-0-1078></a>            <span class=n>data_type</span><span class=o>=</span><span class=n>data_type</span><span class=p>,</span>
</span><span id=__span-0-1079><a id=__codelineno-0-1079 name=__codelineno-0-1079></a>            <span class=n>axes</span><span class=o>=</span><span class=n>axes</span><span class=p>,</span>
</span><span id=__span-0-1080><a id=__codelineno-0-1080 name=__codelineno-0-1080></a>            <span class=n>patch_size</span><span class=o>=</span><span class=n>patch_size</span><span class=p>,</span>
</span><span id=__span-0-1081><a id=__codelineno-0-1081 name=__codelineno-0-1081></a>            <span class=n>batch_size</span><span class=o>=</span><span class=n>batch_size</span><span class=p>,</span>
</span><span id=__span-0-1082><a id=__codelineno-0-1082 name=__codelineno-0-1082></a>            <span class=n>trainer_params</span><span class=o>=</span><span class=n>trainer_params</span><span class=p>,</span>
</span><span id=__span-0-1083><a id=__codelineno-0-1083 name=__codelineno-0-1083></a>            <span class=n>augmentations</span><span class=o>=</span><span class=n>augmentations</span><span class=p>,</span>
</span><span id=__span-0-1084><a id=__codelineno-0-1084 name=__codelineno-0-1084></a>            <span class=n>independent_channels</span><span class=o>=</span><span class=n>independent_channels</span><span class=p>,</span>
</span><span id=__span-0-1085><a id=__codelineno-0-1085 name=__codelineno-0-1085></a>            <span class=n>loss</span><span class=o>=</span><span class=n>loss</span><span class=p>,</span>
</span><span id=__span-0-1086><a id=__codelineno-0-1086 name=__codelineno-0-1086></a>            <span class=n>n_channels_in</span><span class=o>=</span><span class=n>n_channels_in</span><span class=p>,</span>
</span><span id=__span-0-1087><a id=__codelineno-0-1087 name=__codelineno-0-1087></a>            <span class=n>n_channels_out</span><span class=o>=</span><span class=n>n_channels_out</span><span class=p>,</span>
</span><span id=__span-0-1088><a id=__codelineno-0-1088 name=__codelineno-0-1088></a>            <span class=n>logger</span><span class=o>=</span><span class=n>logger</span><span class=p>,</span>
</span><span id=__span-0-1089><a id=__codelineno-0-1089 name=__codelineno-0-1089></a>            <span class=n>model_params</span><span class=o>=</span><span class=n>model_params</span><span class=p>,</span>
</span><span id=__span-0-1090><a id=__codelineno-0-1090 name=__codelineno-0-1090></a>            <span class=n>optimizer</span><span class=o>=</span><span class=n>optimizer</span><span class=p>,</span>
</span><span id=__span-0-1091><a id=__codelineno-0-1091 name=__codelineno-0-1091></a>            <span class=n>optimizer_params</span><span class=o>=</span><span class=n>optimizer_params</span><span class=p>,</span>
</span><span id=__span-0-1092><a id=__codelineno-0-1092 name=__codelineno-0-1092></a>            <span class=n>lr_scheduler</span><span class=o>=</span><span class=n>lr_scheduler</span><span class=p>,</span>
</span><span id=__span-0-1093><a id=__codelineno-0-1093 name=__codelineno-0-1093></a>            <span class=n>lr_scheduler_params</span><span class=o>=</span><span class=n>lr_scheduler_params</span><span class=p>,</span>
</span><span id=__span-0-1094><a id=__codelineno-0-1094 name=__codelineno-0-1094></a>            <span class=n>train_dataloader_params</span><span class=o>=</span><span class=n>train_dataloader_params</span><span class=p>,</span>
</span><span id=__span-0-1095><a id=__codelineno-0-1095 name=__codelineno-0-1095></a>            <span class=n>val_dataloader_params</span><span class=o>=</span><span class=n>val_dataloader_params</span><span class=p>,</span>
</span><span id=__span-0-1096><a id=__codelineno-0-1096 name=__codelineno-0-1096></a>            <span class=n>checkpoint_params</span><span class=o>=</span><span class=n>checkpoint_params</span><span class=p>,</span>
</span><span id=__span-0-1097><a id=__codelineno-0-1097 name=__codelineno-0-1097></a>            <span class=n>num_epochs</span><span class=o>=</span><span class=n>num_epochs</span><span class=p>,</span>
</span><span id=__span-0-1098><a id=__codelineno-0-1098 name=__codelineno-0-1098></a>            <span class=n>num_steps</span><span class=o>=</span><span class=n>num_steps</span><span class=p>,</span>
</span><span id=__span-0-1099><a id=__codelineno-0-1099 name=__codelineno-0-1099></a>        <span class=p>)</span>
</span><span id=__span-0-1100><a id=__codelineno-0-1100 name=__codelineno-0-1100></a>    <span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=careamics.config.configuration_factories.create_n2v_configuration class="doc doc-heading"> <code class="highlight language-python"><span class=n>create_n2v_configuration</span><span class=p>(</span><span class=n>experiment_name</span><span class=p>,</span> <span class=n>data_type</span><span class=p>,</span> <span class=n>axes</span><span class=p>,</span> <span class=n>patch_size</span><span class=p>,</span> <span class=n>batch_size</span><span class=p>,</span> <span class=n>num_epochs</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>num_steps</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>augmentations</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>independent_channels</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>use_n2v2</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>n_channels</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>roi_size</span><span class=o>=</span><span class=mi>11</span><span class=p>,</span> <span class=n>masked_pixel_percentage</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>struct_n2v_axis</span><span class=o>=</span><span class=s1>&#39;none&#39;</span><span class=p>,</span> <span class=n>struct_n2v_span</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span> <span class=n>trainer_params</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>logger</span><span class=o>=</span><span class=s1>&#39;none&#39;</span><span class=p>,</span> <span class=n>model_params</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>optimizer</span><span class=o>=</span><span class=s1>&#39;Adam&#39;</span><span class=p>,</span> <span class=n>optimizer_params</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>lr_scheduler</span><span class=o>=</span><span class=s1>&#39;ReduceLROnPlateau&#39;</span><span class=p>,</span> <span class=n>lr_scheduler_params</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>train_dataloader_params</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>val_dataloader_params</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>checkpoint_params</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#careamics.config.configuration_factories.create_n2v_configuration class=headerlink title="Permanent link">#</a></h2> <div class="doc doc-contents "> <p>Create a configuration for training Noise2Void.</p> <p>N2V uses a UNet model to denoise images in a self-supervised manner. To use its variants structN2V and N2V2, set the <code>struct_n2v_axis</code> and <code>struct_n2v_span</code> (structN2V) parameters, or set <code>use_n2v2</code> to True (N2V2).</p> <p>N2V2 modifies the UNet architecture by adding blur pool layers and removes the skip connections, thus removing checkboard artefacts. StructN2V is used when vertical or horizontal correlations are present in the noise; it applies an additional mask to the manipulated pixel neighbors.</p> <p>If "Z" is present in <code>axes</code>, then <code>path_size</code> must be a list of length 3, otherwise 2.</p> <p>If "C" is present in <code>axes</code>, then you need to set <code>n_channels</code> to the number of channels.</p> <p>By default, all channels are trained independently. To train all channels together, set <code>independent_channels</code> to False.</p> <p>By default, the transformations applied are a random flip along X or Y, and a random 90 degrees rotation in the XY plane. Normalization is always applied, as well as the N2V manipulation.</p> <p>By setting <code>augmentations</code> to <code>None</code>, the default transformations (flip in X and Y, rotations by 90 degrees in the XY plane) are applied. Rather than the default transforms, a list of transforms can be passed to the <code>augmentations</code> parameter. To disable the transforms, simply pass an empty list.</p> <p>The <code>roi_size</code> parameter specifies the size of the area around each pixel that will be manipulated by N2V. The <code>masked_pixel_percentage</code> parameter specifies how many pixels per patch will be manipulated.</p> <p>The parameters of the UNet can be specified in the <code>model_params</code> (passed as a parameter-value dictionary). Note that <code>use_n2v2</code> and 'n_channels' override the corresponding parameters passed in <code>model_params</code>.</p> <p>If you pass "horizontal" or "vertical" to <code>struct_n2v_axis</code>, then structN2V mask will be applied to each manipulated pixel.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>experiment_name</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>Name of the experiment.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>data_type</code> </td> <td> <code><span title=typing.Literal>Literal</span>[&#39;array&#39;, &#39;tiff&#39;, &#39;czi&#39;, &#39;custom&#39;]</code> </td> <td> <div class=doc-md-description> <p>Type of the data.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>axes</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>Axes of the data (e.g. SYX).</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>patch_size</code> </td> <td> <code><span title=List>List</span>[<span title=int>int</span>]</code> </td> <td> <div class=doc-md-description> <p>Size of the patches along the spatial dimensions (e.g. [64, 64]).</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>batch_size</code> </td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>Batch size.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>num_epochs</code> </td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>Number of epochs to train for. If provided, this will be added to trainer_params.</p> </div> </td> <td> <code>100</code> </td> </tr> <tr class=doc-section-item> <td> <code>num_steps</code> </td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>Number of batches in 1 epoch. If provided, this will be added to trainer_params. Translates to <code>limit_train_batches</code> in PyTorch Lightning Trainer. See relevant documentation for more details.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>augmentations</code> </td> <td> <code>list of transforms</code> </td> <td> <div class=doc-md-description> <p>List of transforms to apply, either both or one of XYFlipModel and XYRandomRotate90Model. By default, it applies both XYFlip (on X and Y) and XYRandomRotate90 (in XY) to the images.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>independent_channels</code> </td> <td> <code><span title=bool>bool</span></code> </td> <td> <div class=doc-md-description> <p>Whether to train all channels together, by default True.</p> </div> </td> <td> <code>True</code> </td> </tr> <tr class=doc-section-item> <td> <code>use_n2v2</code> </td> <td> <code><span title=bool>bool</span></code> </td> <td> <div class=doc-md-description> <p>Whether to use N2V2, by default False.</p> </div> </td> <td> <code>False</code> </td> </tr> <tr class=doc-section-item> <td> <code>n_channels</code> </td> <td> <code><span title=int>int</span> or None</code> </td> <td> <div class=doc-md-description> <p>Number of channels (in and out).</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>roi_size</code> </td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>N2V pixel manipulation area, by default 11.</p> </div> </td> <td> <code>11</code> </td> </tr> <tr class=doc-section-item> <td> <code>masked_pixel_percentage</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>Percentage of pixels masked in each patch, by default 0.2.</p> </div> </td> <td> <code>0.2</code> </td> </tr> <tr class=doc-section-item> <td> <code>struct_n2v_axis</code> </td> <td> <code><span title=typing.Literal>Literal</span>[&#39;horizontal&#39;, &#39;vertical&#39;, &#39;none&#39;]</code> </td> <td> <div class=doc-md-description> <p>Axis along which to apply structN2V mask, by default "none".</p> </div> </td> <td> <code>&#39;none&#39;</code> </td> </tr> <tr class=doc-section-item> <td> <code>struct_n2v_span</code> </td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>Span of the structN2V mask, by default 5.</p> </div> </td> <td> <code>5</code> </td> </tr> <tr class=doc-section-item> <td> <code>trainer_params</code> </td> <td> <code><span title=dict>dict</span></code> </td> <td> <div class=doc-md-description> <p>Parameters for the trainer, see the relevant documentation.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>logger</code> </td> <td> <code><span title=typing.Literal>Literal</span>[&#39;wandb&#39;, &#39;tensorboard&#39;, &#39;none&#39;]</code> </td> <td> <div class=doc-md-description> <p>Logger to use, by default "none".</p> </div> </td> <td> <code>&#39;none&#39;</code> </td> </tr> <tr class=doc-section-item> <td> <code>model_params</code> </td> <td> <code><span title=dict>dict</span></code> </td> <td> <div class=doc-md-description> <p>UNetModel parameters.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>optimizer</code> </td> <td> <code><span title=typing.Literal>Literal</span>[&#39;Adam&#39;, &#39;Adamax&#39;, &#39;SGD&#39;]</code> </td> <td> <div class=doc-md-description> <p>Optimizer to use.</p> </div> </td> <td> <code>&#34;Adam&#34;</code> </td> </tr> <tr class=doc-section-item> <td> <code>optimizer_params</code> </td> <td> <code><span title=dict>dict</span></code> </td> <td> <div class=doc-md-description> <p>Parameters for the optimizer, see PyTorch documentation for more details.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>lr_scheduler</code> </td> <td> <code><span title=typing.Literal>Literal</span>[&#39;ReduceLROnPlateau&#39;, &#39;StepLR&#39;]</code> </td> <td> <div class=doc-md-description> <p>Learning rate scheduler to use.</p> </div> </td> <td> <code>&#34;ReduceLROnPlateau&#34;</code> </td> </tr> <tr class=doc-section-item> <td> <code>lr_scheduler_params</code> </td> <td> <code><span title=dict>dict</span></code> </td> <td> <div class=doc-md-description> <p>Parameters for the learning rate scheduler, see PyTorch documentation for more details.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>train_dataloader_params</code> </td> <td> <code><span title=dict>dict</span></code> </td> <td> <div class=doc-md-description> <p>Parameters for the training dataloader, see the PyTorch docs for <code>DataLoader</code>. If left as <code>None</code>, the dict <code>{"shuffle": True}</code> will be used, this is set in the <code>GeneralDataConfig</code>.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>val_dataloader_params</code> </td> <td> <code><span title=dict>dict</span></code> </td> <td> <div class=doc-md-description> <p>Parameters for the validation dataloader, see PyTorch the docs for <code>DataLoader</code>. If left as <code>None</code>, the empty dict <code>{}</code> will be used, this is set in the <code>GeneralDataConfig</code>.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>checkpoint_params</code> </td> <td> <code><span title=dict>dict</span></code> </td> <td> <div class=doc-md-description> <p>Parameters for the checkpoint callback, see PyTorch Lightning documentation (<code>ModelCheckpoint</code>) for the list of available parameters.</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-internal" title="Configuration (careamics.config.configuration.Configuration)" href=../configuration/#careamics.config.configuration.Configuration>Configuration</a></code> </td> <td> <div class=doc-md-description> <p>Configuration for training N2V.</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Examples:</span></p> <p>Minimum example:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>config</span> <span class=o>=</span> <span class=n>create_n2v_configuration</span><span class=p>(</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=gp>... </span>    <span class=n>experiment_name</span><span class=o>=</span><span class=s2>&quot;n2v_experiment&quot;</span><span class=p>,</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=gp>... </span>    <span class=n>data_type</span><span class=o>=</span><span class=s2>&quot;array&quot;</span><span class=p>,</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=gp>... </span>    <span class=n>axes</span><span class=o>=</span><span class=s2>&quot;YX&quot;</span><span class=p>,</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=gp>... </span>    <span class=n>patch_size</span><span class=o>=</span><span class=p>[</span><span class=mi>64</span><span class=p>,</span> <span class=mi>64</span><span class=p>],</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=gp>... </span>    <span class=n>batch_size</span><span class=o>=</span><span class=mi>32</span><span class=p>,</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=gp>... </span>    <span class=n>num_epochs</span><span class=o>=</span><span class=mi>100</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a><span class=gp>... </span><span class=p>)</span>
</span></code></pre></div> <p>You can also limit the number of batches per epoch:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>config</span> <span class=o>=</span> <span class=n>create_n2v_configuration</span><span class=p>(</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=gp>... </span>    <span class=n>experiment_name</span><span class=o>=</span><span class=s2>&quot;n2v_experiment&quot;</span><span class=p>,</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=gp>... </span>    <span class=n>data_type</span><span class=o>=</span><span class=s2>&quot;array&quot;</span><span class=p>,</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=gp>... </span>    <span class=n>axes</span><span class=o>=</span><span class=s2>&quot;YX&quot;</span><span class=p>,</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=gp>... </span>    <span class=n>patch_size</span><span class=o>=</span><span class=p>[</span><span class=mi>64</span><span class=p>,</span> <span class=mi>64</span><span class=p>],</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=gp>... </span>    <span class=n>batch_size</span><span class=o>=</span><span class=mi>32</span><span class=p>,</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=gp>... </span>    <span class=n>num_steps</span><span class=o>=</span><span class=mi>100</span>  <span class=c1># limit to 100 batches per epoch</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a><span class=gp>... </span><span class=p>)</span>
</span></code></pre></div> <p>To disable transforms, simply set <code>augmentations</code> to an empty list:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>config</span> <span class=o>=</span> <span class=n>create_n2v_configuration</span><span class=p>(</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=gp>... </span>    <span class=n>experiment_name</span><span class=o>=</span><span class=s2>&quot;n2v_experiment&quot;</span><span class=p>,</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=gp>... </span>    <span class=n>data_type</span><span class=o>=</span><span class=s2>&quot;array&quot;</span><span class=p>,</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=gp>... </span>    <span class=n>axes</span><span class=o>=</span><span class=s2>&quot;YX&quot;</span><span class=p>,</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=gp>... </span>    <span class=n>patch_size</span><span class=o>=</span><span class=p>[</span><span class=mi>64</span><span class=p>,</span> <span class=mi>64</span><span class=p>],</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=gp>... </span>    <span class=n>batch_size</span><span class=o>=</span><span class=mi>32</span><span class=p>,</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=gp>... </span>    <span class=n>num_epochs</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a><span class=gp>... </span>    <span class=n>augmentations</span><span class=o>=</span><span class=p>[]</span>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a><span class=gp>... </span><span class=p>)</span>
</span></code></pre></div> <p>A list of transforms can be passed to the <code>augmentations</code> parameter:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=gp>&gt;&gt;&gt; </span><span class=kn>from</span><span class=w> </span><span class=nn>careamics.config.transformations</span><span class=w> </span><span class=kn>import</span> <span class=n>XYFlipModel</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=gp>&gt;&gt;&gt; </span><span class=n>config</span> <span class=o>=</span> <span class=n>create_n2v_configuration</span><span class=p>(</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=gp>... </span>    <span class=n>experiment_name</span><span class=o>=</span><span class=s2>&quot;n2v_experiment&quot;</span><span class=p>,</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=gp>... </span>    <span class=n>data_type</span><span class=o>=</span><span class=s2>&quot;array&quot;</span><span class=p>,</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=gp>... </span>    <span class=n>axes</span><span class=o>=</span><span class=s2>&quot;YX&quot;</span><span class=p>,</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=gp>... </span>    <span class=n>patch_size</span><span class=o>=</span><span class=p>[</span><span class=mi>64</span><span class=p>,</span> <span class=mi>64</span><span class=p>],</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=gp>... </span>    <span class=n>batch_size</span><span class=o>=</span><span class=mi>32</span><span class=p>,</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a><span class=gp>... </span>    <span class=n>num_epochs</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a><span class=gp>... </span>    <span class=n>augmentations</span><span class=o>=</span><span class=p>[</span>
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a><span class=gp>... </span>        <span class=c1># No rotation and only Y flipping</span>
</span><span id=__span-0-11><a id=__codelineno-0-11 name=__codelineno-0-11 href=#__codelineno-0-11></a><span class=gp>... </span>        <span class=n>XYFlipModel</span><span class=p>(</span><span class=n>flip_x</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span> <span class=n>flip_y</span> <span class=o>=</span> <span class=kc>True</span><span class=p>)</span>
</span><span id=__span-0-12><a id=__codelineno-0-12 name=__codelineno-0-12 href=#__codelineno-0-12></a><span class=gp>... </span>    <span class=p>]</span>
</span><span id=__span-0-13><a id=__codelineno-0-13 name=__codelineno-0-13 href=#__codelineno-0-13></a><span class=gp>... </span><span class=p>)</span>
</span></code></pre></div> <p>To use N2V2, simply pass the <code>use_n2v2</code> parameter:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>config</span> <span class=o>=</span> <span class=n>create_n2v_configuration</span><span class=p>(</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=gp>... </span>    <span class=n>experiment_name</span><span class=o>=</span><span class=s2>&quot;n2v2_experiment&quot;</span><span class=p>,</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=gp>... </span>    <span class=n>data_type</span><span class=o>=</span><span class=s2>&quot;tiff&quot;</span><span class=p>,</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=gp>... </span>    <span class=n>axes</span><span class=o>=</span><span class=s2>&quot;YX&quot;</span><span class=p>,</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=gp>... </span>    <span class=n>patch_size</span><span class=o>=</span><span class=p>[</span><span class=mi>64</span><span class=p>,</span> <span class=mi>64</span><span class=p>],</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=gp>... </span>    <span class=n>batch_size</span><span class=o>=</span><span class=mi>32</span><span class=p>,</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=gp>... </span>    <span class=n>num_epochs</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a><span class=gp>... </span>    <span class=n>use_n2v2</span><span class=o>=</span><span class=kc>True</span>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a><span class=gp>... </span><span class=p>)</span>
</span></code></pre></div> <p>For structN2V, there are two parameters to set, <code>struct_n2v_axis</code> and <code>struct_n2v_span</code>:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>config</span> <span class=o>=</span> <span class=n>create_n2v_configuration</span><span class=p>(</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=gp>... </span>    <span class=n>experiment_name</span><span class=o>=</span><span class=s2>&quot;structn2v_experiment&quot;</span><span class=p>,</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=gp>... </span>    <span class=n>data_type</span><span class=o>=</span><span class=s2>&quot;tiff&quot;</span><span class=p>,</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=gp>... </span>    <span class=n>axes</span><span class=o>=</span><span class=s2>&quot;YX&quot;</span><span class=p>,</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=gp>... </span>    <span class=n>patch_size</span><span class=o>=</span><span class=p>[</span><span class=mi>64</span><span class=p>,</span> <span class=mi>64</span><span class=p>],</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=gp>... </span>    <span class=n>batch_size</span><span class=o>=</span><span class=mi>32</span><span class=p>,</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=gp>... </span>    <span class=n>num_epochs</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a><span class=gp>... </span>    <span class=n>struct_n2v_axis</span><span class=o>=</span><span class=s2>&quot;horizontal&quot;</span><span class=p>,</span>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a><span class=gp>... </span>    <span class=n>struct_n2v_span</span><span class=o>=</span><span class=mi>7</span>
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a><span class=gp>... </span><span class=p>)</span>
</span></code></pre></div> <p>If you are training multiple channels they will be trained independently by default, you simply need to specify the number of channels:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>config</span> <span class=o>=</span> <span class=n>create_n2v_configuration</span><span class=p>(</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=gp>... </span>    <span class=n>experiment_name</span><span class=o>=</span><span class=s2>&quot;n2v_experiment&quot;</span><span class=p>,</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=gp>... </span>    <span class=n>data_type</span><span class=o>=</span><span class=s2>&quot;array&quot;</span><span class=p>,</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=gp>... </span>    <span class=n>axes</span><span class=o>=</span><span class=s2>&quot;YXC&quot;</span><span class=p>,</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=gp>... </span>    <span class=n>patch_size</span><span class=o>=</span><span class=p>[</span><span class=mi>64</span><span class=p>,</span> <span class=mi>64</span><span class=p>],</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=gp>... </span>    <span class=n>batch_size</span><span class=o>=</span><span class=mi>32</span><span class=p>,</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=gp>... </span>    <span class=n>num_epochs</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a><span class=gp>... </span>    <span class=n>n_channels</span><span class=o>=</span><span class=mi>3</span>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a><span class=gp>... </span><span class=p>)</span>
</span></code></pre></div> <p>If instead you want to train multiple channels together, you need to turn off the <code>independent_channels</code> parameter:</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>config</span> <span class=o>=</span> <span class=n>create_n2v_configuration</span><span class=p>(</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=gp>... </span>    <span class=n>experiment_name</span><span class=o>=</span><span class=s2>&quot;n2v_experiment&quot;</span><span class=p>,</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=gp>... </span>    <span class=n>data_type</span><span class=o>=</span><span class=s2>&quot;array&quot;</span><span class=p>,</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=gp>... </span>    <span class=n>axes</span><span class=o>=</span><span class=s2>&quot;YXC&quot;</span><span class=p>,</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=gp>... </span>    <span class=n>patch_size</span><span class=o>=</span><span class=p>[</span><span class=mi>64</span><span class=p>,</span> <span class=mi>64</span><span class=p>],</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=gp>... </span>    <span class=n>batch_size</span><span class=o>=</span><span class=mi>32</span><span class=p>,</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=gp>... </span>    <span class=n>num_epochs</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a><span class=gp>... </span>    <span class=n>independent_channels</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a><span class=gp>... </span>    <span class=n>n_channels</span><span class=o>=</span><span class=mi>3</span>
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a><span class=gp>... </span><span class=p>)</span>
</span></code></pre></div> <p>If you would like to train on CZI files, use <code>"czi"</code> as <code>data_type</code> and <code>"SCYX"</code> as <code>axes</code> for 2-D or <code>"SCZYX"</code> for 3-D denoising. Note that <code>"SCYX"</code> can also be used for 3-D data but spatial context along the Z dimension will then not be taken into account.</p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=gp>&gt;&gt;&gt; </span><span class=n>config_2d</span> <span class=o>=</span> <span class=n>create_n2v_configuration</span><span class=p>(</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=gp>... </span>    <span class=n>experiment_name</span><span class=o>=</span><span class=s2>&quot;n2v_experiment&quot;</span><span class=p>,</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=gp>... </span>    <span class=n>data_type</span><span class=o>=</span><span class=s2>&quot;czi&quot;</span><span class=p>,</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=gp>... </span>    <span class=n>axes</span><span class=o>=</span><span class=s2>&quot;SCYX&quot;</span><span class=p>,</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=gp>... </span>    <span class=n>patch_size</span><span class=o>=</span><span class=p>[</span><span class=mi>64</span><span class=p>,</span> <span class=mi>64</span><span class=p>],</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=gp>... </span>    <span class=n>batch_size</span><span class=o>=</span><span class=mi>32</span><span class=p>,</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=gp>... </span>    <span class=n>num_epochs</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a><span class=gp>... </span>    <span class=n>n_channels</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a><span class=gp>... </span><span class=p>)</span>
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a><span class=gp>&gt;&gt;&gt; </span><span class=n>config_3d</span> <span class=o>=</span> <span class=n>create_n2v_configuration</span><span class=p>(</span>
</span><span id=__span-0-11><a id=__codelineno-0-11 name=__codelineno-0-11 href=#__codelineno-0-11></a><span class=gp>... </span>    <span class=n>experiment_name</span><span class=o>=</span><span class=s2>&quot;n2v_experiment&quot;</span><span class=p>,</span>
</span><span id=__span-0-12><a id=__codelineno-0-12 name=__codelineno-0-12 href=#__codelineno-0-12></a><span class=gp>... </span>    <span class=n>data_type</span><span class=o>=</span><span class=s2>&quot;czi&quot;</span><span class=p>,</span>
</span><span id=__span-0-13><a id=__codelineno-0-13 name=__codelineno-0-13 href=#__codelineno-0-13></a><span class=gp>... </span>    <span class=n>axes</span><span class=o>=</span><span class=s2>&quot;SCZYX&quot;</span><span class=p>,</span>
</span><span id=__span-0-14><a id=__codelineno-0-14 name=__codelineno-0-14 href=#__codelineno-0-14></a><span class=gp>... </span>    <span class=n>patch_size</span><span class=o>=</span><span class=p>[</span><span class=mi>16</span><span class=p>,</span> <span class=mi>64</span><span class=p>,</span> <span class=mi>64</span><span class=p>],</span>
</span><span id=__span-0-15><a id=__codelineno-0-15 name=__codelineno-0-15 href=#__codelineno-0-15></a><span class=gp>... </span>    <span class=n>batch_size</span><span class=o>=</span><span class=mi>16</span><span class=p>,</span>
</span><span id=__span-0-16><a id=__codelineno-0-16 name=__codelineno-0-16 href=#__codelineno-0-16></a><span class=gp>... </span>    <span class=n>num_epochs</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span>
</span><span id=__span-0-17><a id=__codelineno-0-17 name=__codelineno-0-17 href=#__codelineno-0-17></a><span class=gp>... </span>    <span class=n>n_channels</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
</span><span id=__span-0-18><a id=__codelineno-0-18 name=__codelineno-0-18 href=#__codelineno-0-18></a><span class=gp>... </span><span class=p>)</span>
</span></code></pre></div> <details class=quote> <summary>Source code in <code>src/careamics/config/configuration_factories.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-1103>1103</a></span>
<span class=normal><a href=#__codelineno-0-1104>1104</a></span>
<span class=normal><a href=#__codelineno-0-1105>1105</a></span>
<span class=normal><a href=#__codelineno-0-1106>1106</a></span>
<span class=normal><a href=#__codelineno-0-1107>1107</a></span>
<span class=normal><a href=#__codelineno-0-1108>1108</a></span>
<span class=normal><a href=#__codelineno-0-1109>1109</a></span>
<span class=normal><a href=#__codelineno-0-1110>1110</a></span>
<span class=normal><a href=#__codelineno-0-1111>1111</a></span>
<span class=normal><a href=#__codelineno-0-1112>1112</a></span>
<span class=normal><a href=#__codelineno-0-1113>1113</a></span>
<span class=normal><a href=#__codelineno-0-1114>1114</a></span>
<span class=normal><a href=#__codelineno-0-1115>1115</a></span>
<span class=normal><a href=#__codelineno-0-1116>1116</a></span>
<span class=normal><a href=#__codelineno-0-1117>1117</a></span>
<span class=normal><a href=#__codelineno-0-1118>1118</a></span>
<span class=normal><a href=#__codelineno-0-1119>1119</a></span>
<span class=normal><a href=#__codelineno-0-1120>1120</a></span>
<span class=normal><a href=#__codelineno-0-1121>1121</a></span>
<span class=normal><a href=#__codelineno-0-1122>1122</a></span>
<span class=normal><a href=#__codelineno-0-1123>1123</a></span>
<span class=normal><a href=#__codelineno-0-1124>1124</a></span>
<span class=normal><a href=#__codelineno-0-1125>1125</a></span>
<span class=normal><a href=#__codelineno-0-1126>1126</a></span>
<span class=normal><a href=#__codelineno-0-1127>1127</a></span>
<span class=normal><a href=#__codelineno-0-1128>1128</a></span>
<span class=normal><a href=#__codelineno-0-1129>1129</a></span>
<span class=normal><a href=#__codelineno-0-1130>1130</a></span>
<span class=normal><a href=#__codelineno-0-1131>1131</a></span>
<span class=normal><a href=#__codelineno-0-1132>1132</a></span>
<span class=normal><a href=#__codelineno-0-1133>1133</a></span>
<span class=normal><a href=#__codelineno-0-1134>1134</a></span>
<span class=normal><a href=#__codelineno-0-1135>1135</a></span>
<span class=normal><a href=#__codelineno-0-1136>1136</a></span>
<span class=normal><a href=#__codelineno-0-1137>1137</a></span>
<span class=normal><a href=#__codelineno-0-1138>1138</a></span>
<span class=normal><a href=#__codelineno-0-1139>1139</a></span>
<span class=normal><a href=#__codelineno-0-1140>1140</a></span>
<span class=normal><a href=#__codelineno-0-1141>1141</a></span>
<span class=normal><a href=#__codelineno-0-1142>1142</a></span>
<span class=normal><a href=#__codelineno-0-1143>1143</a></span>
<span class=normal><a href=#__codelineno-0-1144>1144</a></span>
<span class=normal><a href=#__codelineno-0-1145>1145</a></span>
<span class=normal><a href=#__codelineno-0-1146>1146</a></span>
<span class=normal><a href=#__codelineno-0-1147>1147</a></span>
<span class=normal><a href=#__codelineno-0-1148>1148</a></span>
<span class=normal><a href=#__codelineno-0-1149>1149</a></span>
<span class=normal><a href=#__codelineno-0-1150>1150</a></span>
<span class=normal><a href=#__codelineno-0-1151>1151</a></span>
<span class=normal><a href=#__codelineno-0-1152>1152</a></span>
<span class=normal><a href=#__codelineno-0-1153>1153</a></span>
<span class=normal><a href=#__codelineno-0-1154>1154</a></span>
<span class=normal><a href=#__codelineno-0-1155>1155</a></span>
<span class=normal><a href=#__codelineno-0-1156>1156</a></span>
<span class=normal><a href=#__codelineno-0-1157>1157</a></span>
<span class=normal><a href=#__codelineno-0-1158>1158</a></span>
<span class=normal><a href=#__codelineno-0-1159>1159</a></span>
<span class=normal><a href=#__codelineno-0-1160>1160</a></span>
<span class=normal><a href=#__codelineno-0-1161>1161</a></span>
<span class=normal><a href=#__codelineno-0-1162>1162</a></span>
<span class=normal><a href=#__codelineno-0-1163>1163</a></span>
<span class=normal><a href=#__codelineno-0-1164>1164</a></span>
<span class=normal><a href=#__codelineno-0-1165>1165</a></span>
<span class=normal><a href=#__codelineno-0-1166>1166</a></span>
<span class=normal><a href=#__codelineno-0-1167>1167</a></span>
<span class=normal><a href=#__codelineno-0-1168>1168</a></span>
<span class=normal><a href=#__codelineno-0-1169>1169</a></span>
<span class=normal><a href=#__codelineno-0-1170>1170</a></span>
<span class=normal><a href=#__codelineno-0-1171>1171</a></span>
<span class=normal><a href=#__codelineno-0-1172>1172</a></span>
<span class=normal><a href=#__codelineno-0-1173>1173</a></span>
<span class=normal><a href=#__codelineno-0-1174>1174</a></span>
<span class=normal><a href=#__codelineno-0-1175>1175</a></span>
<span class=normal><a href=#__codelineno-0-1176>1176</a></span>
<span class=normal><a href=#__codelineno-0-1177>1177</a></span>
<span class=normal><a href=#__codelineno-0-1178>1178</a></span>
<span class=normal><a href=#__codelineno-0-1179>1179</a></span>
<span class=normal><a href=#__codelineno-0-1180>1180</a></span>
<span class=normal><a href=#__codelineno-0-1181>1181</a></span>
<span class=normal><a href=#__codelineno-0-1182>1182</a></span>
<span class=normal><a href=#__codelineno-0-1183>1183</a></span>
<span class=normal><a href=#__codelineno-0-1184>1184</a></span>
<span class=normal><a href=#__codelineno-0-1185>1185</a></span>
<span class=normal><a href=#__codelineno-0-1186>1186</a></span>
<span class=normal><a href=#__codelineno-0-1187>1187</a></span>
<span class=normal><a href=#__codelineno-0-1188>1188</a></span>
<span class=normal><a href=#__codelineno-0-1189>1189</a></span>
<span class=normal><a href=#__codelineno-0-1190>1190</a></span>
<span class=normal><a href=#__codelineno-0-1191>1191</a></span>
<span class=normal><a href=#__codelineno-0-1192>1192</a></span>
<span class=normal><a href=#__codelineno-0-1193>1193</a></span>
<span class=normal><a href=#__codelineno-0-1194>1194</a></span>
<span class=normal><a href=#__codelineno-0-1195>1195</a></span>
<span class=normal><a href=#__codelineno-0-1196>1196</a></span>
<span class=normal><a href=#__codelineno-0-1197>1197</a></span>
<span class=normal><a href=#__codelineno-0-1198>1198</a></span>
<span class=normal><a href=#__codelineno-0-1199>1199</a></span>
<span class=normal><a href=#__codelineno-0-1200>1200</a></span>
<span class=normal><a href=#__codelineno-0-1201>1201</a></span>
<span class=normal><a href=#__codelineno-0-1202>1202</a></span>
<span class=normal><a href=#__codelineno-0-1203>1203</a></span>
<span class=normal><a href=#__codelineno-0-1204>1204</a></span>
<span class=normal><a href=#__codelineno-0-1205>1205</a></span>
<span class=normal><a href=#__codelineno-0-1206>1206</a></span>
<span class=normal><a href=#__codelineno-0-1207>1207</a></span>
<span class=normal><a href=#__codelineno-0-1208>1208</a></span>
<span class=normal><a href=#__codelineno-0-1209>1209</a></span>
<span class=normal><a href=#__codelineno-0-1210>1210</a></span>
<span class=normal><a href=#__codelineno-0-1211>1211</a></span>
<span class=normal><a href=#__codelineno-0-1212>1212</a></span>
<span class=normal><a href=#__codelineno-0-1213>1213</a></span>
<span class=normal><a href=#__codelineno-0-1214>1214</a></span>
<span class=normal><a href=#__codelineno-0-1215>1215</a></span>
<span class=normal><a href=#__codelineno-0-1216>1216</a></span>
<span class=normal><a href=#__codelineno-0-1217>1217</a></span>
<span class=normal><a href=#__codelineno-0-1218>1218</a></span>
<span class=normal><a href=#__codelineno-0-1219>1219</a></span>
<span class=normal><a href=#__codelineno-0-1220>1220</a></span>
<span class=normal><a href=#__codelineno-0-1221>1221</a></span>
<span class=normal><a href=#__codelineno-0-1222>1222</a></span>
<span class=normal><a href=#__codelineno-0-1223>1223</a></span>
<span class=normal><a href=#__codelineno-0-1224>1224</a></span>
<span class=normal><a href=#__codelineno-0-1225>1225</a></span>
<span class=normal><a href=#__codelineno-0-1226>1226</a></span>
<span class=normal><a href=#__codelineno-0-1227>1227</a></span>
<span class=normal><a href=#__codelineno-0-1228>1228</a></span>
<span class=normal><a href=#__codelineno-0-1229>1229</a></span>
<span class=normal><a href=#__codelineno-0-1230>1230</a></span>
<span class=normal><a href=#__codelineno-0-1231>1231</a></span>
<span class=normal><a href=#__codelineno-0-1232>1232</a></span>
<span class=normal><a href=#__codelineno-0-1233>1233</a></span>
<span class=normal><a href=#__codelineno-0-1234>1234</a></span>
<span class=normal><a href=#__codelineno-0-1235>1235</a></span>
<span class=normal><a href=#__codelineno-0-1236>1236</a></span>
<span class=normal><a href=#__codelineno-0-1237>1237</a></span>
<span class=normal><a href=#__codelineno-0-1238>1238</a></span>
<span class=normal><a href=#__codelineno-0-1239>1239</a></span>
<span class=normal><a href=#__codelineno-0-1240>1240</a></span>
<span class=normal><a href=#__codelineno-0-1241>1241</a></span>
<span class=normal><a href=#__codelineno-0-1242>1242</a></span>
<span class=normal><a href=#__codelineno-0-1243>1243</a></span>
<span class=normal><a href=#__codelineno-0-1244>1244</a></span>
<span class=normal><a href=#__codelineno-0-1245>1245</a></span>
<span class=normal><a href=#__codelineno-0-1246>1246</a></span>
<span class=normal><a href=#__codelineno-0-1247>1247</a></span>
<span class=normal><a href=#__codelineno-0-1248>1248</a></span>
<span class=normal><a href=#__codelineno-0-1249>1249</a></span>
<span class=normal><a href=#__codelineno-0-1250>1250</a></span>
<span class=normal><a href=#__codelineno-0-1251>1251</a></span>
<span class=normal><a href=#__codelineno-0-1252>1252</a></span>
<span class=normal><a href=#__codelineno-0-1253>1253</a></span>
<span class=normal><a href=#__codelineno-0-1254>1254</a></span>
<span class=normal><a href=#__codelineno-0-1255>1255</a></span>
<span class=normal><a href=#__codelineno-0-1256>1256</a></span>
<span class=normal><a href=#__codelineno-0-1257>1257</a></span>
<span class=normal><a href=#__codelineno-0-1258>1258</a></span>
<span class=normal><a href=#__codelineno-0-1259>1259</a></span>
<span class=normal><a href=#__codelineno-0-1260>1260</a></span>
<span class=normal><a href=#__codelineno-0-1261>1261</a></span>
<span class=normal><a href=#__codelineno-0-1262>1262</a></span>
<span class=normal><a href=#__codelineno-0-1263>1263</a></span>
<span class=normal><a href=#__codelineno-0-1264>1264</a></span>
<span class=normal><a href=#__codelineno-0-1265>1265</a></span>
<span class=normal><a href=#__codelineno-0-1266>1266</a></span>
<span class=normal><a href=#__codelineno-0-1267>1267</a></span>
<span class=normal><a href=#__codelineno-0-1268>1268</a></span>
<span class=normal><a href=#__codelineno-0-1269>1269</a></span>
<span class=normal><a href=#__codelineno-0-1270>1270</a></span>
<span class=normal><a href=#__codelineno-0-1271>1271</a></span>
<span class=normal><a href=#__codelineno-0-1272>1272</a></span>
<span class=normal><a href=#__codelineno-0-1273>1273</a></span>
<span class=normal><a href=#__codelineno-0-1274>1274</a></span>
<span class=normal><a href=#__codelineno-0-1275>1275</a></span>
<span class=normal><a href=#__codelineno-0-1276>1276</a></span>
<span class=normal><a href=#__codelineno-0-1277>1277</a></span>
<span class=normal><a href=#__codelineno-0-1278>1278</a></span>
<span class=normal><a href=#__codelineno-0-1279>1279</a></span>
<span class=normal><a href=#__codelineno-0-1280>1280</a></span>
<span class=normal><a href=#__codelineno-0-1281>1281</a></span>
<span class=normal><a href=#__codelineno-0-1282>1282</a></span>
<span class=normal><a href=#__codelineno-0-1283>1283</a></span>
<span class=normal><a href=#__codelineno-0-1284>1284</a></span>
<span class=normal><a href=#__codelineno-0-1285>1285</a></span>
<span class=normal><a href=#__codelineno-0-1286>1286</a></span>
<span class=normal><a href=#__codelineno-0-1287>1287</a></span>
<span class=normal><a href=#__codelineno-0-1288>1288</a></span>
<span class=normal><a href=#__codelineno-0-1289>1289</a></span>
<span class=normal><a href=#__codelineno-0-1290>1290</a></span>
<span class=normal><a href=#__codelineno-0-1291>1291</a></span>
<span class=normal><a href=#__codelineno-0-1292>1292</a></span>
<span class=normal><a href=#__codelineno-0-1293>1293</a></span>
<span class=normal><a href=#__codelineno-0-1294>1294</a></span>
<span class=normal><a href=#__codelineno-0-1295>1295</a></span>
<span class=normal><a href=#__codelineno-0-1296>1296</a></span>
<span class=normal><a href=#__codelineno-0-1297>1297</a></span>
<span class=normal><a href=#__codelineno-0-1298>1298</a></span>
<span class=normal><a href=#__codelineno-0-1299>1299</a></span>
<span class=normal><a href=#__codelineno-0-1300>1300</a></span>
<span class=normal><a href=#__codelineno-0-1301>1301</a></span>
<span class=normal><a href=#__codelineno-0-1302>1302</a></span>
<span class=normal><a href=#__codelineno-0-1303>1303</a></span>
<span class=normal><a href=#__codelineno-0-1304>1304</a></span>
<span class=normal><a href=#__codelineno-0-1305>1305</a></span>
<span class=normal><a href=#__codelineno-0-1306>1306</a></span>
<span class=normal><a href=#__codelineno-0-1307>1307</a></span>
<span class=normal><a href=#__codelineno-0-1308>1308</a></span>
<span class=normal><a href=#__codelineno-0-1309>1309</a></span>
<span class=normal><a href=#__codelineno-0-1310>1310</a></span>
<span class=normal><a href=#__codelineno-0-1311>1311</a></span>
<span class=normal><a href=#__codelineno-0-1312>1312</a></span>
<span class=normal><a href=#__codelineno-0-1313>1313</a></span>
<span class=normal><a href=#__codelineno-0-1314>1314</a></span>
<span class=normal><a href=#__codelineno-0-1315>1315</a></span>
<span class=normal><a href=#__codelineno-0-1316>1316</a></span>
<span class=normal><a href=#__codelineno-0-1317>1317</a></span>
<span class=normal><a href=#__codelineno-0-1318>1318</a></span>
<span class=normal><a href=#__codelineno-0-1319>1319</a></span>
<span class=normal><a href=#__codelineno-0-1320>1320</a></span>
<span class=normal><a href=#__codelineno-0-1321>1321</a></span>
<span class=normal><a href=#__codelineno-0-1322>1322</a></span>
<span class=normal><a href=#__codelineno-0-1323>1323</a></span>
<span class=normal><a href=#__codelineno-0-1324>1324</a></span>
<span class=normal><a href=#__codelineno-0-1325>1325</a></span>
<span class=normal><a href=#__codelineno-0-1326>1326</a></span>
<span class=normal><a href=#__codelineno-0-1327>1327</a></span>
<span class=normal><a href=#__codelineno-0-1328>1328</a></span>
<span class=normal><a href=#__codelineno-0-1329>1329</a></span>
<span class=normal><a href=#__codelineno-0-1330>1330</a></span>
<span class=normal><a href=#__codelineno-0-1331>1331</a></span>
<span class=normal><a href=#__codelineno-0-1332>1332</a></span>
<span class=normal><a href=#__codelineno-0-1333>1333</a></span>
<span class=normal><a href=#__codelineno-0-1334>1334</a></span>
<span class=normal><a href=#__codelineno-0-1335>1335</a></span>
<span class=normal><a href=#__codelineno-0-1336>1336</a></span>
<span class=normal><a href=#__codelineno-0-1337>1337</a></span>
<span class=normal><a href=#__codelineno-0-1338>1338</a></span>
<span class=normal><a href=#__codelineno-0-1339>1339</a></span>
<span class=normal><a href=#__codelineno-0-1340>1340</a></span>
<span class=normal><a href=#__codelineno-0-1341>1341</a></span>
<span class=normal><a href=#__codelineno-0-1342>1342</a></span>
<span class=normal><a href=#__codelineno-0-1343>1343</a></span>
<span class=normal><a href=#__codelineno-0-1344>1344</a></span>
<span class=normal><a href=#__codelineno-0-1345>1345</a></span>
<span class=normal><a href=#__codelineno-0-1346>1346</a></span>
<span class=normal><a href=#__codelineno-0-1347>1347</a></span>
<span class=normal><a href=#__codelineno-0-1348>1348</a></span>
<span class=normal><a href=#__codelineno-0-1349>1349</a></span>
<span class=normal><a href=#__codelineno-0-1350>1350</a></span>
<span class=normal><a href=#__codelineno-0-1351>1351</a></span>
<span class=normal><a href=#__codelineno-0-1352>1352</a></span>
<span class=normal><a href=#__codelineno-0-1353>1353</a></span>
<span class=normal><a href=#__codelineno-0-1354>1354</a></span>
<span class=normal><a href=#__codelineno-0-1355>1355</a></span>
<span class=normal><a href=#__codelineno-0-1356>1356</a></span>
<span class=normal><a href=#__codelineno-0-1357>1357</a></span>
<span class=normal><a href=#__codelineno-0-1358>1358</a></span>
<span class=normal><a href=#__codelineno-0-1359>1359</a></span>
<span class=normal><a href=#__codelineno-0-1360>1360</a></span>
<span class=normal><a href=#__codelineno-0-1361>1361</a></span>
<span class=normal><a href=#__codelineno-0-1362>1362</a></span>
<span class=normal><a href=#__codelineno-0-1363>1363</a></span>
<span class=normal><a href=#__codelineno-0-1364>1364</a></span>
<span class=normal><a href=#__codelineno-0-1365>1365</a></span>
<span class=normal><a href=#__codelineno-0-1366>1366</a></span>
<span class=normal><a href=#__codelineno-0-1367>1367</a></span>
<span class=normal><a href=#__codelineno-0-1368>1368</a></span>
<span class=normal><a href=#__codelineno-0-1369>1369</a></span>
<span class=normal><a href=#__codelineno-0-1370>1370</a></span>
<span class=normal><a href=#__codelineno-0-1371>1371</a></span>
<span class=normal><a href=#__codelineno-0-1372>1372</a></span>
<span class=normal><a href=#__codelineno-0-1373>1373</a></span>
<span class=normal><a href=#__codelineno-0-1374>1374</a></span>
<span class=normal><a href=#__codelineno-0-1375>1375</a></span>
<span class=normal><a href=#__codelineno-0-1376>1376</a></span>
<span class=normal><a href=#__codelineno-0-1377>1377</a></span>
<span class=normal><a href=#__codelineno-0-1378>1378</a></span>
<span class=normal><a href=#__codelineno-0-1379>1379</a></span>
<span class=normal><a href=#__codelineno-0-1380>1380</a></span>
<span class=normal><a href=#__codelineno-0-1381>1381</a></span>
<span class=normal><a href=#__codelineno-0-1382>1382</a></span>
<span class=normal><a href=#__codelineno-0-1383>1383</a></span>
<span class=normal><a href=#__codelineno-0-1384>1384</a></span>
<span class=normal><a href=#__codelineno-0-1385>1385</a></span>
<span class=normal><a href=#__codelineno-0-1386>1386</a></span>
<span class=normal><a href=#__codelineno-0-1387>1387</a></span>
<span class=normal><a href=#__codelineno-0-1388>1388</a></span>
<span class=normal><a href=#__codelineno-0-1389>1389</a></span>
<span class=normal><a href=#__codelineno-0-1390>1390</a></span>
<span class=normal><a href=#__codelineno-0-1391>1391</a></span>
<span class=normal><a href=#__codelineno-0-1392>1392</a></span>
<span class=normal><a href=#__codelineno-0-1393>1393</a></span>
<span class=normal><a href=#__codelineno-0-1394>1394</a></span>
<span class=normal><a href=#__codelineno-0-1395>1395</a></span>
<span class=normal><a href=#__codelineno-0-1396>1396</a></span>
<span class=normal><a href=#__codelineno-0-1397>1397</a></span>
<span class=normal><a href=#__codelineno-0-1398>1398</a></span>
<span class=normal><a href=#__codelineno-0-1399>1399</a></span>
<span class=normal><a href=#__codelineno-0-1400>1400</a></span>
<span class=normal><a href=#__codelineno-0-1401>1401</a></span>
<span class=normal><a href=#__codelineno-0-1402>1402</a></span>
<span class=normal><a href=#__codelineno-0-1403>1403</a></span>
<span class=normal><a href=#__codelineno-0-1404>1404</a></span>
<span class=normal><a href=#__codelineno-0-1405>1405</a></span>
<span class=normal><a href=#__codelineno-0-1406>1406</a></span>
<span class=normal><a href=#__codelineno-0-1407>1407</a></span>
<span class=normal><a href=#__codelineno-0-1408>1408</a></span>
<span class=normal><a href=#__codelineno-0-1409>1409</a></span>
<span class=normal><a href=#__codelineno-0-1410>1410</a></span>
<span class=normal><a href=#__codelineno-0-1411>1411</a></span>
<span class=normal><a href=#__codelineno-0-1412>1412</a></span>
<span class=normal><a href=#__codelineno-0-1413>1413</a></span>
<span class=normal><a href=#__codelineno-0-1414>1414</a></span>
<span class=normal><a href=#__codelineno-0-1415>1415</a></span>
<span class=normal><a href=#__codelineno-0-1416>1416</a></span>
<span class=normal><a href=#__codelineno-0-1417>1417</a></span>
<span class=normal><a href=#__codelineno-0-1418>1418</a></span>
<span class=normal><a href=#__codelineno-0-1419>1419</a></span>
<span class=normal><a href=#__codelineno-0-1420>1420</a></span>
<span class=normal><a href=#__codelineno-0-1421>1421</a></span>
<span class=normal><a href=#__codelineno-0-1422>1422</a></span>
<span class=normal><a href=#__codelineno-0-1423>1423</a></span>
<span class=normal><a href=#__codelineno-0-1424>1424</a></span>
<span class=normal><a href=#__codelineno-0-1425>1425</a></span>
<span class=normal><a href=#__codelineno-0-1426>1426</a></span>
<span class=normal><a href=#__codelineno-0-1427>1427</a></span>
<span class=normal><a href=#__codelineno-0-1428>1428</a></span>
<span class=normal><a href=#__codelineno-0-1429>1429</a></span>
<span class=normal><a href=#__codelineno-0-1430>1430</a></span>
<span class=normal><a href=#__codelineno-0-1431>1431</a></span>
<span class=normal><a href=#__codelineno-0-1432>1432</a></span>
<span class=normal><a href=#__codelineno-0-1433>1433</a></span>
<span class=normal><a href=#__codelineno-0-1434>1434</a></span>
<span class=normal><a href=#__codelineno-0-1435>1435</a></span>
<span class=normal><a href=#__codelineno-0-1436>1436</a></span>
<span class=normal><a href=#__codelineno-0-1437>1437</a></span>
<span class=normal><a href=#__codelineno-0-1438>1438</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-1103><a id=__codelineno-0-1103 name=__codelineno-0-1103></a><span class=k>def</span><span class=w> </span><span class=nf>create_n2v_configuration</span><span class=p>(</span>
</span><span id=__span-0-1104><a id=__codelineno-0-1104 name=__codelineno-0-1104></a>    <span class=n>experiment_name</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span><span id=__span-0-1105><a id=__codelineno-0-1105 name=__codelineno-0-1105></a>    <span class=n>data_type</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span><span class=s2>&quot;array&quot;</span><span class=p>,</span> <span class=s2>&quot;tiff&quot;</span><span class=p>,</span> <span class=s2>&quot;czi&quot;</span><span class=p>,</span> <span class=s2>&quot;custom&quot;</span><span class=p>],</span>
</span><span id=__span-0-1106><a id=__codelineno-0-1106 name=__codelineno-0-1106></a>    <span class=n>axes</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span><span id=__span-0-1107><a id=__codelineno-0-1107 name=__codelineno-0-1107></a>    <span class=n>patch_size</span><span class=p>:</span> <span class=n>Sequence</span><span class=p>[</span><span class=nb>int</span><span class=p>],</span>
</span><span id=__span-0-1108><a id=__codelineno-0-1108 name=__codelineno-0-1108></a>    <span class=n>batch_size</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span><span id=__span-0-1109><a id=__codelineno-0-1109 name=__codelineno-0-1109></a>    <span class=n>num_epochs</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>100</span><span class=p>,</span>
</span><span id=__span-0-1110><a id=__codelineno-0-1110 name=__codelineno-0-1110></a>    <span class=n>num_steps</span><span class=p>:</span> <span class=nb>int</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-1111><a id=__codelineno-0-1111 name=__codelineno-0-1111></a>    <span class=n>augmentations</span><span class=p>:</span> <span class=nb>list</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=n>XYFlipModel</span><span class=p>,</span> <span class=n>XYRandomRotate90Model</span><span class=p>]]</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-1112><a id=__codelineno-0-1112 name=__codelineno-0-1112></a>    <span class=n>independent_channels</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
</span><span id=__span-0-1113><a id=__codelineno-0-1113 name=__codelineno-0-1113></a>    <span class=n>use_n2v2</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-0-1114><a id=__codelineno-0-1114 name=__codelineno-0-1114></a>    <span class=n>n_channels</span><span class=p>:</span> <span class=nb>int</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-1115><a id=__codelineno-0-1115 name=__codelineno-0-1115></a>    <span class=n>roi_size</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>11</span><span class=p>,</span>
</span><span id=__span-0-1116><a id=__codelineno-0-1116 name=__codelineno-0-1116></a>    <span class=n>masked_pixel_percentage</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.2</span><span class=p>,</span>
</span><span id=__span-0-1117><a id=__codelineno-0-1117 name=__codelineno-0-1117></a>    <span class=n>struct_n2v_axis</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span><span class=s2>&quot;horizontal&quot;</span><span class=p>,</span> <span class=s2>&quot;vertical&quot;</span><span class=p>,</span> <span class=s2>&quot;none&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=s2>&quot;none&quot;</span><span class=p>,</span>
</span><span id=__span-0-1118><a id=__codelineno-0-1118 name=__codelineno-0-1118></a>    <span class=n>struct_n2v_span</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>5</span><span class=p>,</span>
</span><span id=__span-0-1119><a id=__codelineno-0-1119 name=__codelineno-0-1119></a>    <span class=n>trainer_params</span><span class=p>:</span> <span class=nb>dict</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-1120><a id=__codelineno-0-1120 name=__codelineno-0-1120></a>    <span class=n>logger</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span><span class=s2>&quot;wandb&quot;</span><span class=p>,</span> <span class=s2>&quot;tensorboard&quot;</span><span class=p>,</span> <span class=s2>&quot;none&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=s2>&quot;none&quot;</span><span class=p>,</span>
</span><span id=__span-0-1121><a id=__codelineno-0-1121 name=__codelineno-0-1121></a>    <span class=n>model_params</span><span class=p>:</span> <span class=nb>dict</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-1122><a id=__codelineno-0-1122 name=__codelineno-0-1122></a>    <span class=n>optimizer</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span><span class=s2>&quot;Adam&quot;</span><span class=p>,</span> <span class=s2>&quot;Adamax&quot;</span><span class=p>,</span> <span class=s2>&quot;SGD&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=s2>&quot;Adam&quot;</span><span class=p>,</span>
</span><span id=__span-0-1123><a id=__codelineno-0-1123 name=__codelineno-0-1123></a>    <span class=n>optimizer_params</span><span class=p>:</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-1124><a id=__codelineno-0-1124 name=__codelineno-0-1124></a>    <span class=n>lr_scheduler</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span><span class=s2>&quot;ReduceLROnPlateau&quot;</span><span class=p>,</span> <span class=s2>&quot;StepLR&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=s2>&quot;ReduceLROnPlateau&quot;</span><span class=p>,</span>
</span><span id=__span-0-1125><a id=__codelineno-0-1125 name=__codelineno-0-1125></a>    <span class=n>lr_scheduler_params</span><span class=p>:</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-1126><a id=__codelineno-0-1126 name=__codelineno-0-1126></a>    <span class=n>train_dataloader_params</span><span class=p>:</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-1127><a id=__codelineno-0-1127 name=__codelineno-0-1127></a>    <span class=n>val_dataloader_params</span><span class=p>:</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-1128><a id=__codelineno-0-1128 name=__codelineno-0-1128></a>    <span class=n>checkpoint_params</span><span class=p>:</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-1129><a id=__codelineno-0-1129 name=__codelineno-0-1129></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Configuration</span><span class=p>:</span>
</span><span id=__span-0-1130><a id=__codelineno-0-1130 name=__codelineno-0-1130></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-1131><a id=__codelineno-0-1131 name=__codelineno-0-1131></a><span class=sd>    Create a configuration for training Noise2Void.</span>
</span><span id=__span-0-1132><a id=__codelineno-0-1132 name=__codelineno-0-1132></a>
</span><span id=__span-0-1133><a id=__codelineno-0-1133 name=__codelineno-0-1133></a><span class=sd>    N2V uses a UNet model to denoise images in a self-supervised manner. To use its</span>
</span><span id=__span-0-1134><a id=__codelineno-0-1134 name=__codelineno-0-1134></a><span class=sd>    variants structN2V and N2V2, set the `struct_n2v_axis` and `struct_n2v_span`</span>
</span><span id=__span-0-1135><a id=__codelineno-0-1135 name=__codelineno-0-1135></a><span class=sd>    (structN2V) parameters, or set `use_n2v2` to True (N2V2).</span>
</span><span id=__span-0-1136><a id=__codelineno-0-1136 name=__codelineno-0-1136></a>
</span><span id=__span-0-1137><a id=__codelineno-0-1137 name=__codelineno-0-1137></a><span class=sd>    N2V2 modifies the UNet architecture by adding blur pool layers and removes the skip</span>
</span><span id=__span-0-1138><a id=__codelineno-0-1138 name=__codelineno-0-1138></a><span class=sd>    connections, thus removing checkboard artefacts. StructN2V is used when vertical</span>
</span><span id=__span-0-1139><a id=__codelineno-0-1139 name=__codelineno-0-1139></a><span class=sd>    or horizontal correlations are present in the noise; it applies an additional mask</span>
</span><span id=__span-0-1140><a id=__codelineno-0-1140 name=__codelineno-0-1140></a><span class=sd>    to the manipulated pixel neighbors.</span>
</span><span id=__span-0-1141><a id=__codelineno-0-1141 name=__codelineno-0-1141></a>
</span><span id=__span-0-1142><a id=__codelineno-0-1142 name=__codelineno-0-1142></a><span class=sd>    If &quot;Z&quot; is present in `axes`, then `path_size` must be a list of length 3, otherwise</span>
</span><span id=__span-0-1143><a id=__codelineno-0-1143 name=__codelineno-0-1143></a><span class=sd>    2.</span>
</span><span id=__span-0-1144><a id=__codelineno-0-1144 name=__codelineno-0-1144></a>
</span><span id=__span-0-1145><a id=__codelineno-0-1145 name=__codelineno-0-1145></a><span class=sd>    If &quot;C&quot; is present in `axes`, then you need to set `n_channels` to the number of</span>
</span><span id=__span-0-1146><a id=__codelineno-0-1146 name=__codelineno-0-1146></a><span class=sd>    channels.</span>
</span><span id=__span-0-1147><a id=__codelineno-0-1147 name=__codelineno-0-1147></a>
</span><span id=__span-0-1148><a id=__codelineno-0-1148 name=__codelineno-0-1148></a><span class=sd>    By default, all channels are trained independently. To train all channels together,</span>
</span><span id=__span-0-1149><a id=__codelineno-0-1149 name=__codelineno-0-1149></a><span class=sd>    set `independent_channels` to False.</span>
</span><span id=__span-0-1150><a id=__codelineno-0-1150 name=__codelineno-0-1150></a>
</span><span id=__span-0-1151><a id=__codelineno-0-1151 name=__codelineno-0-1151></a><span class=sd>    By default, the transformations applied are a random flip along X or Y, and a random</span>
</span><span id=__span-0-1152><a id=__codelineno-0-1152 name=__codelineno-0-1152></a><span class=sd>    90 degrees rotation in the XY plane. Normalization is always applied, as well as the</span>
</span><span id=__span-0-1153><a id=__codelineno-0-1153 name=__codelineno-0-1153></a><span class=sd>    N2V manipulation.</span>
</span><span id=__span-0-1154><a id=__codelineno-0-1154 name=__codelineno-0-1154></a>
</span><span id=__span-0-1155><a id=__codelineno-0-1155 name=__codelineno-0-1155></a><span class=sd>    By setting `augmentations` to `None`, the default transformations (flip in X and Y,</span>
</span><span id=__span-0-1156><a id=__codelineno-0-1156 name=__codelineno-0-1156></a><span class=sd>    rotations by 90 degrees in the XY plane) are applied. Rather than the default</span>
</span><span id=__span-0-1157><a id=__codelineno-0-1157 name=__codelineno-0-1157></a><span class=sd>    transforms, a list of transforms can be passed to the `augmentations` parameter. To</span>
</span><span id=__span-0-1158><a id=__codelineno-0-1158 name=__codelineno-0-1158></a><span class=sd>    disable the transforms, simply pass an empty list.</span>
</span><span id=__span-0-1159><a id=__codelineno-0-1159 name=__codelineno-0-1159></a>
</span><span id=__span-0-1160><a id=__codelineno-0-1160 name=__codelineno-0-1160></a><span class=sd>    The `roi_size` parameter specifies the size of the area around each pixel that will</span>
</span><span id=__span-0-1161><a id=__codelineno-0-1161 name=__codelineno-0-1161></a><span class=sd>    be manipulated by N2V. The `masked_pixel_percentage` parameter specifies how many</span>
</span><span id=__span-0-1162><a id=__codelineno-0-1162 name=__codelineno-0-1162></a><span class=sd>    pixels per patch will be manipulated.</span>
</span><span id=__span-0-1163><a id=__codelineno-0-1163 name=__codelineno-0-1163></a>
</span><span id=__span-0-1164><a id=__codelineno-0-1164 name=__codelineno-0-1164></a><span class=sd>    The parameters of the UNet can be specified in the `model_params` (passed as a</span>
</span><span id=__span-0-1165><a id=__codelineno-0-1165 name=__codelineno-0-1165></a><span class=sd>    parameter-value dictionary). Note that `use_n2v2` and &#39;n_channels&#39; override the</span>
</span><span id=__span-0-1166><a id=__codelineno-0-1166 name=__codelineno-0-1166></a><span class=sd>    corresponding parameters passed in `model_params`.</span>
</span><span id=__span-0-1167><a id=__codelineno-0-1167 name=__codelineno-0-1167></a>
</span><span id=__span-0-1168><a id=__codelineno-0-1168 name=__codelineno-0-1168></a><span class=sd>    If you pass &quot;horizontal&quot; or &quot;vertical&quot; to `struct_n2v_axis`, then structN2V mask</span>
</span><span id=__span-0-1169><a id=__codelineno-0-1169 name=__codelineno-0-1169></a><span class=sd>    will be applied to each manipulated pixel.</span>
</span><span id=__span-0-1170><a id=__codelineno-0-1170 name=__codelineno-0-1170></a>
</span><span id=__span-0-1171><a id=__codelineno-0-1171 name=__codelineno-0-1171></a><span class=sd>    Parameters</span>
</span><span id=__span-0-1172><a id=__codelineno-0-1172 name=__codelineno-0-1172></a><span class=sd>    ----------</span>
</span><span id=__span-0-1173><a id=__codelineno-0-1173 name=__codelineno-0-1173></a><span class=sd>    experiment_name : str</span>
</span><span id=__span-0-1174><a id=__codelineno-0-1174 name=__codelineno-0-1174></a><span class=sd>        Name of the experiment.</span>
</span><span id=__span-0-1175><a id=__codelineno-0-1175 name=__codelineno-0-1175></a><span class=sd>    data_type : Literal[&quot;array&quot;, &quot;tiff&quot;, &quot;czi&quot;, &quot;custom&quot;]</span>
</span><span id=__span-0-1176><a id=__codelineno-0-1176 name=__codelineno-0-1176></a><span class=sd>        Type of the data.</span>
</span><span id=__span-0-1177><a id=__codelineno-0-1177 name=__codelineno-0-1177></a><span class=sd>    axes : str</span>
</span><span id=__span-0-1178><a id=__codelineno-0-1178 name=__codelineno-0-1178></a><span class=sd>        Axes of the data (e.g. SYX).</span>
</span><span id=__span-0-1179><a id=__codelineno-0-1179 name=__codelineno-0-1179></a><span class=sd>    patch_size : List[int]</span>
</span><span id=__span-0-1180><a id=__codelineno-0-1180 name=__codelineno-0-1180></a><span class=sd>        Size of the patches along the spatial dimensions (e.g. [64, 64]).</span>
</span><span id=__span-0-1181><a id=__codelineno-0-1181 name=__codelineno-0-1181></a><span class=sd>    batch_size : int</span>
</span><span id=__span-0-1182><a id=__codelineno-0-1182 name=__codelineno-0-1182></a><span class=sd>        Batch size.</span>
</span><span id=__span-0-1183><a id=__codelineno-0-1183 name=__codelineno-0-1183></a><span class=sd>    num_epochs : int, default=100</span>
</span><span id=__span-0-1184><a id=__codelineno-0-1184 name=__codelineno-0-1184></a><span class=sd>        Number of epochs to train for. If provided, this will be added to</span>
</span><span id=__span-0-1185><a id=__codelineno-0-1185 name=__codelineno-0-1185></a><span class=sd>        trainer_params.</span>
</span><span id=__span-0-1186><a id=__codelineno-0-1186 name=__codelineno-0-1186></a><span class=sd>    num_steps : int, optional</span>
</span><span id=__span-0-1187><a id=__codelineno-0-1187 name=__codelineno-0-1187></a><span class=sd>        Number of batches in 1 epoch. If provided, this will be added to trainer_params.</span>
</span><span id=__span-0-1188><a id=__codelineno-0-1188 name=__codelineno-0-1188></a><span class=sd>        Translates to `limit_train_batches` in PyTorch Lightning Trainer. See relevant</span>
</span><span id=__span-0-1189><a id=__codelineno-0-1189 name=__codelineno-0-1189></a><span class=sd>        documentation for more details.</span>
</span><span id=__span-0-1190><a id=__codelineno-0-1190 name=__codelineno-0-1190></a><span class=sd>    augmentations : list of transforms, default=None</span>
</span><span id=__span-0-1191><a id=__codelineno-0-1191 name=__codelineno-0-1191></a><span class=sd>        List of transforms to apply, either both or one of XYFlipModel and</span>
</span><span id=__span-0-1192><a id=__codelineno-0-1192 name=__codelineno-0-1192></a><span class=sd>        XYRandomRotate90Model. By default, it applies both XYFlip (on X and Y)</span>
</span><span id=__span-0-1193><a id=__codelineno-0-1193 name=__codelineno-0-1193></a><span class=sd>        and XYRandomRotate90 (in XY) to the images.</span>
</span><span id=__span-0-1194><a id=__codelineno-0-1194 name=__codelineno-0-1194></a><span class=sd>    independent_channels : bool, optional</span>
</span><span id=__span-0-1195><a id=__codelineno-0-1195 name=__codelineno-0-1195></a><span class=sd>        Whether to train all channels together, by default True.</span>
</span><span id=__span-0-1196><a id=__codelineno-0-1196 name=__codelineno-0-1196></a><span class=sd>    use_n2v2 : bool, optional</span>
</span><span id=__span-0-1197><a id=__codelineno-0-1197 name=__codelineno-0-1197></a><span class=sd>        Whether to use N2V2, by default False.</span>
</span><span id=__span-0-1198><a id=__codelineno-0-1198 name=__codelineno-0-1198></a><span class=sd>    n_channels : int or None, default=None</span>
</span><span id=__span-0-1199><a id=__codelineno-0-1199 name=__codelineno-0-1199></a><span class=sd>        Number of channels (in and out).</span>
</span><span id=__span-0-1200><a id=__codelineno-0-1200 name=__codelineno-0-1200></a><span class=sd>    roi_size : int, optional</span>
</span><span id=__span-0-1201><a id=__codelineno-0-1201 name=__codelineno-0-1201></a><span class=sd>        N2V pixel manipulation area, by default 11.</span>
</span><span id=__span-0-1202><a id=__codelineno-0-1202 name=__codelineno-0-1202></a><span class=sd>    masked_pixel_percentage : float, optional</span>
</span><span id=__span-0-1203><a id=__codelineno-0-1203 name=__codelineno-0-1203></a><span class=sd>        Percentage of pixels masked in each patch, by default 0.2.</span>
</span><span id=__span-0-1204><a id=__codelineno-0-1204 name=__codelineno-0-1204></a><span class=sd>    struct_n2v_axis : Literal[&quot;horizontal&quot;, &quot;vertical&quot;, &quot;none&quot;], optional</span>
</span><span id=__span-0-1205><a id=__codelineno-0-1205 name=__codelineno-0-1205></a><span class=sd>        Axis along which to apply structN2V mask, by default &quot;none&quot;.</span>
</span><span id=__span-0-1206><a id=__codelineno-0-1206 name=__codelineno-0-1206></a><span class=sd>    struct_n2v_span : int, optional</span>
</span><span id=__span-0-1207><a id=__codelineno-0-1207 name=__codelineno-0-1207></a><span class=sd>        Span of the structN2V mask, by default 5.</span>
</span><span id=__span-0-1208><a id=__codelineno-0-1208 name=__codelineno-0-1208></a><span class=sd>    trainer_params : dict, optional</span>
</span><span id=__span-0-1209><a id=__codelineno-0-1209 name=__codelineno-0-1209></a><span class=sd>        Parameters for the trainer, see the relevant documentation.</span>
</span><span id=__span-0-1210><a id=__codelineno-0-1210 name=__codelineno-0-1210></a><span class=sd>    logger : Literal[&quot;wandb&quot;, &quot;tensorboard&quot;, &quot;none&quot;], optional</span>
</span><span id=__span-0-1211><a id=__codelineno-0-1211 name=__codelineno-0-1211></a><span class=sd>        Logger to use, by default &quot;none&quot;.</span>
</span><span id=__span-0-1212><a id=__codelineno-0-1212 name=__codelineno-0-1212></a><span class=sd>    model_params : dict, default=None</span>
</span><span id=__span-0-1213><a id=__codelineno-0-1213 name=__codelineno-0-1213></a><span class=sd>        UNetModel parameters.</span>
</span><span id=__span-0-1214><a id=__codelineno-0-1214 name=__codelineno-0-1214></a><span class=sd>    optimizer : Literal[&quot;Adam&quot;, &quot;Adamax&quot;, &quot;SGD&quot;], default=&quot;Adam&quot;</span>
</span><span id=__span-0-1215><a id=__codelineno-0-1215 name=__codelineno-0-1215></a><span class=sd>        Optimizer to use.</span>
</span><span id=__span-0-1216><a id=__codelineno-0-1216 name=__codelineno-0-1216></a><span class=sd>    optimizer_params : dict, default=None</span>
</span><span id=__span-0-1217><a id=__codelineno-0-1217 name=__codelineno-0-1217></a><span class=sd>        Parameters for the optimizer, see PyTorch documentation for more details.</span>
</span><span id=__span-0-1218><a id=__codelineno-0-1218 name=__codelineno-0-1218></a><span class=sd>    lr_scheduler : Literal[&quot;ReduceLROnPlateau&quot;, &quot;StepLR&quot;], default=&quot;ReduceLROnPlateau&quot;</span>
</span><span id=__span-0-1219><a id=__codelineno-0-1219 name=__codelineno-0-1219></a><span class=sd>        Learning rate scheduler to use.</span>
</span><span id=__span-0-1220><a id=__codelineno-0-1220 name=__codelineno-0-1220></a><span class=sd>    lr_scheduler_params : dict, default=None</span>
</span><span id=__span-0-1221><a id=__codelineno-0-1221 name=__codelineno-0-1221></a><span class=sd>        Parameters for the learning rate scheduler, see PyTorch documentation for more</span>
</span><span id=__span-0-1222><a id=__codelineno-0-1222 name=__codelineno-0-1222></a><span class=sd>        details.</span>
</span><span id=__span-0-1223><a id=__codelineno-0-1223 name=__codelineno-0-1223></a><span class=sd>    train_dataloader_params : dict, optional</span>
</span><span id=__span-0-1224><a id=__codelineno-0-1224 name=__codelineno-0-1224></a><span class=sd>        Parameters for the training dataloader, see the PyTorch docs for `DataLoader`.</span>
</span><span id=__span-0-1225><a id=__codelineno-0-1225 name=__codelineno-0-1225></a><span class=sd>        If left as `None`, the dict `{&quot;shuffle&quot;: True}` will be used, this is set in</span>
</span><span id=__span-0-1226><a id=__codelineno-0-1226 name=__codelineno-0-1226></a><span class=sd>        the `GeneralDataConfig`.</span>
</span><span id=__span-0-1227><a id=__codelineno-0-1227 name=__codelineno-0-1227></a><span class=sd>    val_dataloader_params : dict, optional</span>
</span><span id=__span-0-1228><a id=__codelineno-0-1228 name=__codelineno-0-1228></a><span class=sd>        Parameters for the validation dataloader, see PyTorch the docs for `DataLoader`.</span>
</span><span id=__span-0-1229><a id=__codelineno-0-1229 name=__codelineno-0-1229></a><span class=sd>        If left as `None`, the empty dict `{}` will be used, this is set in the</span>
</span><span id=__span-0-1230><a id=__codelineno-0-1230 name=__codelineno-0-1230></a><span class=sd>        `GeneralDataConfig`.</span>
</span><span id=__span-0-1231><a id=__codelineno-0-1231 name=__codelineno-0-1231></a><span class=sd>    checkpoint_params : dict, default=None</span>
</span><span id=__span-0-1232><a id=__codelineno-0-1232 name=__codelineno-0-1232></a><span class=sd>        Parameters for the checkpoint callback, see PyTorch Lightning documentation</span>
</span><span id=__span-0-1233><a id=__codelineno-0-1233 name=__codelineno-0-1233></a><span class=sd>        (`ModelCheckpoint`) for the list of available parameters.</span>
</span><span id=__span-0-1234><a id=__codelineno-0-1234 name=__codelineno-0-1234></a>
</span><span id=__span-0-1235><a id=__codelineno-0-1235 name=__codelineno-0-1235></a><span class=sd>    Returns</span>
</span><span id=__span-0-1236><a id=__codelineno-0-1236 name=__codelineno-0-1236></a><span class=sd>    -------</span>
</span><span id=__span-0-1237><a id=__codelineno-0-1237 name=__codelineno-0-1237></a><span class=sd>    Configuration</span>
</span><span id=__span-0-1238><a id=__codelineno-0-1238 name=__codelineno-0-1238></a><span class=sd>        Configuration for training N2V.</span>
</span><span id=__span-0-1239><a id=__codelineno-0-1239 name=__codelineno-0-1239></a>
</span><span id=__span-0-1240><a id=__codelineno-0-1240 name=__codelineno-0-1240></a><span class=sd>    Examples</span>
</span><span id=__span-0-1241><a id=__codelineno-0-1241 name=__codelineno-0-1241></a><span class=sd>    --------</span>
</span><span id=__span-0-1242><a id=__codelineno-0-1242 name=__codelineno-0-1242></a><span class=sd>    Minimum example:</span>
</span><span id=__span-0-1243><a id=__codelineno-0-1243 name=__codelineno-0-1243></a><span class=sd>    &gt;&gt;&gt; config = create_n2v_configuration(</span>
</span><span id=__span-0-1244><a id=__codelineno-0-1244 name=__codelineno-0-1244></a><span class=sd>    ...     experiment_name=&quot;n2v_experiment&quot;,</span>
</span><span id=__span-0-1245><a id=__codelineno-0-1245 name=__codelineno-0-1245></a><span class=sd>    ...     data_type=&quot;array&quot;,</span>
</span><span id=__span-0-1246><a id=__codelineno-0-1246 name=__codelineno-0-1246></a><span class=sd>    ...     axes=&quot;YX&quot;,</span>
</span><span id=__span-0-1247><a id=__codelineno-0-1247 name=__codelineno-0-1247></a><span class=sd>    ...     patch_size=[64, 64],</span>
</span><span id=__span-0-1248><a id=__codelineno-0-1248 name=__codelineno-0-1248></a><span class=sd>    ...     batch_size=32,</span>
</span><span id=__span-0-1249><a id=__codelineno-0-1249 name=__codelineno-0-1249></a><span class=sd>    ...     num_epochs=100</span>
</span><span id=__span-0-1250><a id=__codelineno-0-1250 name=__codelineno-0-1250></a><span class=sd>    ... )</span>
</span><span id=__span-0-1251><a id=__codelineno-0-1251 name=__codelineno-0-1251></a>
</span><span id=__span-0-1252><a id=__codelineno-0-1252 name=__codelineno-0-1252></a><span class=sd>    You can also limit the number of batches per epoch:</span>
</span><span id=__span-0-1253><a id=__codelineno-0-1253 name=__codelineno-0-1253></a><span class=sd>    &gt;&gt;&gt; config = create_n2v_configuration(</span>
</span><span id=__span-0-1254><a id=__codelineno-0-1254 name=__codelineno-0-1254></a><span class=sd>    ...     experiment_name=&quot;n2v_experiment&quot;,</span>
</span><span id=__span-0-1255><a id=__codelineno-0-1255 name=__codelineno-0-1255></a><span class=sd>    ...     data_type=&quot;array&quot;,</span>
</span><span id=__span-0-1256><a id=__codelineno-0-1256 name=__codelineno-0-1256></a><span class=sd>    ...     axes=&quot;YX&quot;,</span>
</span><span id=__span-0-1257><a id=__codelineno-0-1257 name=__codelineno-0-1257></a><span class=sd>    ...     patch_size=[64, 64],</span>
</span><span id=__span-0-1258><a id=__codelineno-0-1258 name=__codelineno-0-1258></a><span class=sd>    ...     batch_size=32,</span>
</span><span id=__span-0-1259><a id=__codelineno-0-1259 name=__codelineno-0-1259></a><span class=sd>    ...     num_steps=100  # limit to 100 batches per epoch</span>
</span><span id=__span-0-1260><a id=__codelineno-0-1260 name=__codelineno-0-1260></a><span class=sd>    ... )</span>
</span><span id=__span-0-1261><a id=__codelineno-0-1261 name=__codelineno-0-1261></a>
</span><span id=__span-0-1262><a id=__codelineno-0-1262 name=__codelineno-0-1262></a><span class=sd>    To disable transforms, simply set `augmentations` to an empty list:</span>
</span><span id=__span-0-1263><a id=__codelineno-0-1263 name=__codelineno-0-1263></a><span class=sd>    &gt;&gt;&gt; config = create_n2v_configuration(</span>
</span><span id=__span-0-1264><a id=__codelineno-0-1264 name=__codelineno-0-1264></a><span class=sd>    ...     experiment_name=&quot;n2v_experiment&quot;,</span>
</span><span id=__span-0-1265><a id=__codelineno-0-1265 name=__codelineno-0-1265></a><span class=sd>    ...     data_type=&quot;array&quot;,</span>
</span><span id=__span-0-1266><a id=__codelineno-0-1266 name=__codelineno-0-1266></a><span class=sd>    ...     axes=&quot;YX&quot;,</span>
</span><span id=__span-0-1267><a id=__codelineno-0-1267 name=__codelineno-0-1267></a><span class=sd>    ...     patch_size=[64, 64],</span>
</span><span id=__span-0-1268><a id=__codelineno-0-1268 name=__codelineno-0-1268></a><span class=sd>    ...     batch_size=32,</span>
</span><span id=__span-0-1269><a id=__codelineno-0-1269 name=__codelineno-0-1269></a><span class=sd>    ...     num_epochs=100,</span>
</span><span id=__span-0-1270><a id=__codelineno-0-1270 name=__codelineno-0-1270></a><span class=sd>    ...     augmentations=[]</span>
</span><span id=__span-0-1271><a id=__codelineno-0-1271 name=__codelineno-0-1271></a><span class=sd>    ... )</span>
</span><span id=__span-0-1272><a id=__codelineno-0-1272 name=__codelineno-0-1272></a>
</span><span id=__span-0-1273><a id=__codelineno-0-1273 name=__codelineno-0-1273></a><span class=sd>    A list of transforms can be passed to the `augmentations` parameter:</span>
</span><span id=__span-0-1274><a id=__codelineno-0-1274 name=__codelineno-0-1274></a><span class=sd>    &gt;&gt;&gt; from careamics.config.transformations import XYFlipModel</span>
</span><span id=__span-0-1275><a id=__codelineno-0-1275 name=__codelineno-0-1275></a><span class=sd>    &gt;&gt;&gt; config = create_n2v_configuration(</span>
</span><span id=__span-0-1276><a id=__codelineno-0-1276 name=__codelineno-0-1276></a><span class=sd>    ...     experiment_name=&quot;n2v_experiment&quot;,</span>
</span><span id=__span-0-1277><a id=__codelineno-0-1277 name=__codelineno-0-1277></a><span class=sd>    ...     data_type=&quot;array&quot;,</span>
</span><span id=__span-0-1278><a id=__codelineno-0-1278 name=__codelineno-0-1278></a><span class=sd>    ...     axes=&quot;YX&quot;,</span>
</span><span id=__span-0-1279><a id=__codelineno-0-1279 name=__codelineno-0-1279></a><span class=sd>    ...     patch_size=[64, 64],</span>
</span><span id=__span-0-1280><a id=__codelineno-0-1280 name=__codelineno-0-1280></a><span class=sd>    ...     batch_size=32,</span>
</span><span id=__span-0-1281><a id=__codelineno-0-1281 name=__codelineno-0-1281></a><span class=sd>    ...     num_epochs=100,</span>
</span><span id=__span-0-1282><a id=__codelineno-0-1282 name=__codelineno-0-1282></a><span class=sd>    ...     augmentations=[</span>
</span><span id=__span-0-1283><a id=__codelineno-0-1283 name=__codelineno-0-1283></a><span class=sd>    ...         # No rotation and only Y flipping</span>
</span><span id=__span-0-1284><a id=__codelineno-0-1284 name=__codelineno-0-1284></a><span class=sd>    ...         XYFlipModel(flip_x = False, flip_y = True)</span>
</span><span id=__span-0-1285><a id=__codelineno-0-1285 name=__codelineno-0-1285></a><span class=sd>    ...     ]</span>
</span><span id=__span-0-1286><a id=__codelineno-0-1286 name=__codelineno-0-1286></a><span class=sd>    ... )</span>
</span><span id=__span-0-1287><a id=__codelineno-0-1287 name=__codelineno-0-1287></a>
</span><span id=__span-0-1288><a id=__codelineno-0-1288 name=__codelineno-0-1288></a><span class=sd>    To use N2V2, simply pass the `use_n2v2` parameter:</span>
</span><span id=__span-0-1289><a id=__codelineno-0-1289 name=__codelineno-0-1289></a><span class=sd>    &gt;&gt;&gt; config = create_n2v_configuration(</span>
</span><span id=__span-0-1290><a id=__codelineno-0-1290 name=__codelineno-0-1290></a><span class=sd>    ...     experiment_name=&quot;n2v2_experiment&quot;,</span>
</span><span id=__span-0-1291><a id=__codelineno-0-1291 name=__codelineno-0-1291></a><span class=sd>    ...     data_type=&quot;tiff&quot;,</span>
</span><span id=__span-0-1292><a id=__codelineno-0-1292 name=__codelineno-0-1292></a><span class=sd>    ...     axes=&quot;YX&quot;,</span>
</span><span id=__span-0-1293><a id=__codelineno-0-1293 name=__codelineno-0-1293></a><span class=sd>    ...     patch_size=[64, 64],</span>
</span><span id=__span-0-1294><a id=__codelineno-0-1294 name=__codelineno-0-1294></a><span class=sd>    ...     batch_size=32,</span>
</span><span id=__span-0-1295><a id=__codelineno-0-1295 name=__codelineno-0-1295></a><span class=sd>    ...     num_epochs=100,</span>
</span><span id=__span-0-1296><a id=__codelineno-0-1296 name=__codelineno-0-1296></a><span class=sd>    ...     use_n2v2=True</span>
</span><span id=__span-0-1297><a id=__codelineno-0-1297 name=__codelineno-0-1297></a><span class=sd>    ... )</span>
</span><span id=__span-0-1298><a id=__codelineno-0-1298 name=__codelineno-0-1298></a>
</span><span id=__span-0-1299><a id=__codelineno-0-1299 name=__codelineno-0-1299></a><span class=sd>    For structN2V, there are two parameters to set, `struct_n2v_axis` and</span>
</span><span id=__span-0-1300><a id=__codelineno-0-1300 name=__codelineno-0-1300></a><span class=sd>    `struct_n2v_span`:</span>
</span><span id=__span-0-1301><a id=__codelineno-0-1301 name=__codelineno-0-1301></a><span class=sd>    &gt;&gt;&gt; config = create_n2v_configuration(</span>
</span><span id=__span-0-1302><a id=__codelineno-0-1302 name=__codelineno-0-1302></a><span class=sd>    ...     experiment_name=&quot;structn2v_experiment&quot;,</span>
</span><span id=__span-0-1303><a id=__codelineno-0-1303 name=__codelineno-0-1303></a><span class=sd>    ...     data_type=&quot;tiff&quot;,</span>
</span><span id=__span-0-1304><a id=__codelineno-0-1304 name=__codelineno-0-1304></a><span class=sd>    ...     axes=&quot;YX&quot;,</span>
</span><span id=__span-0-1305><a id=__codelineno-0-1305 name=__codelineno-0-1305></a><span class=sd>    ...     patch_size=[64, 64],</span>
</span><span id=__span-0-1306><a id=__codelineno-0-1306 name=__codelineno-0-1306></a><span class=sd>    ...     batch_size=32,</span>
</span><span id=__span-0-1307><a id=__codelineno-0-1307 name=__codelineno-0-1307></a><span class=sd>    ...     num_epochs=100,</span>
</span><span id=__span-0-1308><a id=__codelineno-0-1308 name=__codelineno-0-1308></a><span class=sd>    ...     struct_n2v_axis=&quot;horizontal&quot;,</span>
</span><span id=__span-0-1309><a id=__codelineno-0-1309 name=__codelineno-0-1309></a><span class=sd>    ...     struct_n2v_span=7</span>
</span><span id=__span-0-1310><a id=__codelineno-0-1310 name=__codelineno-0-1310></a><span class=sd>    ... )</span>
</span><span id=__span-0-1311><a id=__codelineno-0-1311 name=__codelineno-0-1311></a>
</span><span id=__span-0-1312><a id=__codelineno-0-1312 name=__codelineno-0-1312></a><span class=sd>    If you are training multiple channels they will be trained independently by default,</span>
</span><span id=__span-0-1313><a id=__codelineno-0-1313 name=__codelineno-0-1313></a><span class=sd>    you simply need to specify the number of channels:</span>
</span><span id=__span-0-1314><a id=__codelineno-0-1314 name=__codelineno-0-1314></a><span class=sd>    &gt;&gt;&gt; config = create_n2v_configuration(</span>
</span><span id=__span-0-1315><a id=__codelineno-0-1315 name=__codelineno-0-1315></a><span class=sd>    ...     experiment_name=&quot;n2v_experiment&quot;,</span>
</span><span id=__span-0-1316><a id=__codelineno-0-1316 name=__codelineno-0-1316></a><span class=sd>    ...     data_type=&quot;array&quot;,</span>
</span><span id=__span-0-1317><a id=__codelineno-0-1317 name=__codelineno-0-1317></a><span class=sd>    ...     axes=&quot;YXC&quot;,</span>
</span><span id=__span-0-1318><a id=__codelineno-0-1318 name=__codelineno-0-1318></a><span class=sd>    ...     patch_size=[64, 64],</span>
</span><span id=__span-0-1319><a id=__codelineno-0-1319 name=__codelineno-0-1319></a><span class=sd>    ...     batch_size=32,</span>
</span><span id=__span-0-1320><a id=__codelineno-0-1320 name=__codelineno-0-1320></a><span class=sd>    ...     num_epochs=100,</span>
</span><span id=__span-0-1321><a id=__codelineno-0-1321 name=__codelineno-0-1321></a><span class=sd>    ...     n_channels=3</span>
</span><span id=__span-0-1322><a id=__codelineno-0-1322 name=__codelineno-0-1322></a><span class=sd>    ... )</span>
</span><span id=__span-0-1323><a id=__codelineno-0-1323 name=__codelineno-0-1323></a>
</span><span id=__span-0-1324><a id=__codelineno-0-1324 name=__codelineno-0-1324></a><span class=sd>    If instead you want to train multiple channels together, you need to turn off the</span>
</span><span id=__span-0-1325><a id=__codelineno-0-1325 name=__codelineno-0-1325></a><span class=sd>    `independent_channels` parameter:</span>
</span><span id=__span-0-1326><a id=__codelineno-0-1326 name=__codelineno-0-1326></a><span class=sd>    &gt;&gt;&gt; config = create_n2v_configuration(</span>
</span><span id=__span-0-1327><a id=__codelineno-0-1327 name=__codelineno-0-1327></a><span class=sd>    ...     experiment_name=&quot;n2v_experiment&quot;,</span>
</span><span id=__span-0-1328><a id=__codelineno-0-1328 name=__codelineno-0-1328></a><span class=sd>    ...     data_type=&quot;array&quot;,</span>
</span><span id=__span-0-1329><a id=__codelineno-0-1329 name=__codelineno-0-1329></a><span class=sd>    ...     axes=&quot;YXC&quot;,</span>
</span><span id=__span-0-1330><a id=__codelineno-0-1330 name=__codelineno-0-1330></a><span class=sd>    ...     patch_size=[64, 64],</span>
</span><span id=__span-0-1331><a id=__codelineno-0-1331 name=__codelineno-0-1331></a><span class=sd>    ...     batch_size=32,</span>
</span><span id=__span-0-1332><a id=__codelineno-0-1332 name=__codelineno-0-1332></a><span class=sd>    ...     num_epochs=100,</span>
</span><span id=__span-0-1333><a id=__codelineno-0-1333 name=__codelineno-0-1333></a><span class=sd>    ...     independent_channels=False,</span>
</span><span id=__span-0-1334><a id=__codelineno-0-1334 name=__codelineno-0-1334></a><span class=sd>    ...     n_channels=3</span>
</span><span id=__span-0-1335><a id=__codelineno-0-1335 name=__codelineno-0-1335></a><span class=sd>    ... )</span>
</span><span id=__span-0-1336><a id=__codelineno-0-1336 name=__codelineno-0-1336></a>
</span><span id=__span-0-1337><a id=__codelineno-0-1337 name=__codelineno-0-1337></a><span class=sd>    If you would like to train on CZI files, use `&quot;czi&quot;` as `data_type` and `&quot;SCYX&quot;` as</span>
</span><span id=__span-0-1338><a id=__codelineno-0-1338 name=__codelineno-0-1338></a><span class=sd>    `axes` for 2-D or `&quot;SCZYX&quot;` for 3-D denoising. Note that `&quot;SCYX&quot;` can also be used</span>
</span><span id=__span-0-1339><a id=__codelineno-0-1339 name=__codelineno-0-1339></a><span class=sd>    for 3-D data but spatial context along the Z dimension will then not be taken into</span>
</span><span id=__span-0-1340><a id=__codelineno-0-1340 name=__codelineno-0-1340></a><span class=sd>    account.</span>
</span><span id=__span-0-1341><a id=__codelineno-0-1341 name=__codelineno-0-1341></a><span class=sd>    &gt;&gt;&gt; config_2d = create_n2v_configuration(</span>
</span><span id=__span-0-1342><a id=__codelineno-0-1342 name=__codelineno-0-1342></a><span class=sd>    ...     experiment_name=&quot;n2v_experiment&quot;,</span>
</span><span id=__span-0-1343><a id=__codelineno-0-1343 name=__codelineno-0-1343></a><span class=sd>    ...     data_type=&quot;czi&quot;,</span>
</span><span id=__span-0-1344><a id=__codelineno-0-1344 name=__codelineno-0-1344></a><span class=sd>    ...     axes=&quot;SCYX&quot;,</span>
</span><span id=__span-0-1345><a id=__codelineno-0-1345 name=__codelineno-0-1345></a><span class=sd>    ...     patch_size=[64, 64],</span>
</span><span id=__span-0-1346><a id=__codelineno-0-1346 name=__codelineno-0-1346></a><span class=sd>    ...     batch_size=32,</span>
</span><span id=__span-0-1347><a id=__codelineno-0-1347 name=__codelineno-0-1347></a><span class=sd>    ...     num_epochs=100,</span>
</span><span id=__span-0-1348><a id=__codelineno-0-1348 name=__codelineno-0-1348></a><span class=sd>    ...     n_channels=1,</span>
</span><span id=__span-0-1349><a id=__codelineno-0-1349 name=__codelineno-0-1349></a><span class=sd>    ... )</span>
</span><span id=__span-0-1350><a id=__codelineno-0-1350 name=__codelineno-0-1350></a><span class=sd>    &gt;&gt;&gt; config_3d = create_n2v_configuration(</span>
</span><span id=__span-0-1351><a id=__codelineno-0-1351 name=__codelineno-0-1351></a><span class=sd>    ...     experiment_name=&quot;n2v_experiment&quot;,</span>
</span><span id=__span-0-1352><a id=__codelineno-0-1352 name=__codelineno-0-1352></a><span class=sd>    ...     data_type=&quot;czi&quot;,</span>
</span><span id=__span-0-1353><a id=__codelineno-0-1353 name=__codelineno-0-1353></a><span class=sd>    ...     axes=&quot;SCZYX&quot;,</span>
</span><span id=__span-0-1354><a id=__codelineno-0-1354 name=__codelineno-0-1354></a><span class=sd>    ...     patch_size=[16, 64, 64],</span>
</span><span id=__span-0-1355><a id=__codelineno-0-1355 name=__codelineno-0-1355></a><span class=sd>    ...     batch_size=16,</span>
</span><span id=__span-0-1356><a id=__codelineno-0-1356 name=__codelineno-0-1356></a><span class=sd>    ...     num_epochs=100,</span>
</span><span id=__span-0-1357><a id=__codelineno-0-1357 name=__codelineno-0-1357></a><span class=sd>    ...     n_channels=1,</span>
</span><span id=__span-0-1358><a id=__codelineno-0-1358 name=__codelineno-0-1358></a><span class=sd>    ... )</span>
</span><span id=__span-0-1359><a id=__codelineno-0-1359 name=__codelineno-0-1359></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-1360><a id=__codelineno-0-1360 name=__codelineno-0-1360></a>    <span class=c1># if there are channels, we need to specify their number</span>
</span><span id=__span-0-1361><a id=__codelineno-0-1361 name=__codelineno-0-1361></a>    <span class=k>if</span> <span class=s2>&quot;C&quot;</span> <span class=ow>in</span> <span class=n>axes</span> <span class=ow>and</span> <span class=n>n_channels</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-1362><a id=__codelineno-0-1362 name=__codelineno-0-1362></a>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&quot;Number of channels must be specified when using channels.&quot;</span><span class=p>)</span>
</span><span id=__span-0-1363><a id=__codelineno-0-1363 name=__codelineno-0-1363></a>    <span class=k>elif</span> <span class=s2>&quot;C&quot;</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>axes</span> <span class=ow>and</span> <span class=p>(</span><span class=n>n_channels</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span> <span class=ow>and</span> <span class=n>n_channels</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=p>):</span>
</span><span id=__span-0-1364><a id=__codelineno-0-1364 name=__codelineno-0-1364></a>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-1365><a id=__codelineno-0-1365 name=__codelineno-0-1365></a>            <span class=sa>f</span><span class=s2>&quot;C is not present in the axes, but number of channels is specified &quot;</span>
</span><span id=__span-0-1366><a id=__codelineno-0-1366 name=__codelineno-0-1366></a>            <span class=sa>f</span><span class=s2>&quot;(got </span><span class=si>{</span><span class=n>n_channels</span><span class=si>}</span><span class=s2> channel).&quot;</span>
</span><span id=__span-0-1367><a id=__codelineno-0-1367 name=__codelineno-0-1367></a>        <span class=p>)</span>
</span><span id=__span-0-1368><a id=__codelineno-0-1368 name=__codelineno-0-1368></a>
</span><span id=__span-0-1369><a id=__codelineno-0-1369 name=__codelineno-0-1369></a>    <span class=k>if</span> <span class=n>n_channels</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-1370><a id=__codelineno-0-1370 name=__codelineno-0-1370></a>        <span class=n>n_channels</span> <span class=o>=</span> <span class=mi>1</span>
</span><span id=__span-0-1371><a id=__codelineno-0-1371 name=__codelineno-0-1371></a>
</span><span id=__span-0-1372><a id=__codelineno-0-1372 name=__codelineno-0-1372></a>    <span class=c1># augmentations</span>
</span><span id=__span-0-1373><a id=__codelineno-0-1373 name=__codelineno-0-1373></a>    <span class=n>spatial_transforms</span> <span class=o>=</span> <span class=n>_list_spatial_augmentations</span><span class=p>(</span><span class=n>augmentations</span><span class=p>)</span>
</span><span id=__span-0-1374><a id=__codelineno-0-1374 name=__codelineno-0-1374></a>
</span><span id=__span-0-1375><a id=__codelineno-0-1375 name=__codelineno-0-1375></a>    <span class=c1># create the N2VManipulate transform using the supplied parameters</span>
</span><span id=__span-0-1376><a id=__codelineno-0-1376 name=__codelineno-0-1376></a>    <span class=n>n2v_transform</span> <span class=o>=</span> <span class=n>N2VManipulateModel</span><span class=p>(</span>
</span><span id=__span-0-1377><a id=__codelineno-0-1377 name=__codelineno-0-1377></a>        <span class=n>name</span><span class=o>=</span><span class=n>SupportedTransform</span><span class=o>.</span><span class=n>N2V_MANIPULATE</span><span class=o>.</span><span class=n>value</span><span class=p>,</span>
</span><span id=__span-0-1378><a id=__codelineno-0-1378 name=__codelineno-0-1378></a>        <span class=n>strategy</span><span class=o>=</span><span class=p>(</span>
</span><span id=__span-0-1379><a id=__codelineno-0-1379 name=__codelineno-0-1379></a>            <span class=n>SupportedPixelManipulation</span><span class=o>.</span><span class=n>MEDIAN</span><span class=o>.</span><span class=n>value</span>
</span><span id=__span-0-1380><a id=__codelineno-0-1380 name=__codelineno-0-1380></a>            <span class=k>if</span> <span class=n>use_n2v2</span>
</span><span id=__span-0-1381><a id=__codelineno-0-1381 name=__codelineno-0-1381></a>            <span class=k>else</span> <span class=n>SupportedPixelManipulation</span><span class=o>.</span><span class=n>UNIFORM</span><span class=o>.</span><span class=n>value</span>
</span><span id=__span-0-1382><a id=__codelineno-0-1382 name=__codelineno-0-1382></a>        <span class=p>),</span>
</span><span id=__span-0-1383><a id=__codelineno-0-1383 name=__codelineno-0-1383></a>        <span class=n>roi_size</span><span class=o>=</span><span class=n>roi_size</span><span class=p>,</span>
</span><span id=__span-0-1384><a id=__codelineno-0-1384 name=__codelineno-0-1384></a>        <span class=n>masked_pixel_percentage</span><span class=o>=</span><span class=n>masked_pixel_percentage</span><span class=p>,</span>
</span><span id=__span-0-1385><a id=__codelineno-0-1385 name=__codelineno-0-1385></a>        <span class=n>struct_mask_axis</span><span class=o>=</span><span class=n>struct_n2v_axis</span><span class=p>,</span>
</span><span id=__span-0-1386><a id=__codelineno-0-1386 name=__codelineno-0-1386></a>        <span class=n>struct_mask_span</span><span class=o>=</span><span class=n>struct_n2v_span</span><span class=p>,</span>
</span><span id=__span-0-1387><a id=__codelineno-0-1387 name=__codelineno-0-1387></a>    <span class=p>)</span>
</span><span id=__span-0-1388><a id=__codelineno-0-1388 name=__codelineno-0-1388></a>
</span><span id=__span-0-1389><a id=__codelineno-0-1389 name=__codelineno-0-1389></a>    <span class=c1># algorithm</span>
</span><span id=__span-0-1390><a id=__codelineno-0-1390 name=__codelineno-0-1390></a>    <span class=n>algorithm_params</span> <span class=o>=</span> <span class=n>_create_algorithm_configuration</span><span class=p>(</span>
</span><span id=__span-0-1391><a id=__codelineno-0-1391 name=__codelineno-0-1391></a>        <span class=n>axes</span><span class=o>=</span><span class=n>axes</span><span class=p>,</span>
</span><span id=__span-0-1392><a id=__codelineno-0-1392 name=__codelineno-0-1392></a>        <span class=n>algorithm</span><span class=o>=</span><span class=s2>&quot;n2v&quot;</span><span class=p>,</span>
</span><span id=__span-0-1393><a id=__codelineno-0-1393 name=__codelineno-0-1393></a>        <span class=n>loss</span><span class=o>=</span><span class=s2>&quot;n2v&quot;</span><span class=p>,</span>
</span><span id=__span-0-1394><a id=__codelineno-0-1394 name=__codelineno-0-1394></a>        <span class=n>independent_channels</span><span class=o>=</span><span class=n>independent_channels</span><span class=p>,</span>
</span><span id=__span-0-1395><a id=__codelineno-0-1395 name=__codelineno-0-1395></a>        <span class=n>n_channels_in</span><span class=o>=</span><span class=n>n_channels</span><span class=p>,</span>
</span><span id=__span-0-1396><a id=__codelineno-0-1396 name=__codelineno-0-1396></a>        <span class=n>n_channels_out</span><span class=o>=</span><span class=n>n_channels</span><span class=p>,</span>
</span><span id=__span-0-1397><a id=__codelineno-0-1397 name=__codelineno-0-1397></a>        <span class=n>use_n2v2</span><span class=o>=</span><span class=n>use_n2v2</span><span class=p>,</span>
</span><span id=__span-0-1398><a id=__codelineno-0-1398 name=__codelineno-0-1398></a>        <span class=n>model_params</span><span class=o>=</span><span class=n>model_params</span><span class=p>,</span>
</span><span id=__span-0-1399><a id=__codelineno-0-1399 name=__codelineno-0-1399></a>        <span class=n>optimizer</span><span class=o>=</span><span class=n>optimizer</span><span class=p>,</span>
</span><span id=__span-0-1400><a id=__codelineno-0-1400 name=__codelineno-0-1400></a>        <span class=n>optimizer_params</span><span class=o>=</span><span class=n>optimizer_params</span><span class=p>,</span>
</span><span id=__span-0-1401><a id=__codelineno-0-1401 name=__codelineno-0-1401></a>        <span class=n>lr_scheduler</span><span class=o>=</span><span class=n>lr_scheduler</span><span class=p>,</span>
</span><span id=__span-0-1402><a id=__codelineno-0-1402 name=__codelineno-0-1402></a>        <span class=n>lr_scheduler_params</span><span class=o>=</span><span class=n>lr_scheduler_params</span><span class=p>,</span>
</span><span id=__span-0-1403><a id=__codelineno-0-1403 name=__codelineno-0-1403></a>    <span class=p>)</span>
</span><span id=__span-0-1404><a id=__codelineno-0-1404 name=__codelineno-0-1404></a>    <span class=n>algorithm_params</span><span class=p>[</span><span class=s2>&quot;n2v_config&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>n2v_transform</span>
</span><span id=__span-0-1405><a id=__codelineno-0-1405 name=__codelineno-0-1405></a>
</span><span id=__span-0-1406><a id=__codelineno-0-1406 name=__codelineno-0-1406></a>    <span class=c1># data</span>
</span><span id=__span-0-1407><a id=__codelineno-0-1407 name=__codelineno-0-1407></a>    <span class=n>data_params</span> <span class=o>=</span> <span class=n>_create_data_configuration</span><span class=p>(</span>
</span><span id=__span-0-1408><a id=__codelineno-0-1408 name=__codelineno-0-1408></a>        <span class=n>data_type</span><span class=o>=</span><span class=n>data_type</span><span class=p>,</span>
</span><span id=__span-0-1409><a id=__codelineno-0-1409 name=__codelineno-0-1409></a>        <span class=n>axes</span><span class=o>=</span><span class=n>axes</span><span class=p>,</span>
</span><span id=__span-0-1410><a id=__codelineno-0-1410 name=__codelineno-0-1410></a>        <span class=n>patch_size</span><span class=o>=</span><span class=n>patch_size</span><span class=p>,</span>
</span><span id=__span-0-1411><a id=__codelineno-0-1411 name=__codelineno-0-1411></a>        <span class=n>batch_size</span><span class=o>=</span><span class=n>batch_size</span><span class=p>,</span>
</span><span id=__span-0-1412><a id=__codelineno-0-1412 name=__codelineno-0-1412></a>        <span class=n>augmentations</span><span class=o>=</span><span class=n>spatial_transforms</span><span class=p>,</span>
</span><span id=__span-0-1413><a id=__codelineno-0-1413 name=__codelineno-0-1413></a>        <span class=n>train_dataloader_params</span><span class=o>=</span><span class=n>train_dataloader_params</span><span class=p>,</span>
</span><span id=__span-0-1414><a id=__codelineno-0-1414 name=__codelineno-0-1414></a>        <span class=n>val_dataloader_params</span><span class=o>=</span><span class=n>val_dataloader_params</span><span class=p>,</span>
</span><span id=__span-0-1415><a id=__codelineno-0-1415 name=__codelineno-0-1415></a>    <span class=p>)</span>
</span><span id=__span-0-1416><a id=__codelineno-0-1416 name=__codelineno-0-1416></a>
</span><span id=__span-0-1417><a id=__codelineno-0-1417 name=__codelineno-0-1417></a>    <span class=c1># training</span>
</span><span id=__span-0-1418><a id=__codelineno-0-1418 name=__codelineno-0-1418></a>    <span class=c1># Handle trainer parameters with num_epochs and nun_steps</span>
</span><span id=__span-0-1419><a id=__codelineno-0-1419 name=__codelineno-0-1419></a>    <span class=n>final_trainer_params</span> <span class=o>=</span> <span class=p>{}</span> <span class=k>if</span> <span class=n>trainer_params</span> <span class=ow>is</span> <span class=kc>None</span> <span class=k>else</span> <span class=n>trainer_params</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span><span id=__span-0-1420><a id=__codelineno-0-1420 name=__codelineno-0-1420></a>
</span><span id=__span-0-1421><a id=__codelineno-0-1421 name=__codelineno-0-1421></a>    <span class=c1># Add num_epochs and nun_steps if provided</span>
</span><span id=__span-0-1422><a id=__codelineno-0-1422 name=__codelineno-0-1422></a>    <span class=k>if</span> <span class=n>num_epochs</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-1423><a id=__codelineno-0-1423 name=__codelineno-0-1423></a>        <span class=n>final_trainer_params</span><span class=p>[</span><span class=s2>&quot;max_epochs&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>num_epochs</span>
</span><span id=__span-0-1424><a id=__codelineno-0-1424 name=__codelineno-0-1424></a>    <span class=k>if</span> <span class=n>num_steps</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-1425><a id=__codelineno-0-1425 name=__codelineno-0-1425></a>        <span class=n>final_trainer_params</span><span class=p>[</span><span class=s2>&quot;limit_train_batches&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>num_steps</span>
</span><span id=__span-0-1426><a id=__codelineno-0-1426 name=__codelineno-0-1426></a>
</span><span id=__span-0-1427><a id=__codelineno-0-1427 name=__codelineno-0-1427></a>    <span class=n>training_params</span> <span class=o>=</span> <span class=n>_create_training_configuration</span><span class=p>(</span>
</span><span id=__span-0-1428><a id=__codelineno-0-1428 name=__codelineno-0-1428></a>        <span class=n>trainer_params</span><span class=o>=</span><span class=n>final_trainer_params</span><span class=p>,</span>
</span><span id=__span-0-1429><a id=__codelineno-0-1429 name=__codelineno-0-1429></a>        <span class=n>logger</span><span class=o>=</span><span class=n>logger</span><span class=p>,</span>
</span><span id=__span-0-1430><a id=__codelineno-0-1430 name=__codelineno-0-1430></a>        <span class=n>checkpoint_params</span><span class=o>=</span><span class=n>checkpoint_params</span><span class=p>,</span>
</span><span id=__span-0-1431><a id=__codelineno-0-1431 name=__codelineno-0-1431></a>    <span class=p>)</span>
</span><span id=__span-0-1432><a id=__codelineno-0-1432 name=__codelineno-0-1432></a>
</span><span id=__span-0-1433><a id=__codelineno-0-1433 name=__codelineno-0-1433></a>    <span class=k>return</span> <span class=n>Configuration</span><span class=p>(</span>
</span><span id=__span-0-1434><a id=__codelineno-0-1434 name=__codelineno-0-1434></a>        <span class=n>experiment_name</span><span class=o>=</span><span class=n>experiment_name</span><span class=p>,</span>
</span><span id=__span-0-1435><a id=__codelineno-0-1435 name=__codelineno-0-1435></a>        <span class=n>algorithm_config</span><span class=o>=</span><span class=n>algorithm_params</span><span class=p>,</span>
</span><span id=__span-0-1436><a id=__codelineno-0-1436 name=__codelineno-0-1436></a>        <span class=n>data_config</span><span class=o>=</span><span class=n>data_params</span><span class=p>,</span>
</span><span id=__span-0-1437><a id=__codelineno-0-1437 name=__codelineno-0-1437></a>        <span class=n>training_config</span><span class=o>=</span><span class=n>training_params</span><span class=p>,</span>
</span><span id=__span-0-1438><a id=__codelineno-0-1438 name=__codelineno-0-1438></a>    <span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=careamics.config.configuration_factories.get_likelihood_config class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_likelihood_config</span><span class=p>(</span><span class=n>loss_type</span><span class=p>,</span> <span class=n>predict_logvar</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>logvar_lowerbound</span><span class=o>=-</span><span class=mf>5.0</span><span class=p>,</span> <span class=n>nm_paths</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>data_stats</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#careamics.config.configuration_factories.get_likelihood_config class=headerlink title="Permanent link">#</a></h2> <div class="doc doc-contents "> <p>Get the likelihood configuration for split models.</p> <p>Returns a tuple containing the following optional entries: - GaussianLikelihoodConfig: Gaussian likelihood configuration for musplit losses - MultiChannelNMConfig: Multi-channel noise model configuration for denoisplit losses - NMLikelihoodConfig: Noise model likelihood configuration for denoisplit losses</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>loss_type</code> </td> <td> <code><span title=typing.Literal>Literal</span>[&#39;musplit&#39;, &#39;denoisplit&#39;, &#39;denoisplit_musplit&#39;]</code> </td> <td> <div class=doc-md-description> <p>The type of loss function to use.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>predict_logvar</code> </td> <td> <code><span title=typing.Literal>Literal</span>[&#39;pixelwise&#39;] | None</code> </td> <td> <div class=doc-md-description> <p>Type of log variance prediction, by default None. Required when loss_type is "musplit" or "denoisplit_musplit".</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>logvar_lowerbound</code> </td> <td> <code><span title=float>float</span> | None</code> </td> <td> <div class=doc-md-description> <p>Lower bound for the log variance, by default -5.0. Used when loss_type is "musplit" or "denoisplit_musplit".</p> </div> </td> <td> <code>-5.0</code> </td> </tr> <tr class=doc-section-item> <td> <code>nm_paths</code> </td> <td> <code><span title=list>list</span>[<span title=str>str</span>] | None</code> </td> <td> <div class=doc-md-description> <p>Paths to the noise model files, by default None. Required when loss_type is "denoisplit" or "denoisplit_musplit".</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>data_stats</code> </td> <td> <code><span title=tuple>tuple</span>[<span title=float>float</span>, <span title=float>float</span>] | None</code> </td> <td> <div class=doc-md-description> <p>Data statistics (mean, std), by default None. Required when loss_type is "denoisplit" or "denoisplit_musplit".</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-internal" title="GaussianLikelihoodConfig (careamics.config.likelihood_model.GaussianLikelihoodConfig)" href=../likelihood_model/#careamics.config.likelihood_model.GaussianLikelihoodConfig>GaussianLikelihoodConfig</a> or None</code> </td> <td> <div class=doc-md-description> <p>Configuration for the Gaussian likelihood model.</p> </div> </td> </tr> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-internal" title="MultiChannelNMConfig (careamics.config.nm_model.MultiChannelNMConfig)" href=../nm_model/#careamics.config.nm_model.MultiChannelNMConfig>MultiChannelNMConfig</a> or None</code> </td> <td> <div class=doc-md-description> <p>Configuration for the multi-channel noise model.</p> </div> </td> </tr> <tr class=doc-section-item> <td> <code><a class="autorefs autorefs-internal" title="NMLikelihoodConfig (careamics.config.likelihood_model.NMLikelihoodConfig)" href=../likelihood_model/#careamics.config.likelihood_model.NMLikelihoodConfig>NMLikelihoodConfig</a> or None</code> </td> <td> <div class=doc-md-description> <p>Configuration for the noise model likelihood.</p> </div> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Raises:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=ValueError>ValueError</span></code> </td> <td> <div class=doc-md-description> <p>If required parameters are missing for the specified loss_type.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>src/careamics/config/configuration_factories.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-1603>1603</a></span>
<span class=normal><a href=#__codelineno-0-1604>1604</a></span>
<span class=normal><a href=#__codelineno-0-1605>1605</a></span>
<span class=normal><a href=#__codelineno-0-1606>1606</a></span>
<span class=normal><a href=#__codelineno-0-1607>1607</a></span>
<span class=normal><a href=#__codelineno-0-1608>1608</a></span>
<span class=normal><a href=#__codelineno-0-1609>1609</a></span>
<span class=normal><a href=#__codelineno-0-1610>1610</a></span>
<span class=normal><a href=#__codelineno-0-1611>1611</a></span>
<span class=normal><a href=#__codelineno-0-1612>1612</a></span>
<span class=normal><a href=#__codelineno-0-1613>1613</a></span>
<span class=normal><a href=#__codelineno-0-1614>1614</a></span>
<span class=normal><a href=#__codelineno-0-1615>1615</a></span>
<span class=normal><a href=#__codelineno-0-1616>1616</a></span>
<span class=normal><a href=#__codelineno-0-1617>1617</a></span>
<span class=normal><a href=#__codelineno-0-1618>1618</a></span>
<span class=normal><a href=#__codelineno-0-1619>1619</a></span>
<span class=normal><a href=#__codelineno-0-1620>1620</a></span>
<span class=normal><a href=#__codelineno-0-1621>1621</a></span>
<span class=normal><a href=#__codelineno-0-1622>1622</a></span>
<span class=normal><a href=#__codelineno-0-1623>1623</a></span>
<span class=normal><a href=#__codelineno-0-1624>1624</a></span>
<span class=normal><a href=#__codelineno-0-1625>1625</a></span>
<span class=normal><a href=#__codelineno-0-1626>1626</a></span>
<span class=normal><a href=#__codelineno-0-1627>1627</a></span>
<span class=normal><a href=#__codelineno-0-1628>1628</a></span>
<span class=normal><a href=#__codelineno-0-1629>1629</a></span>
<span class=normal><a href=#__codelineno-0-1630>1630</a></span>
<span class=normal><a href=#__codelineno-0-1631>1631</a></span>
<span class=normal><a href=#__codelineno-0-1632>1632</a></span>
<span class=normal><a href=#__codelineno-0-1633>1633</a></span>
<span class=normal><a href=#__codelineno-0-1634>1634</a></span>
<span class=normal><a href=#__codelineno-0-1635>1635</a></span>
<span class=normal><a href=#__codelineno-0-1636>1636</a></span>
<span class=normal><a href=#__codelineno-0-1637>1637</a></span>
<span class=normal><a href=#__codelineno-0-1638>1638</a></span>
<span class=normal><a href=#__codelineno-0-1639>1639</a></span>
<span class=normal><a href=#__codelineno-0-1640>1640</a></span>
<span class=normal><a href=#__codelineno-0-1641>1641</a></span>
<span class=normal><a href=#__codelineno-0-1642>1642</a></span>
<span class=normal><a href=#__codelineno-0-1643>1643</a></span>
<span class=normal><a href=#__codelineno-0-1644>1644</a></span>
<span class=normal><a href=#__codelineno-0-1645>1645</a></span>
<span class=normal><a href=#__codelineno-0-1646>1646</a></span>
<span class=normal><a href=#__codelineno-0-1647>1647</a></span>
<span class=normal><a href=#__codelineno-0-1648>1648</a></span>
<span class=normal><a href=#__codelineno-0-1649>1649</a></span>
<span class=normal><a href=#__codelineno-0-1650>1650</a></span>
<span class=normal><a href=#__codelineno-0-1651>1651</a></span>
<span class=normal><a href=#__codelineno-0-1652>1652</a></span>
<span class=normal><a href=#__codelineno-0-1653>1653</a></span>
<span class=normal><a href=#__codelineno-0-1654>1654</a></span>
<span class=normal><a href=#__codelineno-0-1655>1655</a></span>
<span class=normal><a href=#__codelineno-0-1656>1656</a></span>
<span class=normal><a href=#__codelineno-0-1657>1657</a></span>
<span class=normal><a href=#__codelineno-0-1658>1658</a></span>
<span class=normal><a href=#__codelineno-0-1659>1659</a></span>
<span class=normal><a href=#__codelineno-0-1660>1660</a></span>
<span class=normal><a href=#__codelineno-0-1661>1661</a></span>
<span class=normal><a href=#__codelineno-0-1662>1662</a></span>
<span class=normal><a href=#__codelineno-0-1663>1663</a></span>
<span class=normal><a href=#__codelineno-0-1664>1664</a></span>
<span class=normal><a href=#__codelineno-0-1665>1665</a></span>
<span class=normal><a href=#__codelineno-0-1666>1666</a></span>
<span class=normal><a href=#__codelineno-0-1667>1667</a></span>
<span class=normal><a href=#__codelineno-0-1668>1668</a></span>
<span class=normal><a href=#__codelineno-0-1669>1669</a></span>
<span class=normal><a href=#__codelineno-0-1670>1670</a></span>
<span class=normal><a href=#__codelineno-0-1671>1671</a></span>
<span class=normal><a href=#__codelineno-0-1672>1672</a></span>
<span class=normal><a href=#__codelineno-0-1673>1673</a></span>
<span class=normal><a href=#__codelineno-0-1674>1674</a></span>
<span class=normal><a href=#__codelineno-0-1675>1675</a></span>
<span class=normal><a href=#__codelineno-0-1676>1676</a></span>
<span class=normal><a href=#__codelineno-0-1677>1677</a></span>
<span class=normal><a href=#__codelineno-0-1678>1678</a></span>
<span class=normal><a href=#__codelineno-0-1679>1679</a></span>
<span class=normal><a href=#__codelineno-0-1680>1680</a></span>
<span class=normal><a href=#__codelineno-0-1681>1681</a></span>
<span class=normal><a href=#__codelineno-0-1682>1682</a></span>
<span class=normal><a href=#__codelineno-0-1683>1683</a></span>
<span class=normal><a href=#__codelineno-0-1684>1684</a></span>
<span class=normal><a href=#__codelineno-0-1685>1685</a></span>
<span class=normal><a href=#__codelineno-0-1686>1686</a></span>
<span class=normal><a href=#__codelineno-0-1687>1687</a></span>
<span class=normal><a href=#__codelineno-0-1688>1688</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-1603><a id=__codelineno-0-1603 name=__codelineno-0-1603></a><span class=k>def</span><span class=w> </span><span class=nf>get_likelihood_config</span><span class=p>(</span>
</span><span id=__span-0-1604><a id=__codelineno-0-1604 name=__codelineno-0-1604></a>    <span class=n>loss_type</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span><span class=s2>&quot;musplit&quot;</span><span class=p>,</span> <span class=s2>&quot;denoisplit&quot;</span><span class=p>,</span> <span class=s2>&quot;denoisplit_musplit&quot;</span><span class=p>],</span>
</span><span id=__span-0-1605><a id=__codelineno-0-1605 name=__codelineno-0-1605></a>    <span class=c1># TODO remove different microsplit loss types, refac</span>
</span><span id=__span-0-1606><a id=__codelineno-0-1606 name=__codelineno-0-1606></a>    <span class=n>predict_logvar</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span><span class=s2>&quot;pixelwise&quot;</span><span class=p>]</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-1607><a id=__codelineno-0-1607 name=__codelineno-0-1607></a>    <span class=n>logvar_lowerbound</span><span class=p>:</span> <span class=nb>float</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=o>-</span><span class=mf>5.0</span><span class=p>,</span>
</span><span id=__span-0-1608><a id=__codelineno-0-1608 name=__codelineno-0-1608></a>    <span class=n>nm_paths</span><span class=p>:</span> <span class=nb>list</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-1609><a id=__codelineno-0-1609 name=__codelineno-0-1609></a>    <span class=n>data_stats</span><span class=p>:</span> <span class=nb>tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>]</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-1610><a id=__codelineno-0-1610 name=__codelineno-0-1610></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>tuple</span><span class=p>[</span>
</span><span id=__span-0-1611><a id=__codelineno-0-1611 name=__codelineno-0-1611></a>    <span class=n>GaussianLikelihoodConfig</span> <span class=o>|</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-1612><a id=__codelineno-0-1612 name=__codelineno-0-1612></a>    <span class=n>MultiChannelNMConfig</span> <span class=o>|</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-1613><a id=__codelineno-0-1613 name=__codelineno-0-1613></a>    <span class=n>NMLikelihoodConfig</span> <span class=o>|</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-1614><a id=__codelineno-0-1614 name=__codelineno-0-1614></a><span class=p>]:</span>
</span><span id=__span-0-1615><a id=__codelineno-0-1615 name=__codelineno-0-1615></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Get the likelihood configuration for split models.</span>
</span><span id=__span-0-1616><a id=__codelineno-0-1616 name=__codelineno-0-1616></a>
</span><span id=__span-0-1617><a id=__codelineno-0-1617 name=__codelineno-0-1617></a><span class=sd>    Returns a tuple containing the following optional entries:</span>
</span><span id=__span-0-1618><a id=__codelineno-0-1618 name=__codelineno-0-1618></a><span class=sd>        - GaussianLikelihoodConfig: Gaussian likelihood configuration for musplit losses</span>
</span><span id=__span-0-1619><a id=__codelineno-0-1619 name=__codelineno-0-1619></a><span class=sd>        - MultiChannelNMConfig: Multi-channel noise model configuration for denoisplit</span>
</span><span id=__span-0-1620><a id=__codelineno-0-1620 name=__codelineno-0-1620></a><span class=sd>        losses</span>
</span><span id=__span-0-1621><a id=__codelineno-0-1621 name=__codelineno-0-1621></a><span class=sd>        - NMLikelihoodConfig: Noise model likelihood configuration for denoisplit losses</span>
</span><span id=__span-0-1622><a id=__codelineno-0-1622 name=__codelineno-0-1622></a>
</span><span id=__span-0-1623><a id=__codelineno-0-1623 name=__codelineno-0-1623></a><span class=sd>    Parameters</span>
</span><span id=__span-0-1624><a id=__codelineno-0-1624 name=__codelineno-0-1624></a><span class=sd>    ----------</span>
</span><span id=__span-0-1625><a id=__codelineno-0-1625 name=__codelineno-0-1625></a><span class=sd>    loss_type : Literal[&quot;musplit&quot;, &quot;denoisplit&quot;, &quot;denoisplit_musplit&quot;]</span>
</span><span id=__span-0-1626><a id=__codelineno-0-1626 name=__codelineno-0-1626></a><span class=sd>        The type of loss function to use.</span>
</span><span id=__span-0-1627><a id=__codelineno-0-1627 name=__codelineno-0-1627></a><span class=sd>    predict_logvar : Literal[&quot;pixelwise&quot;] | None, optional</span>
</span><span id=__span-0-1628><a id=__codelineno-0-1628 name=__codelineno-0-1628></a><span class=sd>        Type of log variance prediction, by default None.</span>
</span><span id=__span-0-1629><a id=__codelineno-0-1629 name=__codelineno-0-1629></a><span class=sd>        Required when loss_type is &quot;musplit&quot; or &quot;denoisplit_musplit&quot;.</span>
</span><span id=__span-0-1630><a id=__codelineno-0-1630 name=__codelineno-0-1630></a><span class=sd>    logvar_lowerbound : float | None, optional</span>
</span><span id=__span-0-1631><a id=__codelineno-0-1631 name=__codelineno-0-1631></a><span class=sd>        Lower bound for the log variance, by default -5.0.</span>
</span><span id=__span-0-1632><a id=__codelineno-0-1632 name=__codelineno-0-1632></a><span class=sd>        Used when loss_type is &quot;musplit&quot; or &quot;denoisplit_musplit&quot;.</span>
</span><span id=__span-0-1633><a id=__codelineno-0-1633 name=__codelineno-0-1633></a><span class=sd>    nm_paths : list[str] | None, optional</span>
</span><span id=__span-0-1634><a id=__codelineno-0-1634 name=__codelineno-0-1634></a><span class=sd>        Paths to the noise model files, by default None.</span>
</span><span id=__span-0-1635><a id=__codelineno-0-1635 name=__codelineno-0-1635></a><span class=sd>        Required when loss_type is &quot;denoisplit&quot; or &quot;denoisplit_musplit&quot;.</span>
</span><span id=__span-0-1636><a id=__codelineno-0-1636 name=__codelineno-0-1636></a><span class=sd>    data_stats : tuple[float, float] | None, optional</span>
</span><span id=__span-0-1637><a id=__codelineno-0-1637 name=__codelineno-0-1637></a><span class=sd>        Data statistics (mean, std), by default None.</span>
</span><span id=__span-0-1638><a id=__codelineno-0-1638 name=__codelineno-0-1638></a><span class=sd>        Required when loss_type is &quot;denoisplit&quot; or &quot;denoisplit_musplit&quot;.</span>
</span><span id=__span-0-1639><a id=__codelineno-0-1639 name=__codelineno-0-1639></a>
</span><span id=__span-0-1640><a id=__codelineno-0-1640 name=__codelineno-0-1640></a><span class=sd>    Returns</span>
</span><span id=__span-0-1641><a id=__codelineno-0-1641 name=__codelineno-0-1641></a><span class=sd>    -------</span>
</span><span id=__span-0-1642><a id=__codelineno-0-1642 name=__codelineno-0-1642></a><span class=sd>    GaussianLikelihoodConfig or None</span>
</span><span id=__span-0-1643><a id=__codelineno-0-1643 name=__codelineno-0-1643></a><span class=sd>        Configuration for the Gaussian likelihood model.</span>
</span><span id=__span-0-1644><a id=__codelineno-0-1644 name=__codelineno-0-1644></a><span class=sd>    MultiChannelNMConfig or None</span>
</span><span id=__span-0-1645><a id=__codelineno-0-1645 name=__codelineno-0-1645></a><span class=sd>        Configuration for the multi-channel noise model.</span>
</span><span id=__span-0-1646><a id=__codelineno-0-1646 name=__codelineno-0-1646></a><span class=sd>    NMLikelihoodConfig or None</span>
</span><span id=__span-0-1647><a id=__codelineno-0-1647 name=__codelineno-0-1647></a><span class=sd>        Configuration for the noise model likelihood.</span>
</span><span id=__span-0-1648><a id=__codelineno-0-1648 name=__codelineno-0-1648></a>
</span><span id=__span-0-1649><a id=__codelineno-0-1649 name=__codelineno-0-1649></a><span class=sd>    Raises</span>
</span><span id=__span-0-1650><a id=__codelineno-0-1650 name=__codelineno-0-1650></a><span class=sd>    ------</span>
</span><span id=__span-0-1651><a id=__codelineno-0-1651 name=__codelineno-0-1651></a><span class=sd>    ValueError</span>
</span><span id=__span-0-1652><a id=__codelineno-0-1652 name=__codelineno-0-1652></a><span class=sd>        If required parameters are missing for the specified loss_type.</span>
</span><span id=__span-0-1653><a id=__codelineno-0-1653 name=__codelineno-0-1653></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-1654><a id=__codelineno-0-1654 name=__codelineno-0-1654></a>    <span class=c1># gaussian likelihood</span>
</span><span id=__span-0-1655><a id=__codelineno-0-1655 name=__codelineno-0-1655></a>    <span class=k>if</span> <span class=n>loss_type</span> <span class=ow>in</span> <span class=p>[</span><span class=s2>&quot;musplit&quot;</span><span class=p>,</span> <span class=s2>&quot;denoisplit_musplit&quot;</span><span class=p>]:</span>
</span><span id=__span-0-1656><a id=__codelineno-0-1656 name=__codelineno-0-1656></a>        <span class=c1># if predict_logvar is None:</span>
</span><span id=__span-0-1657><a id=__codelineno-0-1657 name=__codelineno-0-1657></a>        <span class=c1>#    raise ValueError(f&quot;predict_logvar is required for loss_type &#39;{loss_type}&#39;&quot;)</span>
</span><span id=__span-0-1658><a id=__codelineno-0-1658 name=__codelineno-0-1658></a>        <span class=c1># TODO validators should be in pydantic models</span>
</span><span id=__span-0-1659><a id=__codelineno-0-1659 name=__codelineno-0-1659></a>        <span class=n>gaussian_lik_config</span> <span class=o>=</span> <span class=n>GaussianLikelihoodConfig</span><span class=p>(</span>
</span><span id=__span-0-1660><a id=__codelineno-0-1660 name=__codelineno-0-1660></a>            <span class=n>predict_logvar</span><span class=o>=</span><span class=n>predict_logvar</span><span class=p>,</span>
</span><span id=__span-0-1661><a id=__codelineno-0-1661 name=__codelineno-0-1661></a>            <span class=n>logvar_lowerbound</span><span class=o>=</span><span class=n>logvar_lowerbound</span><span class=p>,</span>
</span><span id=__span-0-1662><a id=__codelineno-0-1662 name=__codelineno-0-1662></a>        <span class=p>)</span>
</span><span id=__span-0-1663><a id=__codelineno-0-1663 name=__codelineno-0-1663></a>    <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-1664><a id=__codelineno-0-1664 name=__codelineno-0-1664></a>        <span class=n>gaussian_lik_config</span> <span class=o>=</span> <span class=kc>None</span>
</span><span id=__span-0-1665><a id=__codelineno-0-1665 name=__codelineno-0-1665></a>
</span><span id=__span-0-1666><a id=__codelineno-0-1666 name=__codelineno-0-1666></a>    <span class=c1># noise model likelihood</span>
</span><span id=__span-0-1667><a id=__codelineno-0-1667 name=__codelineno-0-1667></a>    <span class=k>if</span> <span class=n>loss_type</span> <span class=ow>in</span> <span class=p>[</span><span class=s2>&quot;denoisplit&quot;</span><span class=p>,</span> <span class=s2>&quot;denoisplit_musplit&quot;</span><span class=p>]:</span>
</span><span id=__span-0-1668><a id=__codelineno-0-1668 name=__codelineno-0-1668></a>        <span class=c1># if nm_paths is None:</span>
</span><span id=__span-0-1669><a id=__codelineno-0-1669 name=__codelineno-0-1669></a>        <span class=c1>#     raise ValueError(f&quot;nm_paths is required for loss_type &#39;{loss_type}&#39;&quot;)</span>
</span><span id=__span-0-1670><a id=__codelineno-0-1670 name=__codelineno-0-1670></a>        <span class=c1># if data_stats is None:</span>
</span><span id=__span-0-1671><a id=__codelineno-0-1671 name=__codelineno-0-1671></a>        <span class=c1>#     raise ValueError(f&quot;data_stats is required for loss_type &#39;{loss_type}&#39;&quot;)</span>
</span><span id=__span-0-1672><a id=__codelineno-0-1672 name=__codelineno-0-1672></a>        <span class=c1># TODO validators should be in pydantic models</span>
</span><span id=__span-0-1673><a id=__codelineno-0-1673 name=__codelineno-0-1673></a>        <span class=n>gmm_list</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-0-1674><a id=__codelineno-0-1674 name=__codelineno-0-1674></a>        <span class=k>if</span> <span class=n>nm_paths</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-1675><a id=__codelineno-0-1675 name=__codelineno-0-1675></a>            <span class=k>for</span> <span class=n>NM_path</span> <span class=ow>in</span> <span class=n>nm_paths</span><span class=p>:</span>
</span><span id=__span-0-1676><a id=__codelineno-0-1676 name=__codelineno-0-1676></a>                <span class=n>gmm_list</span><span class=o>.</span><span class=n>append</span><span class=p>(</span>
</span><span id=__span-0-1677><a id=__codelineno-0-1677 name=__codelineno-0-1677></a>                    <span class=n>GaussianMixtureNMConfig</span><span class=p>(</span>
</span><span id=__span-0-1678><a id=__codelineno-0-1678 name=__codelineno-0-1678></a>                        <span class=n>model_type</span><span class=o>=</span><span class=s2>&quot;GaussianMixtureNoiseModel&quot;</span><span class=p>,</span>
</span><span id=__span-0-1679><a id=__codelineno-0-1679 name=__codelineno-0-1679></a>                        <span class=n>path</span><span class=o>=</span><span class=n>NM_path</span><span class=p>,</span>
</span><span id=__span-0-1680><a id=__codelineno-0-1680 name=__codelineno-0-1680></a>                    <span class=p>)</span>
</span><span id=__span-0-1681><a id=__codelineno-0-1681 name=__codelineno-0-1681></a>                <span class=p>)</span>
</span><span id=__span-0-1682><a id=__codelineno-0-1682 name=__codelineno-0-1682></a>        <span class=n>noise_model_config</span> <span class=o>=</span> <span class=n>MultiChannelNMConfig</span><span class=p>(</span><span class=n>noise_models</span><span class=o>=</span><span class=n>gmm_list</span><span class=p>)</span>
</span><span id=__span-0-1683><a id=__codelineno-0-1683 name=__codelineno-0-1683></a>        <span class=n>nm_lik_config</span> <span class=o>=</span> <span class=n>NMLikelihoodConfig</span><span class=p>()</span>  <span class=c1># TODO this config isn&#39;t needed probably</span>
</span><span id=__span-0-1684><a id=__codelineno-0-1684 name=__codelineno-0-1684></a>    <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-1685><a id=__codelineno-0-1685 name=__codelineno-0-1685></a>        <span class=n>noise_model_config</span> <span class=o>=</span> <span class=kc>None</span>
</span><span id=__span-0-1686><a id=__codelineno-0-1686 name=__codelineno-0-1686></a>        <span class=n>nm_lik_config</span> <span class=o>=</span> <span class=kc>None</span>
</span><span id=__span-0-1687><a id=__codelineno-0-1687 name=__codelineno-0-1687></a>
</span><span id=__span-0-1688><a id=__codelineno-0-1688 name=__codelineno-0-1688></a>    <span class=k>return</span> <span class=n>gaussian_lik_config</span><span class=p>,</span> <span class=n>noise_model_config</span><span class=p>,</span> <span class=n>nm_lik_config</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../configuration/ class="md-footer__link md-footer__link--prev" aria-label="Previous: configuration" rel=prev> <div class="md-footer__button md-icon"><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg></div> <kbd class="key-control prev">P</kbd> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction>Previous</span> configuration </div> </div> </a> <a href=../configuration_io/ class="md-footer__link md-footer__link--next" aria-label="Next: configuration_io" rel=next> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction>Next</span> configuration_io </div> </div> <kbd class=key-control>N</kbd> <div class="md-footer__button md-icon"><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg></div> </a> </nav> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://github.com/CAREamics/careamics target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../../..", "features": ["content.code.copy", "content.code.annotate", "content.action.edit", "navigation.content_next", "navigation.indexes", "search.highlight", "search.share", "search.suggest", "navigation.icons", "content.tabs.link"], "search": "../../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script> <script src=../../../../assets/javascripts/bundle.f55a23d4.min.js></script> <script src=../../../../javascripts/termynal.js></script> <script src=../../../../javascripts/extra.js></script> <script src=../../../../javascripts/katex.js></script> <script src=https://unpkg.com/katex@0/dist/katex.min.js></script> <script src=https://unpkg.com/katex@0/dist/contrib/auto-render.min.js></script> </body> </html>